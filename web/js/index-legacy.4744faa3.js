(function(){"use strict";var t={354:function(t,e,n){var o={};n.r(o),n.d(o,{copy:function(){return Ii},cut:function(){return xi},paste:function(){return Zi}});var i={};n.r(i),n.d(i,{commitPreviewedConnection:function(){return Di},connect:function(){return Oi},createConnection:function(){return Pi},cycleConnectionPreviews:function(){return _i},destroyConnection:function(){return ki},disconnect:function(){return Bi},setConnectionPreview:function(){return Ci},unsetConnectionPreview:function(){return Si}});var r={};n.r(r),n.d(r,{clearBaseItems:function(){return Fi},clearStatelessInfo:function(){return Ni},createImage:function(){return zi},loadDocument:function(){return Ei},print:function(){return Mi}});var a={};n.r(a),n.d(a,{addFreeportItem:function(){return Ti},connectFreeport:function(){return Ri},createFreeport:function(){return Ai},disconnectFreeport:function(){return Wi}});var s={};n.r(s),n.d(s,{destroyGroup:function(){return qi},group:function(){return Vi},ungroup:function(){return Ui}});var u={};n.r(u),n.d(u,{addItem:function(){return $i},insertItemAtPosition:function(){return Ki},removeElement:function(){return Gi},resetItemValue:function(){return Yi},setInputCount:function(){return Xi},setProperties:function(){return Ji}});var c={};n.r(c),n.d(c,{panDelta:function(){return tr},panTo:function(){return Qi},panToCenter:function(){return er}});var l={};n.r(l),n.d(l,{addPort:function(){return or},monitorPort:function(){return cr},removePort:function(){return ir},setActivePortId:function(){return rr},setConnectablePortIds:function(){return ar},setPortValue:function(){return sr},togglePortMonitoring:function(){return ur},unmonitorPort:function(){return lr}});var d={};n.r(d),n.d(d,{centerAll:function(){return dr},dragItem:function(){return hr},moveSelectionPosition:function(){return mr},setItemPosition:function(){return fr},setPortRelativePosition:function(){return pr},setSelectionPosition:function(){return vr}});var p={};n.r(p),n.d(p,{rotate:function(){return wr}});var f={};n.r(f),n.d(f,{createSelection:function(){return Sr},deleteSelection:function(){return kr},deselectAll:function(){return Cr},deselectItem:function(){return xr},recycleSelection:function(){return Or},selectAll:function(){return Zr},selectItem:function(){return Ir},selectItemConnections:function(){return Dr},setSelectionState:function(){return Pr},updateSelectionList:function(){return _r}});var h={};n.r(h),n.d(h,{clearOscilloscope:function(){return Wr},closeOscilloscope:function(){return Tr},onError:function(){return Mr},onSimulationUpdate:function(){return Er},openOscilloscope:function(){return Lr},resetCircuit:function(){return zr},stepThroughCircuit:function(){return Nr},toggleDebugger:function(){return Fr},toggleOscillatorRecording:function(){return Br},toggleOscilloscope:function(){return jr}});var m={};n.r(m),n.d(m,{setGroupBoundingBox:function(){return Hr},setItemBoundingBox:function(){return qr},setItemSize:function(){return Ur},setViewerSize:function(){return Vr},updateCanvasSize:function(){return Rr}});var v={};n.r(v),n.d(v,{setSnapBoundaries:function(){return $r}});var g={};n.r(g),n.d(g,{applyState:function(){return Qr},cacheState:function(){return Xr},commitCachedState:function(){return Jr},commitState:function(){return Gr},redo:function(){return Yr},undo:function(){return Kr}});var y={};n.r(y),n.d(y,{bringForward:function(){return na},bringToFront:function(){return ia},incrementZIndex:function(){return ra},sendBackward:function(){return ea},sendToBack:function(){return oa},setZIndex:function(){return aa}});var b={};n.r(b),n.d(b,{incrementZoom:function(){return la},setZoom:function(){return da}});n(6992),n(8674),n(9601),n(7727);var w=n(8262),x=n(9963),I=(n(1539),n(9714),n(6252)),Z=n(3577),C={key:0},S={key:1};function D(t,e,n,o,i,r){var a=(0,I.up)("toolbar"),s=(0,I.up)("toolbox"),u=(0,I.up)("tab-item"),c=(0,I.up)("document"),l=(0,I.up)("tab-host"),d=(0,I.up)("oscilloscope"),p=(0,I.up)("status-bar"),f=(0,I.up)("main-view"),h=(0,I.up)("builder-view");return(0,I.wg)(),(0,I.iD)(I.HY,null,[(0,I._)("div",{class:(0,Z.C_)(["app__dropzone",{"app__dropzone--active":t.isDropping}])},null,2),t.activeDocumentId&&t.activeDocument?((0,I.wg)(),(0,I.j4)(f,{key:0,"is-blurred":t.isDialogOpen,onContextmenu:t.onContextMenu},{top:(0,I.w5)((function(){return[t.isMobile?((0,I.wg)(),(0,I.iD)("div",C,"mobile bar")):(0,I.kq)("",!0),((0,I.wg)(),(0,I.j4)(a,{key:t.activeDocumentId,store:t.activeDocument.store},null,8,["store"])),(0,I.Wm)(s,{"is-open":t.isToolboxOpen,store:t.activeDocument.store},null,8,["is-open","store"])]})),middle:(0,I.w5)((function(){return[(0,I.Wm)(l,null,(0,I.Nv)({default:(0,I.w5)((function(){return[((0,I.wg)(),(0,I.j4)(c,{key:t.activeDocumentId,store:t.activeDocument.store,onSwitch:t.switchDocument,onOpenIntegratedCircuit:t.openIntegratedCircuit},null,8,["store","onSwitch","onOpenIntegratedCircuit"]))]})),_:2},[t.isMobile?void 0:{name:"tabs",fn:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.documents,(function(e,n){return(0,I.wg)(),(0,I.j4)(u,{key:n,label:e.displayName,active:t.activeDocumentId===n,dirty:e.store().isDirty,onActivate:function(e){return t.activateDocument(n.toString())},onClose:function(e){return t.closeDocument(n.toString())}},null,8,["label","active","dirty","onActivate","onClose"])})),128))]}))}]),1024)]})),bottom:(0,I.w5)((function(){return[((0,I.wg)(),(0,I.j4)(d,{key:t.activeDocumentId,store:t.activeDocument.store},null,8,["store"])),t.isMobile?(0,I.kq)("",!0):((0,I.wg)(),(0,I.j4)(p,{key:t.activeDocumentId,store:t.activeDocument.store,"is-fullscreen":t.isFullscreen,onFullscreen:t.toggleFullscreen},null,8,["store","is-fullscreen","onFullscreen"]))]})),_:1},8,["is-blurred","onContextmenu"])):((0,I.wg)(),(0,I.iD)("div",S," no documents open "+(0,Z.zw)(t.isDropping),1)),t.isBuilderOpen?((0,I.wg)(),(0,I.j4)(h,{key:2})):(0,I.kq)("",!0)],64)}var _=n(124),P=n(8534),O=n(2262);function k(t,e,n,o,i,r){var a=(0,I.up)("item"),s=(0,I.up)("connection"),u=(0,I.up)("group"),c=(0,I.up)("editor");return(0,I.wg)(),(0,I.j4)(c,{ref:"editor",zoom:t.store.zoomLevel,"grid-size":t.gridSize,tabindex:0,offset:{x:t.store.canvas.left,y:t.store.canvas.top},width:t.store.canvas.right-t.store.canvas.left,height:t.store.canvas.bottom-t.store.canvas.top,onPan:t.store.panTo,onDeselect:t.store.deselectAll,onSelection:t.store.createSelection,onZoom:t.store.setZoom,onContextmenu:t.onContextMenu,onResize:t.store.setViewerSize},{default:(0,I.w5)((function(){return[(0,I._)("div",{tabindex:0,onFocus:e[0]||(e[0]=function(e){return t.store.recycleSelection(!1)})},null,32),t.store.hasLoaded?((0,I.wg)(!0),(0,I.iD)(I.HY,{key:0},(0,I.Ko)(t.store.baseItems,(function(e){return(0,I.wg)(),(0,I.iD)(I.HY,null,["type"in e?((0,I.wg)(),(0,I.j4)(a,{tabindex:0,store:t.storeDefinition,id:e.id,key:e.id,"is-selected":e.isSelected,flash:t.store.isDebugging&&t.store.isCircuitEvaluated,"z-index":e.zIndex+1e3,onContextmenu:t.onContextMenu},null,8,["store","id","is-selected","flash","z-index","onContextmenu"])):((0,I.wg)(),(0,I.j4)(s,{tabindex:0,store:t.storeDefinition,id:e.id,key:"c".concat(e.id),"is-selected":e.isSelected,"is-preview":t.store.connectionPreviewId===e.id,flash:t.store.isDebugging&&t.store.isCircuitEvaluated,"z-index":e.zIndex,onContextmenu:t.onContextMenu},null,8,["store","id","is-selected","is-preview","flash","z-index","onContextmenu"]))],64)})),256)):(0,I.kq)("",!0),(0,I._)("div",{tabindex:0,onFocus:e[1]||(e[1]=function(e){return t.store.recycleSelection(!0)})},null,32),((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.store.groups,(function(e){return(0,I.wg)(),(0,I.j4)(u,{key:e.id,id:e.id,"bounding-box":e.boundingBox,"is-selected":e.isSelected,"z-index":t.store.zIndex,zoom:t.store.zoom},null,8,["id","bounding-box","is-selected","z-index","zoom"])})),128))]})),_:1},8,["zoom","grid-size","offset","width","height","onPan","onDeselect","onSelection","onZoom","onContextmenu","onResize"])}n(1249),n(2479);function B(t,e,n,o,i,r){var a=(0,I.up)("wire"),s=(0,I.up)("draggable");return(0,I.wg)(),(0,I.j4)(s,{style:(0,Z.j5)({zIndex:t.zIndex}),position:t.position,"is-selected":t.isSelected,"allow-touch-drag":null!==t.freeportId,onTouchhold:t.onDragStart,onDrag:t.onDrag,onDragEnd:t.onDragEnd,onSelect:e[0]||(e[0]=function(e){return t.selectItem(t.id,e)}),onDeselect:e[1]||(e[1]=function(e){return t.deselectItem(t.id)}),onContextmenu:t.onContextMenu},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{source:t.source,target:t.target,geometry:t.geometry,"is-selected":t.isSelected,"is-preview":t.isPreview,flash:t.flash,label:"TODO",ref:"root","data-test":"wire"},null,8,["source","target","geometry","is-selected","is-preview","flash"])]})),_:1},8,["style","position","is-selected","allow-touch-drag","onTouchhold","onDrag","onDragEnd","onContextmenu"])}n(9653);var E=n(5934);function M(t,e,n,o,i,r){var a=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(a,{class:"draggable",ref:"draggable",style:(0,Z.j5)(t.style),onMousedown:(0,x.iM)(t.onMouseDown,["left"]),onMouseup:t.onMouseUp,onTouchstart:t.onTouchStart,onTouchmove:t.onTouchMove,onTouchend:t.onTouchEnd,onTouchcancel:t.dragEnd,onFocus:t.onFocus},{default:(0,I.w5)((function(){return[(0,I.WI)(t.$slots,"default")]})),_:3},8,["style","onMousedown","onMouseup","onTouchstart","onTouchmove","onTouchend","onTouchcancel","onFocus"])}var z,N=n(9584);n(5438);(function(t){t[t["Outer"]=0]="Outer",t[t["Inner"]=1]="Inner",t[t["Radial"]=2]="Radial",t[t["Grid"]=3]="Grid",t[t["None"]=4]="None"})(z||(z={}));var F=z;function j(t,e){return Math.round(t/e)*e}function L(t,e,n){return Math.hypot(t.x-e.x,t.y-e.y)<=n}function T(t,e){return{x:j(t.left,e)-t.left,y:j(t.top,e)-t.top}}function W(t,e,n){for(var o=0;o<t.length;o++){var i=t[o];if(L({x:i.left,y:i.top},{x:e.left,y:e.top},n))return{x:i.left-e.left,y:i.top-e.top}}return{x:0,y:0}}function A(t,e,n){for(var o={x:0,y:0},i=0;i<t.length;i++){var r=t[i],a=Math.abs(r.top-e.bottom)<=n,s=Math.abs(r.bottom-e.top)<=n,u=Math.abs(r.left-e.right)<=n,c=Math.abs(r.right-e.left)<=n;(e.left<=r.right&&e.left>=r.left||e.right>=r.left&&e.right<=r.right||e.left<=r.left&&e.right>=r.right)&&(a&&(o.y=r.top-e.bottom),s&&(o.y=r.bottom-e.top)),(e.top<=r.bottom&&e.top>=r.top||e.bottom>=r.top&&e.bottom<=r.bottom||e.top<=r.top&&e.bottom>=r.bottom)&&(u&&(o.x=r.left-e.right),c&&(o.x=r.right-e.left))}return o}function R(t,e,n,o){switch(n){case F.Radial:return W(t,e,o);case F.Grid:return T(e,o);case F.Outer:default:return A(t,e,o)}}function V(t,e,n,o){var i=function(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)};return i(t,n,o)!==i(e,n,o)&&i(t,e,n)!==i(t,e,o)}function U(t,e,n){var o={x:n.left,y:n.top},i={x:n.right,y:n.top},r={x:n.right,y:n.bottom},a={x:n.left,y:n.bottom};return V(t,e,o,i)||V(t,e,i,r)||V(t,e,r,a)||V(t,e,a,o)}function q(t,e){return!(t.left>=e.right||e.left>=t.right)&&!(t.top>=e.bottom||e.top>=t.bottom)}function H(t,e){return{left:t.left*e,top:t.top*e,bottom:t.bottom*e,right:t.right*e}}function $(t){return t.left!==t.right||t.top!==t.bottom}function K(t){return[{left:t.x,right:t.x,top:-1/0,bottom:1/0},{left:-1/0,right:1/0,top:t.y,bottom:t.y}]}function Y(t){return{left:t.x,top:t.y,right:t.x,bottom:t.y}}function G(t,e,n,o){if(e%2===0)return{left:t.x,top:t.y,bottom:o+t.y,right:n+t.x};var i=t.x+n/2,r=t.y+o/2;return{left:i-o/2,top:r-n/2,right:i+o/2,bottom:r+n/2}}function X(t){return t.reduce((function(t,e){return{left:Math.min(t.left,e.left),top:Math.min(t.top,e.top),right:Math.max(t.right,e.right),bottom:Math.max(t.bottom,e.bottom)}}),{left:1/0,top:1/0,right:0,bottom:0})}function J(t){var e=t.right-t.left,n=t.bottom-t.top;return{x:e/2,y:n/2}}function Q(t,e,n){var o=J(t),i=e.right-e.left,r=e.bottom-e.top;return{x:j(o.x-i/2,n),y:j(o.y-r/2,n)}}function tt(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];var i=Math[t].apply(Math,(0,N.Z)(n.map((function(t){var e=t.x;return e})))),r=Math[t].apply(Math,(0,N.Z)(n.map((function(t){var e=t.y;return e}))));return{x:i,y:r}}var et={isInNeighborhood:L,getRadialSnapOffset:W,getOuterSnapOffset:A,getGridSnapPosition:T,isLineIntersectingRectangle:U,scaleBoundingBox:H,isOneOrTwoDimensional:$,getLinearBoundaries:K,getPointBoundary:Y,hasIntersection:q,getBoundingBox:G,getGroupBoundingBox:X,getBoundingBoxMidpoint:J,getCenteredScreenPoint:Q,getSnapOffset:R,getExtremePoint:tt},nt={ref:"resizable"};function ot(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",nt,[(0,I.WI)(t.$slots,"default")],512)}var it=n(6084),rt=n(1033),at=(0,I.aZ)({name:"Resizable",emits:{resize:function(t){return!0}},setup:function(t,e){var n=e.emit,o=(0,O.iH)();function i(t){var e=(0,it.Z)(t,1),o=e[0];n("resize",o.target.getBoundingClientRect())}var r=new rt.Z(i);return(0,I.bv)((function(){o.value&&r.observe(o.value)})),{onSizeChanged:i,resizable:o}}}),st=n(3744);const ut=(0,st.Z)(at,[["render",ot]]);var ct=ut,lt=(0,I.aZ)({name:"Draggable",components:{Resizable:ct},props:{position:{type:Object,default:function(){return{x:0,y:0}}},isSelected:{type:Boolean,default:!1},isMobile:{type:Boolean,default:!1},allowTouchDrag:{type:Boolean,default:!0}},emits:{dragStart:function(t,e){return!0},drag:function(t,e){return!0},dragEnd:function(t,e){return!0},select:function(t){return!0},deselect:function(){return!0},touchhold:function(t){return!0}},setup:function(t,e){var n=e.emit,o=(0,I.Fl)((function(){return{left:"".concat(t.position.x,"px"),top:"".concat(t.position.y,"px")}})),i=(0,O.iH)(),r=0,a=!1,s=!1,u=!1,c={x:0,y:0},l={x:0,y:0},d={x:0,y:0};function p(){setTimeout((function(){t.isSelected||n("select",!1)}))}function f(t){var e=t.clientX,o=t.clientY;a&&(l.x===e&&l.y===o||(l={x:e,y:o},n(u?"drag":"dragStart",l,d),u=!0,s=!0))}function h(t){var e=t.clientX,n=t.clientY;if(i.value){var o=i.value.$el.getBoundingClientRect(),r=o.x,s=o.y,c=o.width,p=o.height;l={x:e,y:n},d={x:e-(r+c/2),y:n-(s+p/2)},a=!0,u=!1}}function m(){a&&(a=!1,s&&n("dragEnd",l,d))}function v(t){h(t)}function g(t){a&&(t.stopImmediatePropagation(),t.preventDefault(),f(t))}function y(t){}function b(t){s=!1,c={x:t.touches[0].clientX,y:t.touches[0].clientY},r=window.setTimeout((function(){n("touchhold",t)}),500)}function w(e){var n={x:e.touches[0].clientX,y:e.touches[0].clientY};et.isInNeighborhood(c,n,5)||1!==e.touches.length||(s=!0,clearTimeout(r)),t.allowTouchDrag&&(e.stopPropagation(),e.preventDefault(),a||h(e.touches[0])),a&&f(e.touches[0])}function x(){clearTimeout(r),a?m():s||(t.isSelected?n("deselect"):n("select",!0))}return(0,I.bv)((function(){window.addEventListener("mousemove",g),window.addEventListener("mouseup",m)})),(0,I.Jd)((function(){window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",m)})),(0,I.m0)((function(){var e;t.isSelected&&(null===(e=i.value)||void 0===e||e.$el.focus())})),{style:o,draggable:i,onMouseDown:v,onMouseUp:y,onTouchStart:b,onTouchMove:w,onTouchEnd:x,dragEnd:m,onFocus:p}}});const dt=(0,st.Z)(lt,[["render",M]]);var pt=dt,ft=(n(2222),["width","height"]),ht=["transform","d"],mt=["transform","d"],vt=["transform","d"],gt=["transform","d"];function yt(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",{class:(0,Z.C_)(["wire",{"wire--selected":t.isSelected,"wire--flash":t.flash,"wire--preview":t.isPreview}]),width:t.geometry.width,height:t.geometry.height},[(0,I._)("title",null,(0,Z.zw)(t.label),1),(0,I._)("path",{class:"wire__outline",fill:"none",transform:"translate(".concat(Math.abs(t.geometry.minX),", ").concat(Math.abs(t.geometry.minY),")"),d:t.geometry.path},null,8,ht),(0,I._)("path",{class:(0,Z.C_)(["wire__display",{"wire__display--on":1===t.source.value,"wire__display--off":-1===t.source.value}]),fill:"none",transform:"translate(".concat(Math.abs(t.geometry.minX),", ").concat(Math.abs(t.geometry.minY),")"),d:t.geometry.path},null,10,mt),t.isAnimated?((0,I.wg)(),(0,I.iD)("path",{key:0,class:"wire__animation",fill:"none",transform:"translate(".concat(Math.abs(t.geometry.minX),", ").concat(Math.abs(t.geometry.minY),")"),d:t.geometry.path},null,8,vt)):(0,I.kq)("",!0),(0,I._)("path",{class:"wire__clickable",fill:"none",transform:"translate(".concat(Math.abs(t.geometry.minX),", ").concat(Math.abs(t.geometry.minY),")"),d:t.geometry.path},null,8,gt)],10,ft)}var bt=(0,I.aZ)({name:"Wire",props:{isAnimated:{type:Boolean,default:!1},source:{type:Object,required:!0},target:{type:Object,required:!0},label:{type:String,default:""},isPreview:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},geometry:{type:Object,required:!0}}});const wt=(0,st.Z)(bt,[["render",yt]]);var xt,It=wt;n(6977),n(9600);(function(t){t[t["Left"]=0]="Left",t[t["Top"]=1]="Top",t[t["Right"]=2]="Right",t[t["Bottom"]=3]="Bottom"})(xt||(xt={}));var Zt=xt;function Ct(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t+e%4+4)%4}var St=15;function Dt(t,e){var n=t.position,o=e.position,i=kt(n,o),r=i.start,a=i.end;if(r.x===a.x||r.y===a.y||a.x<=1&&r.x<=1||a.y<=1&&r.y<=1)return _t(r,a);var s=Ot(t,n,o),u=Ot(e,n,o);return Bt(s,u,r,a)}function _t(t,e){return{path:"M ".concat(t.x,",").concat(t.y," L ").concat(e.x,",").concat(e.y),width:Math.abs(t.x-e.x)+St,height:Math.abs(t.y-e.y)+St,minX:-St/2,minY:-St/2}}function Pt(t,e,n){switch(t){case Zt.Left:return e.y>n.y?Zt.Right:Zt.Left;case Zt.Top:return e.x<n.x?Zt.Bottom:Zt.Top;case Zt.Right:return e.y>n.y?Zt.Left:Zt.Right;case Zt.Bottom:return e.x<n.x?Zt.Top:Zt.Bottom;default:return Pt(Ct(t),e,n)}}function Ot(t,e,n){var o=Ct(t.orientation+t.rotation-1);return t.isFreeport&&(o=Pt(o,e,n),t.rotation%4!==1&&t.rotation%4!==2||(o=Ct(o-2))),o}function kt(t,e){return t.x<=e.x?t.y<=e.y?{start:{x:0,y:0},end:{x:Math.floor(e.x-t.x),y:Math.floor(e.y-t.y)}}:{start:{x:0,y:Math.floor(t.y-e.y)},end:{x:Math.floor(e.x-t.x),y:0}}:t.y<=e.y?{start:{x:Math.floor(t.x-e.x),y:0},end:{x:0,y:Math.floor(e.y-t.y)}}:{start:{x:Math.floor(t.x-e.x),y:Math.floor(t.y-e.y)},end:{x:0,y:0}}}function Bt(t,e,n,o){var i=n.x,r=n.y,a=o.x,s=o.y,u=Math.max(Math.abs(i-a)/2,10),c=Math.max(Math.abs(r-s)/2,10),l=[i,i+u,i,i-u][t].toFixed(3),d=[r-c,r,r+c,r][t].toFixed(3),p=[a,a+u,a,a-u][e].toFixed(3),f=[s-c,s,s+c,s][e].toFixed(3),h=["M",i.toFixed(3),r.toFixed(3),"C",l,d,p,f,a.toFixed(3),s.toFixed(3)].join(" "),m=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.map((function(t){return parseInt(t.toString(),10)}))},v=Math.min.apply(Math,(0,N.Z)(m(i,l,p,a)))-St/2,g=Math.max.apply(Math,(0,N.Z)(m(i,l,p,a)))+St/2,y=Math.min.apply(Math,(0,N.Z)(m(r,d,f,s)))-St/2,b=Math.max.apply(Math,(0,N.Z)(m(r,d,f,s)))+St/2,w=g-v+St,x=b-y+St;return{width:w,height:x,path:h,minX:v,minY:y}}function Et(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=t(),o=[{label:"&Undo",enabled:n.canUndo,accelerator:"CommandOrControl+Z",click:n.undo},{type:"separator"},{role:"cut",enabled:n.hasSelection},{role:"copy",enabled:n.hasSelection},{role:"paste",enabled:n.hasSelection},{label:"Delete",accelerator:"Delete",enabled:n.hasSelection,click:n.deleteSelection},{type:"separator"},{role:"selectAll",enabled:n.baseItems.length>0}];return n.selectedItemIds.length>0&&(o.push({type:"separator"}),o.push({label:"&Rotate",submenu:[{label:"Rotate 90° &CW",accelerator:"CmdOrCtrl+R",click:function(){return n.rotate(1)}},{label:"Rotate 90° CC&W",accelerator:"CmdOrCtrl+Shift+R",click:function(){return n.rotate(-1)}}]})),n.hasSelection&&(o.push({type:"separator"}),o.push({label:"&Bring to Front",submenu:[{label:"&Bring to Front",click:function(){return n.setZIndex(n.zIndex)}},{label:"Bring &Forward",click:function(){return n.incrementZIndex(1)}}]}),o.push({label:"&Send to Back",submenu:[{label:"&Send to Back",click:function(){return n.setZIndex(n.zIndex)}},{label:"Send &Backward",click:function(){return n.incrementZIndex(-1)}}]})),n.canGroup&&o.push({label:"&Group",submenu:[{label:"&Group"},{label:"&Ungroup",enabled:n.canUngroup}]}),e.length>0&&(o.push({type:"separator"}),o=o.concat(e)),1===n.selectedItemIds.length&&(o.push({type:"separator"}),o.push({label:"&Item Properties"})),n.activePortId&&(o.push({type:"separator"}),o.push({type:"checkbox",label:"Show in &Oscilloscope",checked:!0})),o}function Mt(t){t();return[{label:"&Grid",submenu:[{label:"&Show grid"},{type:"separator"},{label:"Snap to &grid"},{label:"Snap to &elements"}]}]}function zt(t){return Et(t,Mt(t).concat({type:"separator"}))}var Nt=(0,I.aZ)({name:"Connection",components:{Draggable:pt,Wire:It},props:{isSelected:{type:Boolean,default:!1},id:{type:String,required:!0},zIndex:{type:Number,default:0},isPreview:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},store:{type:Function,required:!0}},setup:function(t){var e=t.store(),n=(0,O.iH)(e.connections[t.id]),o=(0,O.iH)(),i=(0,I.Fl)((function(){return e.ports[n.value.source]})),r=(0,I.Fl)((function(){return e.ports[n.value.target]})),a=(0,I.Fl)((function(){return et.getExtremePoint("min",i.value.position,r.value.position)})),s=(0,I.Fl)((function(){return Dt(i.value,r.value)})),u=(0,I.Fl)((function(){return{y:a.value.y+s.value.minY,x:a.value.x+s.value.minX}})),c=(0,O.iH)(null);function l(t){var e=t.touches;d({x:e[0].clientX,y:e[0].clientY})}function d(t){var a;null!==(a=o.value)&&void 0!==a&&a.$el&&null===n.value.groupId&&(o.value.$el.style.opacity="0",c.value=(0,E.Z)(),navigator.vibrate(20),e.createFreeport({itemId:c.value,inputPortId:(0,E.Z)(),outputPortId:(0,E.Z)(),connectionChainId:n.value.connectionChainId,sourceId:i.value.id,targetId:r.value.id,value:i.value.value}),e.setSnapBoundaries(c.value),e.dragItem(c.value,t))}function p(t){return f.apply(this,arguments)}function f(){return f=(0,P.Z)((0,_.Z)().mark((function t(n){return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:c.value?e.dragItem(c.value,n):d(n);case 1:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function h(){c&&e.destroyConnection({source:n.value.source,target:n.value.target}),c.value=null}function m(){t.isSelected||e.selectItem(t.id),window.api.showContextMenu(zt(t.store))}return{root:o,geometry:s,position:u,onDragStart:l,onDrag:p,onDragEnd:h,onContextMenu:m,source:i,target:r,freeportId:c,selectItem:e.selectItem,deselectItem:e.deselectItem}}});const Ft=(0,st.Z)(Nt,[["render",B]]);var jt=Ft;n(8309),n(7327);function Lt(t,e,n,o,i,r){var a=(0,I.up)("properties"),s=(0,I.up)("port-item"),u=(0,I.up)("circuit-component"),c=(0,I.up)("draggable");return(0,I.wg)(),(0,I.j4)(c,{style:(0,Z.j5)({outline:"none",pointerEvents:"none",zIndex:t.zIndex}),position:t.item.position,"is-selected":t.isSelected,"allow-touch-drag":t.isSelected,onResize:t.onResize,onKeydown:(0,x.D2)(t.onEscapeKey,["esc"]),onDrag:t.onDrag,onDragStart:t.onDragStart,onContextmenu:t.onContextMenu,onDblclick:t.revealCustomCircuit,onTouchhold:t.revealCustomCircuit,onDragEnd:t.store.commitCachedState,onSelect:e[1]||(e[1]=function(e){return t.store.selectItem(t.id,e)}),onDeselect:e[2]||(e[2]=function(e){return t.store.deselectItem(t.id)}),ref:"itemRef","data-test":"item"},{default:(0,I.w5)((function(){return[t.isPropertiesEnabled?((0,I.wg)(),(0,I.j4)(a,{key:0,properties:t.item.properties,id:t.id,viewport:t.viewport,onUpdate:t.store.setProperties,onFocus:e[0]||(e[0]=function(e){return t.store.setActivePortId(null)}),onPan:t.store.panDelta,"aria-label":"Properties dialog","data-test":"properties"},null,8,["properties","id","viewport","onUpdate","onPan"])):(0,I.kq)("",!0),(0,I.Wm)(u,{type:t.item.type,subtype:t.item.subtype,name:t.item.name,ports:t.ports,properties:t.item.properties,"is-selected":t.isSelected,flash:t.flash,style:(0,Z.j5)({transform:"rotate(".concat(90*t.item.rotation,"deg)")}),onSignal:t.store.setPortValue},(0,I.Nv)({_:2},[(0,I.Ko)(4,(function(e,n){return{name:n,fn:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.ports.filter((function(t){return t.orientation===n})),(function(e){return(0,I.wg)(),(0,I.j4)(s,{tabindex:0,store:t.$props.store,id:e.id,key:"".concat(e.id,"_").concat(t.portUpdates),title:e.name,type:e.type,position:e.position,orientation:e.orientation+t.item.rotation,"connected-port-ids":e.connectedPortIds,hue:e.isMonitored?e.hue:0,rotation:t.item.rotation,onKeypress:(0,x.D2)(t.onEscapeKey,["esc"]),onFocus:function(n){return t.store.setActivePortId(e.id)},onBlur:function(n){return t.onPortBlur(e.id)},onDeselect:t.focus,"data-test":"port-item"},null,8,["store","id","title","type","position","orientation","connected-port-ids","hue","rotation","onKeypress","onFocus","onBlur","onDeselect"])})),128))]}))}}))]),1032,["type","subtype","name","ports","properties","is-selected","flash","style","onSignal"])]})),_:1},8,["style","position","is-selected","allow-touch-drag","onResize","onKeydown","onDrag","onDragStart","onContextmenu","onDblclick","onTouchhold","onDragEnd"])}function Tt(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["circuit-component",{"circuit-component--selected":t.isSelected,"circuit-component--flash":t.flash,"circuit-component--custom":t.subtype===t.ItemSubtype.CustomCircuit}])},[((0,I.wg)(),(0,I.j4)((0,I.LL)(t.type),(0,I.dG)(t.$props,{onSignal:t.onChange}),null,16,["onSignal"])),t.type!==t.ItemType.Freeport?((0,I.wg)(),(0,I.iD)(I.HY,{key:0},(0,I.Ko)(["left","top","right","bottom"],(function(e,n){return(0,I._)("div",{key:n,class:(0,Z.C_)(["circuit-component__ports--".concat(e),"circuit-component__ports"])},[(0,I.WI)(t.$slots,n)],2)})),64)):(0,I.kq)("",!0)],2)}function Wt(t,e,n,o,i,r){var a=(0,I.up)("port-handle");return(0,I.wg)(),(0,I.j4)(a)}var At={class:"port-handle"};function Rt(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",At,[(0,I._)("div",{class:(0,Z.C_)(["port-handle__display",{"port-handle__display--active":t.active}])},[(0,I._)("div",{class:"port-handle__hue",style:(0,Z.j5)({backgroundColor:t.backgroundColor})},null,4)],2)])}var Vt=(0,I.aZ)({name:"PortHandle",props:{active:{type:Boolean,default:!1},hue:{type:Number,default:0}},setup:function(t){var e=(0,I.Fl)((function(){return t.hue>0?"hsla(".concat(t.hue,", var(--lightness), var(--saturation), 0.8)"):"var(--color-bg-secondary)"}));return{backgroundColor:e}}});const Ut=(0,st.Z)(Vt,[["render",Rt]]);var qt=Ut,Ht=(0,I.aZ)({name:"Freeport",components:{PortHandle:qt}});const $t=(0,st.Z)(Ht,[["render",Wt]]);var Kt=$t,Yt={class:"input-node"},Gt={key:0},Xt={key:1},Jt={key:2};function Qt(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",Yt,[(0,I._)("button",{type:"button",class:(0,Z.C_)(["input-node__flipper",{"input-node__flipper--on":1===t.model,"input-node__flipper--off":-1===t.model,"input-node__flipper--high-z":0===t.model}]),tabindex:0,onMousedown:e[0]||(e[0]=(0,x.iM)((function(){return t.onInput&&t.onInput.apply(t,arguments)}),["stop"])),onTouchstart:e[1]||(e[1]=(0,x.iM)((function(){return t.onInput&&t.onInput.apply(t,arguments)}),["stop"]))},[1===t.model?((0,I.wg)(),(0,I.iD)("span",Gt,"ON")):-1===t.model?((0,I.wg)(),(0,I.iD)("span",Xt,"OFF")):((0,I.wg)(),(0,I.iD)("span",Jt,"?"))],34)])}var te=(0,I.aZ)({name:"InputNode",props:{ports:{type:Array,default:function(){return[]}}},emits:{signal:function(t){return!0}},setup:function(t,e){var n=e.emit,o=(0,O.iH)(0);function i(e){e.preventDefault(),e.stopPropagation(),o.value=1===o.value?-1:1,n("signal",{id:t.ports[0].id,value:o.value})}return(0,I.m0)((function(){var e;o.value=(null===(e=t.ports[0])||void 0===e?void 0:e.value)||0})),{model:o,onInput:i}}});const ee=(0,st.Z)(te,[["render",Qt]]);var ne=ee;function oe(t,e,n,o,i,r){return(0,I.wg)(),(0,I.j4)((0,I.LL)(t.subtype),(0,Z.vs)((0,I.F4)(t.$props)),null,16)}var ie={class:"custom-circuit"},re={class:"custom-circuit__center"},ae={class:"custom-circuit__name"};function se(t,e,n,o,i,r){var a=(0,I.up)("custom-circuit-port-zone");return(0,I.wg)(),(0,I.iD)("div",ie,[(0,I.Wm)(a,{ports:t.ports.filter((function(t){return 1===t.orientation})),orientation:"horizontal",type:"top"},null,8,["ports"]),(0,I._)("div",re,[(0,I.Wm)(a,{ports:t.ports.filter((function(t){return 0===t.orientation})),orientation:"vertical",type:"left"},null,8,["ports"]),(0,I._)("div",ae,(0,Z.zw)(t.name),1),(0,I.Wm)(a,{ports:t.ports.filter((function(t){return 2===t.orientation})),orientation:"vertical",type:"right"},null,8,["ports"])]),(0,I.Wm)(a,{ports:t.ports.filter((function(t){return 3===t.orientation})),orientation:"horizontal",type:"bottom"},null,8,["ports"])])}function ue(t,e,n,o,i,r){var a=(0,I.up)("custom-circuit-port");return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)("custom-circuit-port-zone custom-circuit-port-zone--".concat(t.orientation))},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.ports,(function(e){return(0,I.wg)(),(0,I.iD)("div",{key:e.id,class:(0,Z.C_)(["custom-circuit-port-zone__io--".concat(t.type),"custom-circuit-port-zone__io"])},[(0,I.Wm)(a,{label:e.name,type:t.type},null,8,["label","type"])],2)})),128))],2)}var ce={class:"custom-circuit-port"},le={class:"custom-circuit-port__label"};function de(t,e,n,o,i,r){var a=(0,I.up)("port-wire");return(0,I.wg)(),(0,I.iD)("div",ce,[(0,I._)("div",le,(0,Z.zw)(t.label),1),(0,I.Wm)(a,{type:t.type},null,8,["type"])])}var pe={class:"wire__port"};function fe(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)("wire wire--".concat(t.type))},[(0,I._)("div",{class:(0,Z.C_)("wire__connector wire__connector--".concat(t.type))},null,2),(0,I._)("div",pe,[(0,I.WI)(t.$slots,"default")])],2)}var he=(0,I.aZ)({name:"PortWire",props:{type:{type:String,default:"top"}}});const me=(0,st.Z)(he,[["render",fe]]);var ve=me,ge=(0,I.aZ)({name:"CustomCircuitPort",components:{PortWire:ve},props:{label:{type:String,default:""},type:{type:String,required:!0}}});const ye=(0,st.Z)(ge,[["render",de]]);var be=ye,we=(0,I.aZ)({name:"CustomCircuitPortZone",components:{CustomCircuitPort:be},props:{ports:{type:Array,default:function(){return[]}},orientation:{type:String,required:!0},type:{type:String,required:!0}}});const xe=(0,st.Z)(we,[["render",ue]]);var Ie=xe,Ze=(0,I.aZ)({name:"CustomCircuit",components:{CustomCircuitPortZone:Ie},props:{ports:{type:Array,default:function(){return[]}},name:{type:String,default:"circuit"}}});const Ce=(0,st.Z)(Ze,[["render",se]]);var Se=Ce,De={class:"digit"},_e={width:"58",height:"98"},Pe=["d"];function Oe(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",De,[((0,I.wg)(),(0,I.iD)("svg",_e,[(0,I._)("g",null,[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.segments,(function(t,e){return(0,I.wg)(),(0,I.iD)("path",{key:e,style:(0,Z.j5)(t.style),d:t.path},null,12,Pe)})),128))])]))])}var ke={" ":[0,0,0,0,0,0,0],0:[1,1,1,1,1,1,0],1:[0,0,1,1,0,0,0],2:[0,1,1,0,1,1,1],3:[0,1,1,1,1,0,1],4:[1,0,1,1,0,0,1],5:[1,1,0,1,1,0,1],6:[1,1,0,1,1,1,1],7:[0,1,1,1,0,0,0],8:[1,1,1,1,1,1,1],9:[1,1,1,1,0,0,1],a:[1,1,1,1,0,1,1],b:[1,0,0,1,1,1,1],c:[1,1,0,0,1,1,0],d:[0,0,1,1,1,1,1],e:[1,1,0,0,1,1,1],f:[1,1,0,0,0,1,1]},Be=["M 8,10 L 12,14 L 12,42 L 8,46 L 4,42 L 4,14 L 8,10 z","M 10,8 L 14,4 L 42,4 L 46,8 L 42,12 L 14,12 L 10,8 z","M 48,10 L 52,14 L 52,42 L 48,46 L 44,42 L 44,14 L 48,10 z","M 48,50 L 52,54 L 52,82 L 48,86 L 44,82 L 44,54 L 48,50 z","M 10,88 L 14,84 L 42,84 L 46,88 L 42,92 L 14,92 L 10,88 z","M 8,50 L 12,54 L 12,82 L 8,86 L 4,82 L 4,54 L 8,50 z","M 10,48 L 14,44 L 42,44 L 46,48 L 42,52 L 14,52 L 10,48 z"],Ee=(0,I.aZ)({name:"DigitDisplay",props:{ports:{type:Array,default:function(){return[]}}},setup:function(t){var e=(0,I.Fl)((function(){var e=t.ports.map((function(t){return 1===t.value?1:0})).join(""),n=parseInt(e,2).toString(16).toLowerCase();return ke[n].map((function(t,e){var n=t?"on":"bg-tertiary";return{path:Be[e],style:{fill:"var(--color-".concat(n,")")}}}))}));return{segments:e}}});const Me=(0,st.Z)(Ee,[["render",Oe]]);var ze=Me,Ne={CustomCircuit:Se,DigitDisplay:ze},Fe=(0,I.aZ)({name:"IntegratedCircuit",components:Ne,props:{ports:{type:Array,default:function(){return[]}},subtype:{type:String,required:!0},name:{type:String,default:""}}});const je=(0,st.Z)(Fe,[["render",oe]]);var Le=je,Te=(0,I._)("div",{class:"logic-gate__wire"},null,-1),We={key:0,class:"logic-gate__wires--multiwire"},Ae=(0,I._)("div",{class:"logic-gate__wires-divider"},[(0,I._)("div",{class:"logic-gate__wire"})],-1);function Re(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{style:(0,Z.j5)({height:"".concat(25*t.inputCount,"px")}),class:"logic-gate"},[(0,I._)("div",{style:(0,Z.j5)({width:(t.inputCount,"100%")}),class:"logic-gate__wires"},[(0,I._)("div",{class:(0,Z.C_)([{"logic-gate__wires-divider--multiwire":t.inputCount>2},"logic-gate__wires-divider"])},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.inputCount-1,(function(t){return(0,I.wg)(),(0,I.iD)("div",{key:t,class:"logic-gate__wire"})})),128)),Te],2),t.inputCount>2?((0,I.wg)(),(0,I.iD)("div",We)):(0,I.kq)("",!0),Ae],4),((0,I.wg)(),(0,I.j4)((0,I.LL)(t.subtype),{class:"logic-gate__component"}))],4)}var Ve={class:"and",width:"100",height:"50",viewBox:"0 -1 100 50"},Ue=(0,I._)("path",{transform:"translate(20, 0)",class:"and__element",d:"M 0 0 V 48 H 24 C 36 48 48 36 48 24 C 48 12 36 0 24 0 Z"},null,-1),qe={key:0,cx:"73",cy:"24",r:"5",class:"and__negation"};function He(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",Ve,[Ue,t.isNegated?((0,I.wg)(),(0,I.iD)("circle",qe)):(0,I.kq)("",!0)])}var $e=(0,I.aZ)({name:"And",props:{isNegated:{type:Boolean,default:!1}}});const Ke=(0,st.Z)($e,[["render",He]]);var Ye=Ke,Ge={width:"100",height:"50",viewBox:"0 -1 100 50",class:"or"},Xe=(0,I._)("path",{transform:"translate(10, 0)",fill:"#fff",d:"M 0 0 C 12 12 12 36 0 48 H 0 H 24 C 48 48 60 36 72 24 C 60 12 48 0 24 0 Z",class:"or__element"},null,-1),Je={key:0,fill:"none",d:"M 0 0 C 12 12 12 36 0 48",class:"or__tail"},Qe={key:1,cx:"88",cy:"24",r:"5",class:"or__negation"};function tn(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",Ge,[Xe,t.isXor?((0,I.wg)(),(0,I.iD)("path",Je)):(0,I.kq)("",!0),t.isNegated?((0,I.wg)(),(0,I.iD)("circle",Qe)):(0,I.kq)("",!0)])}var en=(0,I.aZ)({name:"Or",props:{isNegated:{type:Boolean,default:!1},isXor:{type:Boolean,default:!1}}});const nn=(0,st.Z)(en,[["render",tn]]);var on=nn;function rn(t,e,n,o,i,r){var a=(0,I.up)("or");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0})}var an=(0,I.aZ)({name:"Nor",components:{Or:on}});const sn=(0,st.Z)(an,[["render",rn]]);var un=sn;function cn(t,e,n,o,i,r){var a=(0,I.up)("buffer");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0})}var ln={class:"buffer",width:"100",height:"50",viewBox:"0 -1 100 50"},dn=(0,I._)("path",{class:"buffer__element",transform:"translate(40, 0)",stroke:"#000","stroke-width":"2",fill:"#fff",d:"M 0 0 V 48 L 36 24 Z"},null,-1),pn={key:0,class:"buffer__negation",stroke:"#000","stroke-width":"2",cx:"88",cy:"24",r:"5",fill:"#fff"};function fn(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",ln,[dn,t.isNegated?((0,I.wg)(),(0,I.iD)("circle",pn)):(0,I.kq)("",!0)])}var hn=(0,I.aZ)({name:"Buffer",props:{isNegated:{type:Boolean,default:!1}}});const mn=(0,st.Z)(hn,[["render",fn]]);var vn=mn,gn=(0,I.aZ)({name:"Not",components:{Buffer:vn}});const yn=(0,st.Z)(gn,[["render",cn]]);var bn=yn;function wn(t,e,n,o,i,r){var a=(0,I.up)("and");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0})}var xn=(0,I.aZ)({name:"Nand",components:{And:Ye}});const In=(0,st.Z)(xn,[["render",wn]]);var Zn=In;function Cn(t,e,n,o,i,r){var a=(0,I.up)("or");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0,"is-xor":!0})}var Sn=(0,I.aZ)({name:"Xnor",components:{Or:on}});const Dn=(0,st.Z)(Sn,[["render",Cn]]);var _n=Dn;function Pn(t,e,n,o,i,r){var a=(0,I.up)("or");return(0,I.wg)(),(0,I.j4)(a,{"is-xor":!0})}var On=(0,I.aZ)({name:"Xor",components:{Or:on}});const kn=(0,st.Z)(On,[["render",Pn]]);var Bn=kn,En=(0,I.aZ)({name:"LogicGate",components:{And:Ye,Or:on,Nor:un,Not:bn,Nand:Zn,Xnor:_n,Xor:Bn},props:{properties:{type:Object,default:function(){return{}}},subtype:{subtype:String,required:!0}},setup:function(t){var e=(0,I.Fl)((function(){var e;return(null===(e=t.properties.inputCount)||void 0===e?void 0:e.value)||2}));return{inputCount:e}}});const Mn=(0,st.Z)(En,[["render",Re]]);var zn=Mn;function Nn(t,e,n,o,i,r){return(0,I.wg)(),(0,I.j4)((0,I.LL)(t.subtype),(0,Z.vs)((0,I.F4)(t.$props)),null,16)}var Fn=["title"];function jn(t,e,n,o,i,r){var a;return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["lightbulb","lightbulb--".concat(t.modifier)]),title:null===(a=t.ports[0])||void 0===a?void 0:a.value},null,10,Fn)}var Ln=(0,I.aZ)({name:"Lightbulb",props:{ports:{type:Array,default:function(){return[]}}},setup:function(t){var e=(0,I.Fl)((function(){var e;switch(null===(e=t.ports[0])||void 0===e?void 0:e.value){case 1:return"on";case-1:return"off";default:return"high-z"}}));return{modifier:e}}});const Tn=(0,st.Z)(Ln,[["render",jn]]);var Wn=Tn,An={Lightbulb:Wn},Rn=(0,I.aZ)({name:"OutputNode",components:An,props:{ports:{type:Array,default:function(){return[]}},subtype:{type:String,required:!0}}});const Vn=(0,st.Z)(Rn,[["render",Nn]]);var Un,qn=Vn;(function(t){t["Buffer"]="Buffer",t["CircuitNode"]="CircuitNode",t["Freeport"]="Freeport",t["InputNode"]="InputNode",t["IntegratedCircuit"]="IntegratedCircuit",t["LogicGate"]="LogicGate",t["OutputNode"]="OutputNode"})(Un||(Un={}));var Hn,$n=Un;(function(t){t["None"]="None",t["CustomCircuit"]="CustomCircuit",t["Switch"]="Switch",t["PushButton"]="PushButton",t["Clock"]="Clock",t["Lightbulb"]="Lightbulb",t["DigitDisplay"]="DigitDisplay",t["Buffer"]="Buffer",t["Not"]="Not",t["Tristate"]="Tristate",t["And"]="And",t["Or"]="Or",t["Nand"]="Nand",t["Nor"]="Nor",t["Xnor"]="Xnor",t["Xor"]="Xor"})(Hn||(Hn={}));var Kn=Hn,Yn={Freeport:Kt,InputNode:ne,IntegratedCircuit:Le,LogicGate:zn,OutputNode:qn},Gn=(0,I.aZ)({name:"CircuitComponent",components:Yn,emits:{signal:function(t){return!0}},props:{isSelected:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},type:{type:String,required:!0},subtype:{type:String,required:!0},name:{type:String,default:""},ports:{type:Array,default:function(){return[]}},properties:{type:Object,default:function(){return{}}}},setup:function(t,e){var n=e.emit;return{onChange:function(t){n("signal",t)},ItemType:$n,ItemSubtype:Kn}}});const Xn=(0,st.Z)(Gn,[["render",Tt]]);var Jn=Xn,Qn=["aria-hidden"],to={class:"properties__heading",role:"title"},eo=(0,I.Uk)(" Properties "),no=["for"],oo=["onUpdate:modelValue","id"],io=["value"],ro=["onUpdate:modelValue","id"],ao=["onUpdate:modelValue","min","max","type","id"];function so(t,e,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",{onContextmenu:e[3]||(e[3]=function(){return t.stopPropagation&&t.stopPropagation.apply(t,arguments)}),onMousedown:e[4]||(e[4]=function(){return t.stopPropagation&&t.stopPropagation.apply(t,arguments)}),onMouseup:e[5]||(e[5]=function(){return t.stopPropagation&&t.stopPropagation.apply(t,arguments)}),onKeydown:e[6]||(e[6]=(0,x.D2)((function(){return t.onKeyDown&&t.onKeyDown.apply(t,arguments)}),["esc"])),class:"properties"},[t.isOpen?((0,I.wg)(),(0,I.iD)("div",{key:0,class:"properties__dialog",ref:"propertiesRef","aria-hidden":!t.isOpen},[(0,I._)("div",to,[eo,(0,I.Wm)(a,{tabindex:0,icon:t.faClose,onClick:t.close,role:"button",class:"properties__close"},null,8,["icon","onClick"])]),((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.model,(function(n,o){return(0,I.wg)(),(0,I.iD)("div",{key:o,class:"properties__entry"},[(0,I._)("label",{for:"".concat(t.id,"_").concat(o),class:"properties__label"},(0,Z.zw)(n.label),9,no),n.options?(0,I.wy)(((0,I.wg)(),(0,I.iD)("select",{key:0,"onUpdate:modelValue":function(t){return n.value=t},id:"".concat(t.id,"_").concat(o),class:"properties__input",onChange:e[0]||(e[0]=function(){return t.onChange&&t.onChange.apply(t,arguments)})},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(n.options,(function(t,e){return(0,I.wg)(),(0,I.iD)("option",{key:e,value:t},(0,Z.zw)(e),9,io)})),128))],40,oo)),[[x.bM,n.value]]):"boolean"===n.type?(0,I.wy)(((0,I.wg)(),(0,I.iD)("input",{key:1,"onUpdate:modelValue":function(t){return n.value=t},id:"".concat(t.id,"_").concat(o),type:"checkbox",class:"properties__input",onChange:e[1]||(e[1]=function(){return t.onChange&&t.onChange.apply(t,arguments)})},null,40,ro)),[[x.e8,n.value]]):(0,I.wy)(((0,I.wg)(),(0,I.iD)("input",{key:2,"onUpdate:modelValue":function(t){return n.value=t},min:n.min,max:n.max,type:n.type,id:"".concat(t.id,"_").concat(o),class:"properties__input",onChange:e[2]||(e[2]=function(){return t.onChange&&t.onChange.apply(t,arguments)})},null,40,ao)),[[x.YZ,n.value]])])})),128))],8,Qn)):((0,I.wg)(),(0,I.j4)(a,{key:1,onKeydown:(0,x.D2)(t.openProperties,["space"]),onClick:t.openProperties,tabindex:0,icon:t.faWrench,class:"properties__icon"},null,8,["onKeydown","onClick","icon"]))],32)}var uo=n(1436),co=n(3465),lo=n.n(co),po=["viewBox"],fo=["d"];function ho(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",viewBox:"0 0 ".concat(t.width," ").concat(t.height)},[(0,I._)("path",{fill:"currentColor",d:t.svgPath},null,8,fo)],8,po)}var mo=(0,I.aZ)({name:"Icon",props:{icon:{type:Object,required:!0}},setup:function(t){var e=(0,I.Fl)((function(){return t.icon.icon[0]})),n=(0,I.Fl)((function(){return t.icon.icon[1]})),o=(0,I.Fl)((function(){return t.icon.icon[4]}));return{width:e,height:n,svgPath:o}}});const vo=(0,st.Z)(mo,[["render",ho]]);var go=vo,yo=(0,I.aZ)({name:"Properties",components:{Icon:go},props:{properties:{type:Object,default:function(){return{}}},id:{type:String,default:""},viewport:{type:Object,required:!0}},emits:{update:function(t,e){return!0},pan:function(t,e){return!0}},setup:function(t,e){var n=e.emit,o=(0,O.iH)(),i=(0,O.iH)(!1),r=(0,O.iH)(lo()(t.properties));function a(t){i.value=!1,t.preventDefault()}function s(t){var e;a(t),null===(e=o.value)||void 0===e||e.focus()}function u(t){t.stopPropagation()}function c(){n("update",t.id,r.value)}function l(){i.value=!0,(0,I.Y3)((function(){if(o.value){var e=o.value.getBoundingClientRect(),i=e.bottom,r=e.right,a=Math.max(r-t.viewport.right,0),s=Math.max(i-t.viewport.bottom,0);(a>0||s>0)&&n("pan",{x:-a,y:-s},!0)}}))}return(0,I.YP)(t.properties,(function(t){r.value=lo()(t)}),{deep:!0}),{faClose:uo.YIN,faWrench:uo.klh,model:r,isOpen:i,propertiesRef:o,close:a,onKeyDown:s,onChange:c,openProperties:l,stopPropagation:u}}});const bo=(0,st.Z)(yo,[["render",so]]);var wo=bo;n(6699),n(2023);function xo(t,e,n,o,i,r){var a=(0,I.up)("port-handle"),s=(0,I.up)("draggable"),u=(0,I.up)("port-pivot");return(0,I.wg)(),(0,I.j4)(u,{rotation:t.rotation,onBlur:t.onBlur,onKeydown:[(0,x.D2)(t.onEscapeKey,["esc"]),e[0]||(e[0]=(0,x.D2)((function(e){return t.store.cycleConnectionPreviews(t.id)}),["space"])),(0,x.D2)(t.store.commitPreviewedConnection,["enter"])],onResize:t.onResize,onContextmenu:e[1]||(e[1]=function(e){return t.store.setActivePortId(t.id)})},{default:(0,I.w5)((function(){return[t.isFreeport?((0,I.wg)(),(0,I.j4)(a,{key:1,type:t.type,hue:t.hue,active:t.store.activePortId===t.id||t.store.connectablePortIds.includes(t.id)},null,8,["type","hue","active"])):((0,I.wg)(),(0,I.j4)(s,{key:0,onDragStart:t.onDragStart,onDrag:t.onDrag,onDragEnd:t.onDragEnd,onTouchhold:t.onTouchHold,onDblclick:t.onDoubleClick,tabindex:-1},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{type:t.type,hue:t.hue,active:t.store.activePortId===t.id||t.store.connectablePortIds.includes(t.id),"touch-friendly":""},null,8,["type","hue","active"])]})),_:1},8,["onDragStart","onDrag","onDragEnd","onTouchhold","onDblclick"]))]})),_:1},8,["rotation","onBlur","onKeydown","onResize"])}function Io(t,e,n,o,i,r){var a=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(a,{class:"port-pivot",style:(0,Z.j5)({transform:"rotate(-".concat(90*t.rotation,"deg)")}),onKeydown:e[0]||(e[0]=(0,x.D2)((function(e){return t.$emit("connect")}),["space"]))},{default:(0,I.w5)((function(){return[(0,I.WI)(t.$slots,"default")]})),_:3},8,["style"])}var Zo=(0,I.aZ)({name:"PortPivot",components:{Resizable:ct},props:{rotation:{type:Number,default:0}}});const Co=(0,st.Z)(Zo,[["render",Io]]);var So,Do=Co;(function(t){t[t["Output"]=0]="Output",t[t["Input"]=1]="Input"})(So||(So={}));var _o=So,Po=(0,I.aZ)({name:"PortItem",components:{PortHandle:qt,PortPivot:Do,Draggable:pt,Resizable:ct},props:{id:{type:String,default:""},rotation:{type:Number,default:0},position:{type:Object,default:function(){return{x:0,y:0}}},isFreeport:{type:Boolean,default:!1},type:{type:Number,default:0},orientation:{type:Number,default:0},hue:{type:Number,default:0},connectedPortIds:{type:Object,default:[]},store:{type:Function,required:!0}},setup:function(t,e){var n=e.emit,o=t.store(),i=F.Radial,r=null,a="",s=!1;function u(t){t.preventDefault(),t.stopPropagation(),n("deselect",t)}function c(){o.unsetConnectionPreview(),o.cachedState=null}function l(){r={itemId:(0,E.Z)()},a=(0,E.Z)(),s=!1,t.type===_o.Input?(r.outputPortId=a,r.targetId=t.id):(r.inputPortId=a,r.sourceId=t.id)}function d(e){var n=e.x,i=e.y;null!==r&&(s||(o.createFreeport(r,!1),o.setConnectablePortIds({portId:t.id,isDragging:!0}),o.setSnapBoundaries(a)),o.dragItem(r.itemId,{x:n,y:i},F.Radial))}function p(){null!==r&&(r.inputPortId?o.connectFreeport({portId:r.inputPortId,sourceId:t.id}):r.outputPortId&&o.connectFreeport({portId:r.outputPortId,targetId:t.id}))}function f(e){e.stopPropagation(),e.preventDefault(),navigator.vibrate(100),o.togglePortMonitoring(t.id)}function h(e){o.setPortRelativePosition(e,t.id)}function m(e){e.stopPropagation(),e.preventDefault(),o.togglePortMonitoring(t.id)}return{store:o,snapMode:i,onDragStart:l,onDrag:d,onDragEnd:p,onEscapeKey:u,onBlur:c,onTouchHold:f,onResize:h,onDoubleClick:m,PortType:_o}}});const Oo=(0,st.Z)(Po,[["render",xo]]);var ko=Oo,Bo=(n(7941),n(4916),n(5306),n(7601),n(4553),n(8862),JSON.parse('{"groups":{},"connections":{"switch1_nor1_conn":{"id":"switch1_nor1_conn","connectionChainId":"switch1_nor1_conn","source":"switchOutputPort1","target":"nor1InputPort1","isSelected":false,"groupId":null,"zIndex":7},"switch2_nor2_conn":{"id":"switch2_nor2_conn","connectionChainId":"switch2_nor2_conn","source":"switchOutputPort2","target":"nor2InputPort1","isSelected":false,"groupId":null,"zIndex":8},"nor1_nor2_conn":{"id":"nor1_nor2_conn","connectionChainId":"nor1_nor2_conn","source":"nor1OutputPort1","target":"nor2InputPort2","isSelected":false,"groupId":null,"zIndex":9},"nor2_nor1_conn":{"id":"nor2_nor1_conn","connectionChainId":"nor2_nor1_conn","source":"nor2OutputPort1","target":"nor1InputPort2","isSelected":false,"groupId":null,"zIndex":10},"nor1_lightbulb1_conn":{"id":"nor1_lightbulb1_conn","connectionChainId":"nor1_lightbulb1_conn","source":"nor1OutputPort1","target":"lightbulbInputPort1","isSelected":false,"groupId":null,"zIndex":11},"nor2_lightbulb2_conn":{"id":"nor2_lightbulb2_conn","connectionChainId":"nor2_lightbulb2_conn","source":"nor2OutputPort1","target":"lightbulbInputPort2","isSelected":false,"groupId":null,"zIndex":12}},"ports":{"nor1InputPort1":{"id":"nor1InputPort1","elementId":"nor1","name":"Input Port 1","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor1InputPort2":{"id":"nor1InputPort2","elementId":"nor1","name":"Input Port 2","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor1OutputPort1":{"id":"nor1OutputPort1","elementId":"nor1","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"nor2InputPort1":{"id":"nor2InputPort1","elementId":"nor2","name":"Input Port 1","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor2InputPort2":{"id":"nor2InputPort2","elementId":"nor2","name":"Input Port 2","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor2OutputPort1":{"id":"nor2OutputPort1","elementId":"nor2","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"switchOutputPort1":{"id":"switchOutputPort1","elementId":"switch1","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"switchOutputPort2":{"id":"switchOutputPort2","elementId":"switch2","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"lightbulbInputPort1":{"id":"lightbulbInputPort1","elementId":"lightbulb1","name":"Input Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"lightbulbInputPort2":{"id":"lightbulbInputPort2","elementId":"lightbulb2","name":"Input Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false}},"items":{"nor1":{"id":"nor1","type":"LogicGate","subtype":"Nor","portIds":["nor1InputPort1","nor1InputPort2","nor1OutputPort1"],"position":{"x":300,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"inputCount":{"label":"Input count","value":2,"type":"number","min":2}},"groupId":null,"zIndex":1,"width":100,"height":150},"nor2":{"id":"nor2","type":"LogicGate","subtype":"Nor","portIds":["nor2InputPort2","nor2InputPort1","nor2OutputPort1"],"position":{"x":300,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"inputCount":{"label":"Input count","value":2,"type":"number","min":2}},"groupId":null,"zIndex":2,"width":120,"height":51},"switch1":{"id":"switch1","type":"InputNode","subtype":"Clock","portIds":["switchOutputPort1"],"position":{"x":100,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"interval":{"label":"Interval","value":1000,"type":"number","min":100,"step":100},"startValue":{"label":"Start value","value":-1,"type":"number","options":{"True":1,"Hi-Z":0,"False":-1}}},"groupId":null,"zIndex":3,"width":40,"height":40},"switch2":{"id":"switch2","type":"InputNode","subtype":"Switch","portIds":["switchOutputPort2"],"position":{"x":100,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"startValue":{"label":"Start value","value":1,"type":"number","options":{"True":1,"Hi-Z":0,"False":-1}}},"groupId":null,"zIndex":4,"width":40,"height":40},"lightbulb1":{"id":"lightbulb1","type":"OutputNode","subtype":"Lightbulb","portIds":["lightbulbInputPort1"],"position":{"x":700,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"}},"groupId":null,"zIndex":5,"width":40,"height":40},"lightbulb2":{"id":"lightbulb2","type":"OutputNode","subtype":"Lightbulb","portIds":["lightbulbInputPort2"],"position":{"x":700,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"}},"groupId":null,"zIndex":6,"width":40,"height":40}}}')),Eo=n(5082),Mo=(n(2707),n(189),n(8783),n(3948),n(4747),n(1038),n(7042),n(9826),n(2833)),zo=n(3087),No=n(2482),Fo=(n(561),(0,Mo.Z)((function t(e,n){(0,zo.Z)(this,t),(0,No.Z)(this,"node",void 0),(0,No.Z)(this,"id",void 0),this.node=e,this.id=n}))),jo=Fo,Lo={TRUE:1,FALSE:-1,UNKNOWN:0},To=Lo,Wo=n(2417),Ao=n(3806),Ro=n(5744),Vo=(0,Mo.Z)((function t(e){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,zo.Z)(this,t),(0,No.Z)(this,"inputValues",{}),(0,No.Z)(this,"outputs",[]),(0,No.Z)(this,"isValueChanged",!0),(0,No.Z)(this,"forceContinue",!1),(0,No.Z)(this,"name",void 0),(0,No.Z)(this,"value",To.UNKNOWN),(0,No.Z)(this,"newValue",To.UNKNOWN),(0,No.Z)(this,"events",[]),(0,No.Z)(this,"setValue",(function(t){n.newValue=t})),(0,No.Z)(this,"invokeEvent",(function(t,e,o){n.events.forEach((function(n){n.eventType===t&&n.callback(e,o)}))})),(0,No.Z)(this,"eval",(function(){return n.value})),(0,No.Z)(this,"valueCount",(function(t){return Object.values(n.inputValues).filter((function(e){return e===t})).length})),(0,No.Z)(this,"updateOutputs",(function(t){var e=[];n.outputs.forEach((function(n){var o=n.node,i=n.id;o.update(t,i),e.push(i)})),n.invokeEvent("change",t,e)})),(0,No.Z)(this,"update",(function(t,e){n.inputValues[e]=t,n.newValue=n.eval(),n.invokeEvent("change",n.newValue,n.outputs.map((function(t){var e=t.id;return e})))})),(0,No.Z)(this,"propagate",(function(){var t=[];return n.value!==n.newValue&&(n.isValueChanged=!0,n.value=n.newValue,n.updateOutputs(n.newValue),n.outputs.forEach((function(e){var n=e.node;n.forceContinue?t=t.concat(n.propagate()):t.push(n)}))),t})),(0,No.Z)(this,"reset",(function(){n.value=To.UNKNOWN,n.newValue=To.UNKNOWN,n.invokeEvent("change",n.newValue,n.outputs.map((function(t){var e=t.id;return e})))})),(0,No.Z)(this,"on",(function(t,e){n.events.push({eventType:t,callback:e})})),(0,No.Z)(this,"getProjectedValue",(function(){return n.eval()||n.newValue||n.value})),this.name=e,this.inputValues=o.reduce((function(t,e){return(0,Eo.Z)((0,Eo.Z)({},t),{},(0,No.Z)({},e,To.UNKNOWN))}),{})})),Uo=Vo,qo=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"reset",(function(){})),t}return(0,Mo.Z)(n)}(Uo),Ho=qo,$o=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"update",(function(e){t.newValue!==e&&(t.newValue=e,t.invokeEvent("change",t.newValue,[]))})),t}return(0,Mo.Z)(n)}(Uo),Ko=$o,Yo=(0,Mo.Z)((function t(){var e=this;(0,zo.Z)(this,t),(0,No.Z)(this,"queue",[]),(0,No.Z)(this,"nodes",[]),(0,No.Z)(this,"inputNodes",[]),(0,No.Z)(this,"addNode",(function(t){t instanceof Ho&&(e.inputNodes.push(t),e.enqueue(t)),e.nodes.push(t)})),(0,No.Z)(this,"removeNode",(function(t){if(t instanceof Ho){var n=e.inputNodes.findIndex((function(e){var n=e.name;return n===t.name}));-1!==n&&e.inputNodes.splice(n,1)}var o=e.nodes.findIndex((function(e){var n=e.name;return n===t.name}));-1!==o&&(e.removeNodeOutputs(t),e.nodes.splice(o,1)),e.next()})),(0,No.Z)(this,"addConnection",(function(t,n,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:To.UNKNOWN;t.outputs.push(new jo(n,o)),t.value=i,i||e.enqueue(t)})),(0,No.Z)(this,"removeConnection",(function(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:To.UNKNOWN;t.outputs.concat().forEach((function(i,r){var a=i.node,s=i.id;n===a&&(n.update(o,s),t.outputs.splice(r,1),e.enqueue(n))}))})),(0,No.Z)(this,"removeNodeOutputs",(function(t){for(var n=0;n<t.outputs.length;n++)e.removeConnection(t,t.outputs[n].node)})),(0,No.Z)(this,"enqueue",(function(){for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];n.forEach((function(t){~e.queue.indexOf(t)||e.queue.push(t)}))})),(0,No.Z)(this,"dequeue",(function(t){var n=e.queue.indexOf(t);~n&&e.queue.splice(n,1)})),(0,No.Z)(this,"reset",(function(){e.nodes.forEach((function(t){return t.reset()}))})),(0,No.Z)(this,"next",(function(){var t=!1,n=[];while(e.queue.length>0){var o=e.queue.shift();o&&(n=n.concat(o.propagate()),e.dequeue(o),o.isValueChanged&&(t=!0),o.forceContinue&&(e.enqueue.apply(e,(0,N.Z)(n)),n=[]))}t&&e.enqueue.apply(e,(0,N.Z)(n))})),(0,No.Z)(this,"isComplete",(function(){var t=!0;return 0===e.queue.length||(e.queue.forEach((function(e){var n=e.getProjectedValue();n===e.value||e instanceof Ko||(t=!1)})),t&&(e.queue=[]),t)}))})),Go=Yo,Xo=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"eval",(function(){return t.valueCount(To.TRUE)?To.FALSE:t.valueCount(To.UNKNOWN)?To.UNKNOWN:To.TRUE})),t}return(0,Mo.Z)(n)}(Uo),Jo=Xo,Qo=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"eval",(function(){return t.valueCount(To.TRUE)?To.TRUE:t.valueCount(To.UNKNOWN)?To.UNKNOWN:To.FALSE})),t}return(0,Mo.Z)(n)}(Uo),ti=Qo,ei=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"forceContinue",!0),(0,No.Z)((0,Wo.Z)(t),"update",(function(e){var n=Object.keys(t.inputValues).pop();n&&(t.inputValues[n]=e,t.newValue=t.eval())})),(0,No.Z)((0,Wo.Z)(t),"eval",(function(){return Object.values(t.inputValues).pop()||To.UNKNOWN})),t}return(0,Mo.Z)(n)}(Uo),ni=ei,oi=n(4279),ii=(0,Mo.Z)((function t(e,n,o,i){var r=this;(0,zo.Z)(this,t),(0,No.Z)(this,"id",void 0),(0,No.Z)(this,"name",void 0),(0,No.Z)(this,"width",0),(0,No.Z)(this,"lastY",0),(0,No.Z)(this,"segments",[]),(0,No.Z)(this,"hue",0),(0,No.Z)(this,"initialize",(function(t){var e={x:1,y:1};1===t?(e.y=0,r.lastY=1):(e.y=1,r.lastY=0),r.addSegment(e),r.updateWidth()})),(0,No.Z)(this,"reset",(function(){r.segments=[],r.width=0,r.initialize(1===r.lastY?0:1)})),(0,No.Z)(this,"update",(function(t){r.drawPulseConstant()})),(0,No.Z)(this,"addSegment",(function(t){var e=r.segments[r.segments.length-1];!e&&t.x>0?r.segments.push({x:0,y:t.y}):e&&e.x!==t.x&&e.y!==t.y&&r.segments.pop(),r.segments.push(t),r.updateWidth()})),(0,No.Z)(this,"drawPulseChange",(function(t){var e=r.segments[r.segments.length-1].x,n=t===To.TRUE?0:1;r.updateWidth(),r.addSegment({x:e,y:n})})),(0,No.Z)(this,"drawPulseConstant",(function(){var t=r.segments[r.segments.length-1],e=r.lastY!==t.y?t:r.segments.pop();e&&(r.updateWidth(),r.addSegment({x:e.x+1,y:e.y})),r.lastY=t.y})),(0,No.Z)(this,"truncateSegments",(function(t){if(!(t>r.width)){for(var e=r.width-t,n=0;n<r.segments.length;n++){var o=r.segments[n],i=o.x,a=o.y;if(i>e){i-e,r.segments.splice(0,n),r.segments.unshift({x:0,y:a});break}}for(var s=1;s<r.segments.length;s++){var u=r.segments[s],c=u.x,l=u.y;r.segments[s]={x:c-e,y:l}}r.updateWidth()}})),(0,No.Z)(this,"updateWidth",(function(){var t;r.width=(null===(t=r.segments.slice(-1)[0])||void 0===t?void 0:t.x)||0})),this.id=e,this.name=n,this.hue=i,this.initialize(o)})),ri=(0,Mo.Z)((function t(e,n,o){var i=this;(0,zo.Z)(this,t),(0,No.Z)(this,"id",(0,E.Z)()),(0,No.Z)(this,"name",void 0),(0,No.Z)(this,"signal",0),(0,No.Z)(this,"interval",0),(0,No.Z)(this,"lastUpdate",void 0),(0,No.Z)(this,"emitter",new oi.TinyEmitter),(0,No.Z)(this,"isStopped",!1),(0,No.Z)(this,"on",(function(t,e){i.emitter.on(t,e)})),(0,No.Z)(this,"stop",(function(){i.isStopped=!0})),(0,No.Z)(this,"start",(function(){i.isStopped=!1})),(0,No.Z)(this,"update",(function(t){!i.isStopped&&t>=i.lastUpdate+i.interval&&(i.signal=-1===i.signal?1:-1,i.lastUpdate=t,i.emitter.emit("change",i.signal))})),this.name=e,this.signal=o,this.interval=n,this.lastUpdate=-n})),ai=(0,Mo.Z)((function t(){var e=this;(0,zo.Z)(this,t),(0,No.Z)(this,"isPaused",!0),(0,No.Z)(this,"waves",{}),(0,No.Z)(this,"refreshRate",20),(0,No.Z)(this,"lastUpdateTime",Date.now()),(0,No.Z)(this,"timeMsElapsed",0),(0,No.Z)(this,"timeMsOffset",0),(0,No.Z)(this,"emitter",new oi.TinyEmitter),(0,No.Z)(this,"start",(function(){if(e.isPaused){var t=e.lastUpdateTime%e.refreshRate;e.lastUpdateTime=Date.now()+t,e.isPaused=!1,e.tick()}})),(0,No.Z)(this,"stop",(function(){e.isPaused=!0})),(0,No.Z)(this,"clear",(function(){Object.values(e.waves).forEach((function(t){t instanceof ii&&t.reset()}))})),(0,No.Z)(this,"computeWaveGeometry",(function(t){var e={},n=function(t){return t.map((function(t){var e=t.x,n=t.y;return"".concat(e,",").concat(n)}))};for(var o in t)if(t[o]instanceof ii){var i=t[o],r=n(i.segments);e[o]={points:r.join(" "),width:i.width,hue:i.hue}}return e})),(0,No.Z)(this,"on",(function(t,n){e.emitter.on(t,n)})),(0,No.Z)(this,"broadcast",(function(){var t=window.screen.width,n=1e3/e.refreshRate,o=t/n;e.timeMsElapsed>=e.timeMsOffset+o/2*1e3&&(e.timeMsOffset=e.timeMsElapsed,Object.values(e.waves).forEach((function(e){e instanceof ii&&e.truncateSegments(t)}))),e.emitter.emit("change",e.computeWaveGeometry(e.waves))})),(0,No.Z)(this,"tick",(function(){if(!e.isPaused){var t=Date.now(),n=1e4,o=!1;if(t>=e.lastUpdateTime+n)return e.stop(),void e.start();while(t>=e.lastUpdateTime+e.refreshRate){var i=Math.min(e.refreshRate,t-e.lastUpdateTime);o=!0,e.timeMsElapsed+=i,e.lastUpdateTime+=i,e.update()}o&&e.broadcast(),requestAnimationFrame(e.tick)}})),(0,No.Z)(this,"update",(function(){Object.values(e.waves).forEach((function(t){return t.update(e.timeMsElapsed)}))})),(0,No.Z)(this,"add",(function(t){e.waves.hasOwnProperty(t.id)||(e.waves[t.id]=t,0===e.timeMsElapsed&&e.broadcast())})),(0,No.Z)(this,"remove",(function(t){var n=t.id;delete e.waves[n],0===Object.keys(e.waves).length&&(e.stop(),e.clear())}))})),si=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"eval",(function(){return Object.values(t.inputValues).reduce((function(t,e){return t&&e===To.TRUE}),!0)?To.TRUE:To.FALSE})),t}return(0,Mo.Z)(n)}(Uo),ui=si,ci=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"eval",(function(){return Object.values(t.inputValues).reduce((function(t,e){return t||e===To.FALSE}),!1)?To.TRUE:To.FALSE})),t}return(0,Mo.Z)(n)}(Uo),li=ci,di=function(t){(0,Ao.Z)(n,t);var e=(0,Ro.Z)(n);function n(){var t;(0,zo.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return t=e.call.apply(e,[this].concat(i)),(0,No.Z)((0,Wo.Z)(t),"eval",(function(){var e=Object.values(t.inputValues).pop();switch(e){case To.TRUE:return To.FALSE;case To.FALSE:return To.TRUE;default:return To.UNKNOWN}})),t}return(0,Mo.Z)(n)}(Uo),pi=di;function fi(t,e,n){switch(t){case Kn.And:return new ui(e,n);case Kn.Nand:return new li(e,n);case Kn.Or:return new ti(e,n);case Kn.Nor:return new Jo(e,n);case Kn.Not:return new pi(e,n);default:return new Jo(e,n)}}function hi(t,e){var n=t.id,o=t.type,i=t.subtype;switch(o){case $n.CircuitNode:return new Uo(n,e);case $n.InputNode:return new Ho(n,e);case $n.LogicGate:return fi(i,n,e);case $n.Buffer:case $n.Freeport:return new ni(n,e);default:return new Ko(n,e)}}var mi={getLogicGateNode:fi,getCircuitNode:hi},vi=(0,Mo.Z)((function t(e,n,o){var i=this;(0,zo.Z)(this,t),(0,No.Z)(this,"nodes",{}),(0,No.Z)(this,"waves",{}),(0,No.Z)(this,"clocks",{}),(0,No.Z)(this,"valueMap",{}),(0,No.Z)(this,"circuit",new Go),(0,No.Z)(this,"oscillator",new ai),(0,No.Z)(this,"emitter",new oi.TinyEmitter),(0,No.Z)(this,"oscillogram",{}),(0,No.Z)(this,"canContinue",!1),(0,No.Z)(this,"nextState",null),(0,No.Z)(this,"isDebug",!1),(0,No.Z)(this,"nextValueMap",{}),(0,No.Z)(this,"addElements",(function(t,e,n){t.forEach((function(t){return i.addNode(t,n)})),e.forEach((function(t){return i.addConnection(t.source,t.target)}))})),(0,No.Z)(this,"onChange",(function(t){i.emitter.on("change",t)})),(0,No.Z)(this,"onError",(function(t){i.emitter.on("error",t)})),(0,No.Z)(this,"emit",(function(){i.emitter.emit("change",i.valueMap)})),(0,No.Z)(this,"step",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i.circuit.next();var e=i.circuit.queue.length>0;t>1e3&&i.emitter.emit("error","INFINITE_LOOP"),e&&i.step(++t),i.isDebug||i.emit()})),(0,No.Z)(this,"toggleClocks",(function(t){Object.values(i.clocks).forEach((function(e){return e[t]()}))})),(0,No.Z)(this,"start",(function(){i.isDebug||i.toggleClocks("start"),i.oscillator.start()})),(0,No.Z)(this,"stop",(function(){i.toggleClocks("stop"),i.oscillator.stop()})),(0,No.Z)(this,"startDebugging",(function(){i.isDebug=!0,i.computeNextState(),i.toggleClocks("stop")})),(0,No.Z)(this,"stopDebugging",(function(){i.isDebug=!1,i.advanceDebuggerStep(),i.nextState=null,i.toggleClocks("start")})),(0,No.Z)(this,"advanceDebuggerStep",(function(){if(!i.isDebug)return i.step();var t=Object.keys(i.nextValueMap);t.length>0?t.forEach((function(t){return i.updatePortValue(t,i.nextValueMap[t])})):i.nextState&&(i.valueMap=JSON.parse(i.nextState)),i.nextValueMap={},i.computeNextState(),i.emit()})),(0,No.Z)(this,"computeNextState",(function(){var t=JSON.stringify(i.valueMap);i.circuit.next();var e=JSON.stringify(i.valueMap);i.nextState=t!==e?e:null,i.canContinue=null!==i.nextState})),(0,No.Z)(this,"updatePortValue",(function(t,e){var n;i.nodes[t].setValue(e),i.circuit.enqueue(i.nodes[t]),null===(n=i.waves[t])||void 0===n||n.drawPulseChange(e)})),(0,No.Z)(this,"enqueuePortValueChange",(function(t,e){i.nextValueMap[t]=e,i.canContinue=Object.keys(i.nextValueMap).reduce((function(t,e){return t||i.valueMap[e]!==i.nextValueMap[e]}),!1)})),(0,No.Z)(this,"setPortValue",(function(t,e){if(i.isDebug)return i.enqueuePortValueChange(t,e);i.nodes[t]&&i.nodes[t].value!==e&&(i.updatePortValue(t,e),i.step())})),(0,No.Z)(this,"addIntegratedCircuit",(function(t){if(t.integratedCircuit){var e=t.integratedCircuit,n=e.items,o=e.connections,r=e.ports;Object.values(n).forEach((function(t){i.addNode(t,r)})),Object.values(o).forEach((function(t){i.addConnection(t.source,t.target)}))}})),(0,No.Z)(this,"addNode",(function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==t.portIds.length){if(t.integratedCircuit)return i.addIntegratedCircuit(t);var o,r=t.portIds.filter((function(t){return e[t].type===_o.Input})),a=t.portIds.filter((function(t){return e[t].type===_o.Output})),s=mi.getCircuitNode(t,r);if(n&&(s.forceContinue=!0),t.portIds.forEach((function(t){return i.addPort(t,s)})),s.on("change",(function(t,e){e.concat(a).forEach((function(e){var n;i.valueMap[e]=t,null===(n=i.waves[e])||void 0===n||n.drawPulseChange(t)}))})),t.type===$n.InputNode&&t.subtype===Kn.Clock)i.addClock(a[0],null===(o=t.properties.interval)||void 0===o?void 0:o.value);i.circuit.addNode(s),t.portIds.forEach((function(t){var n=e[t];n.isMonitored&&i.monitorPort(t,n.value,n.hue)}))}})),(0,No.Z)(this,"removeNode",(function(t){var e=function t(e){return e.integratedCircuit?Object.values(e.integratedCircuit.items).reduce((function(e,n){return n.integratedCircuit?e.concat(t(n)).concat(n.portIds):e.concat(n.portIds)}),[]):[]};t.portIds.concat(e(t)).forEach((function(t){var e=i.nodes[t];e&&(i.circuit.removeNode(e),i.removePort(t))})),i.emit()})),(0,No.Z)(this,"addClock",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;i.clocks[t]=new ri(t,e,1),i.clocks[t].on("change",(function(e){i.setPortValue(t,e)})),i.oscillator.add(i.clocks[t])})),(0,No.Z)(this,"setClockInterval",(function(t,e){i.clocks[t]&&(i.clocks[t].interval=e)})),(0,No.Z)(this,"addPort",(function(t,e){i.nodes[t]=e})),(0,No.Z)(this,"removePort",(function(t){i.clocks[t]&&i.oscillator.remove(i.clocks[t]),i.unmonitorPort(t),delete i.nodes[t],delete i.valueMap[t],delete i.clocks[t],delete i.waves[t]})),(0,No.Z)(this,"addConnection",(function(t,e,n){i.nodes[t]&&i.nodes[e]&&(i.circuit.addConnection(i.nodes[t],i.nodes[e],e,n),i.advanceDebuggerStep())})),(0,No.Z)(this,"removeConnection",(function(t,e,n){i.nodes[t]&&i.nodes[e]&&(i.circuit.removeConnection(i.nodes[t],i.nodes[e],n),i.advanceDebuggerStep())})),(0,No.Z)(this,"monitorPort",(function(t,e,n){i.waves[t]||(i.waves[t]=new ii(t,t,e,n),i.oscillator.add(i.waves[t]))})),(0,No.Z)(this,"unmonitorPort",(function(t){i.waves[t]&&(i.oscillator.remove(i.waves[t]),i.oscillator.broadcast()),delete i.waves[t],delete i.oscillator.waves[t],delete i.oscillogram[t]})),this.addElements(e,n,o)})),gi=function(){return{undoStack:[],redoStack:[],simulation:new vi([],[],{}),oscillogram:{},itemNames:[],zoomLevel:1,zIndex:1,oscilloscopeHeight:200,isOscilloscopeOpen:!1,isOscilloscopeRecording:!0,isCircuitEvaluated:!1,isDebugging:!1,isDirty:!1,hasLoaded:!1,isPrinting:!1,isCreatingImage:!1,animatePan:!1,debugger:{timeout:0,hasUpdated:!1},viewport:new DOMRect,canvas:{top:0,left:0,bottom:0,right:0},snapBoundaries:[],connectablePortIds:[],selectedConnectionIds:[],selectedItemIds:[],selectedPortIndex:-1,cachedState:null,activeFreeportId:null,activePortId:null,connectionPreviewId:null,items:{},connections:{},ports:{},groups:{}}};function yi(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=lo()(t),o=n.items,i=n.connections,r=n.ports,a=n.groups;function s(t){return Object.values(t).forEach((function(n){var o=n.id,i=(0,E.Z)();e[o]=i,t[i]=lo()(n),delete t[o]})),t}function u(t,n){return Object.values(t).forEach((function(t){t.groupId=null!==t.groupId?e[t.groupId]:null})),Object.values(n).forEach((function(t){t.groupId=null!==t.groupId?e[t.groupId]:null})),{connections:t,items:n}}function c(t){return Object.values(t).forEach((function(n){var o=n.id,i=(0,E.Z)();e[o]=i,t[i]=lo()(n),t[i].id=i,t[i].source=e[t[i].source],t[i].target=e[t[i].target],delete t[o]})),t}function l(t){return Object.values(t).forEach((function(n){t[n.id].connectionChainId=e[t[n.id].connectionChainId]})),t}function d(t){return Object.values(t).forEach((function(n){var o=n.id,i=(0,E.Z)();e[o]=i,t[i]=lo()(n),n.integratedCircuit?t[i].integratedCircuit=(0,Eo.Z)({serializedState:n.integratedCircuit.serializedState},yi(lo()(n.integratedCircuit),e)):t[i].id=i,t[i].portIds=n.portIds.map((function(t){return e[t]})),delete t[o]})),t}function p(t){return Object.values(t).forEach((function(n){t[n.id].elementId=e[n.elementId]})),t}function f(t){return Object.values(t).forEach((function(n){var o=n.id,i=(0,E.Z)();e[o]=i,t[i]=lo()(n),t[i].id=i,delete t[o]})),t}return r=f(r),o=d(o),r=p(r),i=c(i),i=l(i),a=s(a),(0,Eo.Z)((0,Eo.Z)({},u(i,o)),{},{ports:r,groups:a})}function bi(t){if(!t.integratedCircuit)return t;var e=yi({items:(0,No.Z)({},t.id,t),connections:{},ports:{},groups:{}}),n=e.items,o=Object.values(n)[0];return o.id=(0,E.Z)(),o}var wi={mapStandardCircuitIds:yi,mapIntegratedCircuitIds:bi};function xi(){this.copy(),this.deleteSelection()}function Ii(){var t=this;if(this.hasSelection){var e={},n={};this.selectedItemIds.forEach((function(o){e[o]=t.items[o],e[o].portIds.forEach((function(e){n[e]=t.ports[e]}))}));var o=Object.values(this.connections).reduce((function(t,e){return n[e.source]&&n[e.target]&&(t[e.id]=e),t}),{}),i=Object.values(this.groups).filter((function(t){var e=t.isSelected;return e})).reduce((function(t,e){return(0,Eo.Z)((0,Eo.Z)({},t),{},(0,No.Z)({},e.id,e))}),{}),r={items:e,ports:n,connections:o,groups:i,pasteCount:1};window.api.copy(JSON.stringify(r))}}function Zi(){var t=this;try{var e=window.api.paste(),n=JSON.parse(e),o=wi.mapStandardCircuitIds(n);this.commitState(),this.deselectAll(),Object.keys(o.ports).forEach((function(t){o.ports[t].value=0})),Object.values(o.items).forEach((function(e){e.position.x+=20*n.pasteCount,e.position.y+=20*n.pasteCount,e.isSelected=!1,t.addItem({item:e,ports:o.ports}),t.setSelectionState({id:e.id,value:!0})})),Object.values(o.connections).forEach((function(e){return t.connect(e)})),Object.values(o.groups).forEach((function(e){t.groups[e.id]=e,t.setGroupBoundingBox(e.id),t.setSelectionState({id:e.id,value:!0})}));var i=(0,Eo.Z)((0,Eo.Z)({},JSON.parse(e)),{},{pasteCount:n.pasteCount+1});window.api.copy(JSON.stringify(i))}catch(r){console.log("ERROR: ",r)}}function Ci(t){if(this.activePortId&&t){var e=this.activePortId,n=t;this.ports[this.activePortId].type===_o.Input&&(e=t,n=this.activePortId);var o=(0,E.Z)();this.unsetConnectionPreview(),this.connect({source:e,target:n,id:o}),this.connectionPreviewId=o}}function Si(){this.connectionPreviewId&&this.disconnect(this.connections[this.connectionPreviewId]),this.connectionPreviewId=null}function Di(){if(this.connectionPreviewId){var t=this.connections[this.connectionPreviewId],e=t.source,n=t.target;this.disconnect({source:e,target:n}),this.commitState(),this.connect({source:e,target:n}),this.connectionPreviewId=null}}function _i(t){var e;t&&t!==this.activePortId&&this.setActivePortId(t);var n=this.selectedPortIndex+1;n<=0&&(n=0),n>=this.connectablePortIds.length&&(n=-1);var o=this.connectablePortIds[n];!o||null!==(e=this.ports[t])&&void 0!==e&&e.connectedPortIds.includes(o)?(0===this.connectablePortIds.length&&window.api.beep(),this.unsetConnectionPreview()):this.setConnectionPreview(o),this.selectedPortIndex=n}function Pi(t){var e=t.id||(0,E.Z)();this.connections[e]=(0,Eo.Z)((0,Eo.Z)({},t),{},{id:e,connectionChainId:t.connectionChainId||e,groupId:null,zIndex:++this.zIndex,isSelected:!1}),this.ports[t.source].connectedPortIds.push(t.target),this.ports[t.target].connectedPortIds.push(t.source)}function Oi(t){this.createConnection(t),this.simulation.addConnection(t.source,t.target),this.simulation.circuit.next()}function ki(t){var e=t.source,n=t.target,o=Object.values(this.connections).find((function(t){return t.source===e&&t.target===n}));if(o){var i=this.ports[e].connectedPortIds.findIndex((function(t){return t===n})),r=this.ports[n].connectedPortIds.findIndex((function(t){return t===e}));this.ports[e].connectedPortIds.splice(i,1),this.ports[n].connectedPortIds.splice(r,1),delete this.connections[o.id]}}function Bi(t){var e=t.source,n=t.target;this.simulation.removeConnection(e,n),this.simulation.circuit.next(),this.destroyConnection({source:e,target:n})}function Ei(t){var e=JSON.parse(t),n=e.integratedCircuit?JSON.stringify(e.integratedCircuit):t;this.applyState(n),this.resetCircuit()}function Mi(){this.isPrinting=!0}function zi(){this.isCreatingImage=!0}function Ni(){this.unsetConnectionPreview(),this.connectablePortIds=[],this.selectedConnectionIds=[],this.selectedItemIds=[],this.selectedPortIndex=-1,this.cachedState=null,this.activePortId=null,this.connectionPreviewId=null}function Fi(t,e,n){var o=this,i=t.reduce((function(t,e){return t.concat(o.items[e].portIds)}),[]),r=new Set;Object.values(this.connections).forEach((function(t){var e=t.source,n=t.target,o=t.connectionChainId;(i.includes(e)||i.includes(n))&&r.add(o)}));var a=Object.values(this.connections).filter((function(t){var e=t.connectionChainId;return r.has(e)})).concat(e.map((function(t){return o.connections[t]})));a.forEach((function(t){var e;o.disconnect(t),null!==(e=o.ports[t.source])&&void 0!==e&&e.isFreeport&&o.removeElement(o.ports[t.source].elementId)})),t.forEach(this.removeElement),n.forEach((function(t){delete o.groups[t]}))}function ji(t,e,n,o,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];return{id:t,name:"",type:e,subtype:n,portIds:r.map((function(t){var e=t.id;return e})),groupId:null,rotation:0,boundingBox:{top:0,left:0,right:o,bottom:i},position:{x:0,y:0},zIndex:0,width:o,height:i,isSelected:!1,properties:{name:{type:"text",label:"Name",value:""}}}}function Li(t,e,n,o,i){return{id:e,orientation:n,name:i,position:{x:0,y:0},type:o,rotation:0,elementId:t,value:0,hue:0,isMonitored:!1,isFreeport:!1,connectedPortIds:[]}}function Ti(t){var e=t.itemId,n=t.inputPortId,o=t.outputPortId,i=t.value,r=void 0===i?0:i,a=[];o&&(this.ports[o]=Li(e,o,Zt.Left,_o.Output,o),this.ports[o].value=r,this.ports[o].isFreeport=!0,a.push(this.ports[o])),n&&(this.ports[n]=Li(e,n,Zt.Right,_o.Input,n),this.ports[n].value=r,this.ports[n].isFreeport=!0,a.push(this.ports[n])),this.items[e]=ji(e,$n.Freeport,Kn.None,1,1,a),this.items[e].zIndex=this.zIndex++,this.simulation.addNode(this.items[e],this.ports,!0)}function Wi(t){var e=this.items[t],n="",o="";Object.values(this.connections).forEach((function(t){t.target===e.portIds[1]&&(n=t.source),t.source===e.portIds[0]&&(o=t.target)})),n&&this.disconnect({source:n,target:e.portIds[1]}),o&&this.disconnect({source:e.portIds[0],target:o}),n&&o&&this.connect({source:n,target:o})}function Ai(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.items[t.itemId]){t.sourceId&&t.targetId&&this.commitState(),this.deselectAll(),this.addFreeportItem(t),this.setItemBoundingBox(t.itemId),this.activeFreeportId=t.itemId;var o=[];t.sourceId&&t.inputPortId&&o.push({source:t.sourceId,target:t.inputPortId}),t.targetId&&t.outputPortId&&o.push({source:t.outputPortId,target:t.targetId}),o.forEach((function(o){e.createConnection((0,Eo.Z)((0,Eo.Z)({},o),{},{connectionChainId:t.connectionChainId})),n&&e.simulation.addConnection(o.source,o.target,e.ports[o.source].value)})),t.sourceId&&t.targetId&&this.simulation.removeConnection(t.sourceId,t.targetId,this.ports[t.sourceId].value),t.sourceId&&t.targetId&&(this.deselectAll(),this.setSelectionState({id:t.itemId,value:!0}),this.incrementZIndex(1)),this.simulation.circuit.next()}}function Ri(t){var e=this,n=t.sourceId,o=t.targetId,i=t.portId,r=this.ports[i],a=Object.values(this.ports).find((function(t){return t.id!==i&&e.connectablePortIds.includes(t.id)&&et.isInNeighborhood(t.position,r.position,10)}));a?n?(this.disconnect({source:n,target:i}),this.connect({source:n,target:a.id})):o&&(this.disconnect({source:i,target:o}),this.connect({source:a.id,target:o})):this.disconnect({source:n||i,target:o||i});var s=Object.values(this.items).find((function(t){var e=t.portIds;return e.includes(i)}));s&&this.removeElement(s.id),this.clearStatelessInfo()}function Vi(){var t=this;this.commitState();var e=(0,E.Z)(),n=Object.values(this.items).filter((function(t){var e=t.isSelected;return e})),o=n.reduce((function(t,e){return t.concat(e.portIds)}),[]),i=Object.values(this.connections).filter((function(t){return o.includes(t.source)&&o.includes(t.target)&&t.isSelected}));n.forEach((function(e){return e.groupId&&t.destroyGroup(e.groupId)})),i.forEach((function(e){return e.groupId&&t.destroyGroup(e.groupId)}));var r=[].concat((0,N.Z)(n),(0,N.Z)(i)).reduce((function(t,e){return Math.max(e.zIndex,t)}),0),a={id:e,itemIds:n.map((function(t){var e=t.id;return e})),connectionIds:i.map((function(t){var e=t.id;return e})),isSelected:!0,boundingBox:{left:0,top:0,right:0,bottom:0},position:{x:0,y:0},zIndex:r};this.groups[e]=a,a.itemIds.forEach((function(e){t.items[e].groupId=a.id})),a.connectionIds.forEach((function(e){t.connections[e].groupId=a.id})),this.setZIndex(r),this.setGroupBoundingBox(e)}function Ui(){for(var t in this.commitState(),this.groups)this.groups[t].isSelected&&this.destroyGroup(t)}function qi(t){var e=this,n=this.groups[t];n.itemIds.forEach((function(t){e.items[t].groupId=null,e.selectedItemIds.push(t)})),n.connectionIds.forEach((function(t){e.connections[t].groupId=null,e.selectedConnectionIds.push(t)})),delete this.groups[t]}function Hi(t,e,n,o){return{x:(n.x-e.x-t.left)/o,y:(n.y-e.y-t.top)/o}}function $i(t){var e,n=this,o=t.item,i=t.ports,r=(null===(e=o.integratedCircuit)||void 0===e?void 0:e.ports)||i;o.portIds.forEach((function(t){var e=r[t];e&&(n.ports[e.id]=e,e.isMonitored&&n.monitorPort(e.id))}));var a=o.name,s=0;while(this.itemNames.includes(a))a="".concat(o.name," ").concat(++s);o.name=a,this.items[o.id]=o,this.items[o.id].zIndex=++this.zIndex,this.simulation.addNode(o,this.ports),this.resetItemValue(o),this.setProperties(o.id,o.properties),this.setItemBoundingBox(o.id)}function Ki(t){var e=t.item,n=t.ports,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!o){var i=et.getBoundingBoxMidpoint(this.viewport);o={x:i.x+this.viewport.left,y:i.y+this.viewport.top}}var r=Hi(this.canvas,this.viewport,o,this.zoomLevel);r.x-=e.width/2,r.y-=e.height/2,e.position=r,this.commitState(),this.addItem({item:e,ports:n.reduce((function(t,e){return(0,Eo.Z)((0,Eo.Z)({},t),{},(0,No.Z)({},e.id,e))}),{})}),this.setItemBoundingBox(e.id),this.setSelectionState({id:e.id,value:!0})}function Yi(t){var e,n=this,o=null===(e=t.properties)||void 0===e?void 0:e.startValue;if(o){var i=o.value;t.portIds.forEach((function(t){return n.setPortValue({id:t,value:i})}))}}function Gi(t){var e=this,n=this.items[t];if(n){n.type===$n.Freeport&&this.disconnectFreeport(t),this.simulation.removeNode(n);var o=(0,N.Z)(n.portIds);o.forEach((function(t){return e.removePort(t)})),delete this.items[t]}}function Xi(t,e){var n=this,o=this.items[t],i=o.properties.inputCount.value;if(i>e)this.items[t].portIds.filter((function(t){return n.ports[t].type===_o.Input})).slice(e).forEach((function(t){return n.removePort(t)}));else for(var r=i;r<e;r++){var a=(0,E.Z)();this.addPort(t,{id:a,name:"",connectedPortIds:[],type:_o.Input,elementId:t,virtualElementId:t,orientation:Zt.Left,isFreeport:!1,isMonitored:!1,hue:0,position:{x:0,y:0},rotation:0,value:0})}}function Ji(t,e){var n=this.items[t];for(var o in e){var i=e[o];if(n.properties[o].value!==i.value){switch(this.commitState(),o){case"inputCount":this.setInputCount(t,i.value);break;case"interval":this.simulation.setClockInterval(n.portIds.slice(-1)[0],i.value);break}this.items[t].properties[o].value=i.value}}}function Qi(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.panDelta({x:t.x-this.canvas.left,y:t.y-this.canvas.top},e)}function tr(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.animatePan=n;var o=(0,Eo.Z)({},this.canvas),i=function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=function(t){return 1-(1-t)*(1-t)},a=r(i/100),s=t.x*a,u=t.y*a;e.canvas.left=o.left+s,e.canvas.right=o.right+s,e.canvas.top=o.top+u,e.canvas.bottom=o.bottom+u,i<100&&e.animatePan?requestAnimationFrame(n.bind(e,i+5)):e.animatePan=!1};n?requestAnimationFrame(i.bind(this,0)):(this.canvas.left+=t.x,this.canvas.right+=t.x,this.canvas.top+=t.y,this.canvas.bottom+=t.y)}function er(){var t=et.getBoundingBoxMidpoint(this.canvas),e={x:this.viewport.width/2-t.x,y:this.viewport.height/2-t.y};this.panTo(e)}function nr(t,e,n){var o=Object.values(t).reduce((function(t,o){var i=t.connectionIds,r=t.freeportIds;if(n===o.connectionChainId){var a=e[o.source],s=e[o.target];i.add(o.id),null!==a&&void 0!==a&&a.isFreeport&&r.add(a.elementId),null!==s&&void 0!==s&&s.isFreeport&&r.add(s.elementId)}return{connectionIds:i,freeportIds:r}}),{connectionIds:new Set,freeportIds:new Set}),i=o.connectionIds,r=o.freeportIds;return{connectionIds:Array.from(i),freeportIds:Array.from(r)}}function or(t,e){var n=this,o=Object.values(this.simulation.nodes).find((function(e){var o=e.name;return n.items[t].portIds.includes(o)}));this.ports[e.id]=e,this.items[t].portIds.push(e.id),o?this.simulation.addPort(e.id,o):this.simulation.addNode(this.items[t],this.ports)}function ir(t){var e,n=this;if(this.items[null===(e=this.ports[t])||void 0===e?void 0:e.elementId]){Object.values(this.connections).filter((function(e){var n=e.source,o=e.target;return n===t||o===t})).forEach((function(t){var e=nr(Object.values(n.connections),n.ports,t.connectionChainId),o=e.connectionIds,i=e.freeportIds;o.forEach((function(t){return n.disconnect(n.connections[t])})),i.forEach((function(t){n.items[t].portIds.forEach((function(t){delete n.ports[t],n.simulation.removePort(t)})),delete n.items[t]}))})),this.simulation.removePort(t);var o=this.ports[t].elementId,i=this.items[o].portIds.indexOf(t);-1!==i&&this.items[o].portIds.splice(i,1),delete this.ports[t]}}function rr(t){this.activePortId!==t&&(t?this.setConnectablePortIds({portId:t}):this.connectablePortIds=[],this.activePortId=t,this.selectedPortIndex=-1)}function ar(t){var e=t.portId,n=t.isDragging,o=this.ports[e];if(!o.isFreeport){var i=Object.values(this.connections).reduce((function(t,e){return t.concat([e.source,e.target])}),[]);n&&i.splice(-2);var r=o.type===_o.Output?function(t){return t.type===_o.Input&&!t.isFreeport&&!i.includes(t.id)&&t.elementId!==o.elementId}:function(t){return t.type===_o.Output&&!t.isFreeport&&!i.includes(o.id)&&t.elementId!==o.elementId};this.connectablePortIds=Object.values(this.ports).filter(r).map((function(t){var e=t.id;return e}))}}function sr(t){var e=t.id,n=t.value;this.simulation.setPortValue(e,n),this.isDebugging&&(this.isCircuitEvaluated=!this.simulation.canContinue)}function ur(t){this.ports[t].isMonitored?this.unmonitorPort(t):this.monitorPort(t)}function cr(t){var e=this.ports[t];e.hue=e.hue||~~(360*Math.random()),e.isMonitored=!0,this.simulation.monitorPort(t,e.value,e.hue),this.isOscilloscopeOpen=!0}function lr(t){var e=this.ports[t];e.isMonitored=!1,this.simulation.unmonitorPort(t),this.isOscilloscopeOpen=Object.keys(this.oscillogram).length>0}function dr(){var t=this,e=Object.values(this.items).map((function(t){var e=t.boundingBox;return e})),n=et.getGroupBoundingBox(e),o=et.getCenteredScreenPoint(this.canvas,n,20),i=o.x,r=o.y,a=i-n.left,s=r-n.top;Object.values(this.items).forEach((function(e){t.setItemPosition({id:e.id,position:{x:e.position.x+a,y:e.position.y+s}})}))}function pr(t,e){var n=this.ports[e];n.position=Hi(this.canvas,this.viewport,t,this.zoom)}function fr(t){var e=this,n=t.id,o=t.position,i=this.items[n],r={x:o.x-i.position.x,y:o.y-i.position.y};this.items[n].position=o,this.setItemBoundingBox(n),i.portIds.forEach((function(t){var n=e.ports[t];e.ports[t].position={x:n.position.x+r.x,y:n.position.y+r.y}}))}function hr(t,e,n){var o=Hi(this.canvas,this.viewport,e,this.zoom),i=o.x,r=o.y,a=this.items[t],s=a.width,u=a.height,c=a.rotation,l=et.getBoundingBox({x:i,y:r},c,s,u),d=et.getSnapOffset(this.snapBoundaries,l,n||F.Outer,15);this.setSelectionPosition({id:t,position:{x:i+d.x,y:r+d.y}})}function mr(t){var e=this.selectedItemIds[0];if(e){var n=this.items[e],o={x:n.position.x+t.x,y:n.position.y+t.y};this.commitState(),this.setSelectionPosition({id:e,position:o})}}function vr(t){var e=this,n=t.id,o=t.position,i=this.items[n],r={x:o.x-i.position.x,y:o.y-i.position.y},a=new Set;if(this.setSelectionState({id:n,value:!0}),i.type===$n.Freeport)return this.setItemPosition({id:n,position:o});this.selectedItemIds.forEach((function(t){var n=e.items[t],o={x:n.position.x+r.x,y:n.position.y+r.y};n.groupId&&a.add(n.groupId),e.setItemPosition({id:t,position:o})})),a.forEach(this.setGroupBoundingBox)}function gr(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(t+e%4+4)%4}function yr(t,e,n){var o=t.right-t.left,i=t.bottom-t.top,r=t.left+o/2,a=t.top+i/2,s=e.position.x,u=e.position.y,c=s+e.width/2,l=u+e.height/2,d=Math.hypot(r-c,a-l),p=Math.atan2(l-a,c-r),f=90*n*(Math.PI/180)+p,h=d*Math.cos(f)+r,m=d*Math.sin(f)+a;return{x:h-e.width/2,y:m-e.height/2}}var br={rotate:gr,getGroupedItemRotatedPosition:yr};function wr(t){var e=this;this.commitState();var n=Object.values(this.items).filter((function(t){var e=t.isSelected;return e})),o=n.map((function(t){var e=t.boundingBox;return e})),i=et.getGroupBoundingBox(o),r=new Set;n.forEach((function(n){var o=br.rotate(n.rotation+t);n.groupId&&r.add(n.groupId),e.items[n.id].rotation=o,e.items[n.id].portIds.forEach((function(t){e.ports[t].rotation=o})),e.setItemPosition({id:n.id,position:br.getGroupedItemRotatedPosition(i,n,t)})})),r.forEach((function(t){e.setGroupBoundingBox(t)}))}function xr(t){this.setSelectionState({id:t,value:!1})}function Ir(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e||this.deselectAll(),this.setSelectionState({id:t,value:!0})}function Zr(){for(var t in this.clearStatelessInfo(),this.connections)this.connections[t].isSelected=!0,this.selectedConnectionIds.push(t);for(var e in this.items)this.items[e].isSelected=!0,this.selectedItemIds.push(e)}function Cr(){for(var t in this.clearStatelessInfo(),this.connections)this.connections[t].isSelected=!1,this.selectedConnectionIds=[];for(var e in this.items)this.items[e].isSelected=!1,this.selectedItemIds.push(e),this.selectedItemIds=[]}function Sr(t){var e=this;if(et.isOneOrTwoDimensional(t)){var n=Object.keys(this.items).filter((function(n){return et.hasIntersection(t,e.items[n].boundingBox)})),o=Object.keys(this.connections).filter((function(n){var o=e.connections[n],i=e.ports[o.source],r=e.ports[o.target];return et.isLineIntersectingRectangle(i.position,r.position,t)}));n.concat(o).forEach((function(t){e.updateSelectionList({id:t,isSelected:!0})})),this.selectItemConnections(n)}}function Dr(t){var e=this,n=t.reduce((function(t,n){return t.concat(e.items[n].portIds)}),[]);for(var o in this.connections){var i=this.connections[o];n.includes(i.source)&&n.includes(i.target)&&this.updateSelectionList({id:o,isSelected:!0})}}function _r(t){var e=this,n=t.id,o=t.isSelected,i=function(t,n){var i=e[n].findIndex((function(e){return e===t}));o&&-1===i&&e[n].push(t),o||-1===i||e[n].splice(i,1)};if(this.items[n])this.items[n].isSelected=o,i(n,"selectedItemIds");else if(this.connections[n]){var r=this.connections[n].connectionChainId,a=nr(Object.values(this.connections),this.ports,r),s=a.connectionIds,u=a.freeportIds;s.forEach((function(t){e.connections[t].isSelected=o,i(t,"selectedConnectionIds")})),u.forEach((function(t){e.items[t].isSelected=o,i(t,"selectedItemIds")}))}}function Pr(t){var e=this,n=t.id,o=t.value,i=this.items[n]||this.connections[n],r=o;if(i&&i.isSelected!==r)if(i.groupId){var a=this.groups[i.groupId],s=a.itemIds,u=a.connectionIds;s.concat(u).forEach((function(t){e.updateSelectionList({id:t,isSelected:r})})),this.updateSelectionList({id:i.groupId,isSelected:r})}else this.updateSelectionList({id:n,isSelected:r})}function Or(t){var e=t?this.baseItems[0]:this.baseItems.slice(-1)[0];e&&(this.deselectAll(),this.setSelectionState({id:e.id,value:!0}))}function kr(){this.hasSelection&&(this.commitState(),this.clearBaseItems(this.selectedItemIds,this.selectedConnectionIds,this.selectedGroupIds.filter((function(t){return null!==t}))),this.deselectAll())}function Br(){this.simulation.oscillator.isPaused?this.simulation.oscillator.start():this.simulation.oscillator.stop(),this.isOscilloscopeRecording=!this.simulation.oscillator.isPaused}function Er(t){var e=this;for(var n in t)if(this.ports[n]){var o=this.ports[n],i=this.items[o.elementId];i&&o.value!==t[n]&&(this.debugger.hasUpdated=!0),o.value=t[n]}this.isCircuitEvaluated=!this.simulation.canContinue,clearTimeout(this.debugger.timeout),this.debugger.timeout=window.setTimeout((function(){!e.debugger.hasUpdated&&e.simulation.canContinue&&e.isDebugging&&(e.debugger.hasUpdated=!1,e.simulation.advanceDebuggerStep())}))}function Mr(t){window.api.showMessageBox({message:"An infinite loop was detected! Entering debugger mode.",type:"error"}),this.isDebugging=!0,this.simulation.startDebugging()}function zr(){var t=this,e=Object.values(this.items),n=Object.values(this.connections);Object.values(this.ports).forEach((function(t){t.value=0})),this.simulation.stop(),this.simulation=new vi(e,n,this.ports),this.simulation.onChange(this.onSimulationUpdate),this.simulation.onError(this.onError),this.simulation.oscillator.on("change",(function(e){t.oscillogram=e})),Object.values(this.items).forEach((function(e){var n=e.properties,o=e.portIds;null!==n&&void 0!==n&&n.startValue&&o.forEach((function(e){return t.setPortValue({id:e,value:n.startValue.value})}))})),this.simulation.start(),this.isDebugging&&(this.simulation.startDebugging(),this.isCircuitEvaluated=!this.simulation.canContinue)}function Nr(){this.debugger.hasUpdated=!1,this.simulation.advanceDebuggerStep(),this.isCircuitEvaluated=!this.simulation.canContinue}function Fr(){this.isDebugging?this.simulation.stopDebugging():this.simulation.startDebugging(),this.isDebugging=!this.isDebugging}function jr(){this.isOscilloscopeOpen?this.closeOscilloscope():this.openOscilloscope()}function Lr(){var t=this;Object.values(this.ports).forEach((function(e){e.isMonitored&&t.simulation.monitorPort(e.id,e.value,e.hue)})),this.isOscilloscopeOpen=!0}function Tr(t){this.isOscilloscopeOpen&&(Object.keys(this.ports).forEach(this.simulation.unmonitorPort),this.simulation.oscillator.clear(),this.isOscilloscopeOpen=!1,t&&(this.oscilloscopeHeight=t))}function Wr(){this.simulation.oscillator.clear()}var Ar=.1;function Rr(){var t=this,e=Object.values(this.items).map((function(t){return t.boundingBox})),n=et.getGroupBoundingBox(e),o=n.right-n.left,i=n.bottom-n.top,r=this.canvas.right-this.canvas.left,a=this.canvas.bottom-this.canvas.top;(o>r||i>a)&&(this.canvas={left:0,top:0,right:2*o,bottom:2*i},this.centerAll(),this.panToCenter()),setTimeout((function(){t.setZoom({zoom:Math.min(t.viewport.width/o,t.viewport.height/i,1)})}))}function Vr(t){this.viewport=t,this.canvas.right=screen.width/Ar,this.canvas.bottom=screen.height/Ar,!this.hasLoaded&&t.width>0&&t.height>0&&(this.hasLoaded=!0,this.updateCanvasSize(),this.centerAll(),this.panToCenter())}function Ur(t){var e=t.rect,n=t.id,o=this.items[n],i=e.width/this.zoomLevel,r=e.height/this.zoomLevel,a=o.position.x+o.width/2,s=o.position.y+o.height/2,u=a-i/2,c=s-r/2;this.items[n].position={x:u,y:c},this.items[n].width=i,this.items[n].height=r,this.setItemBoundingBox(n),this.items[n].groupId&&this.setGroupBoundingBox(this.items[n].groupId)}function qr(t){if(this.items[t]){var e=this.items[t],n=e.position,o=e.rotation,i=e.width,r=e.height;this.items[t].boundingBox=et.getBoundingBox(n,o,i,r)}}function Hr(t){var e=this;if(this.groups[t]){var n=this.groups[t].itemIds.map((function(t){return e.items[t].boundingBox}));this.groups[t].boundingBox=et.getGroupBoundingBox(n)}}function $r(t){var e=this;this.snapBoundaries=function(){if(e.connectablePortIds.length)return e.connectablePortIds.filter((function(e){return e!==t})).map((function(t){return et.getPointBoundary(e.ports[t].position)}));var n=e.items[t];if(n&&!n.groupId){if(n.type!==$n.Freeport)return Object.values(e.items).filter((function(e){return e.id!==t&&e.type!==$n.Freeport})).map((function(t){return t.boundingBox}));if(n.portIds.length>1)return Object.values(e.connections).reduce((function(t,o){return n.portIds.includes(o.source)?t.concat(et.getLinearBoundaries(e.ports[o.target].position)):n.portIds.includes(o.target)?t.concat(et.getLinearBoundaries(e.ports[o.source].position)):t}),[])}return[]}()}function Kr(){var t=this.undoStack.slice(-1).pop();t&&(this.redoStack.push(JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})),this.applyState(t),this.undoStack.pop(),this.isDirty=!0)}function Yr(){var t=this.redoStack.slice(-1).pop();t&&(this.undoStack.push(JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})),this.applyState(t),this.redoStack.pop(),this.isDirty=!0)}function Gr(){this.cacheState(),this.commitCachedState()}function Xr(){this.cachedState=JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})}function Jr(){this.cachedState&&(this.undoStack.push(this.cachedState.toString()),this.cachedState=null,this.redoStack=[],this.isDirty=!0)}function Qr(t){var e=this,n=JSON.parse(t),o=n.items,i=n.connections,r=n.ports,a=n.groups;function s(t,e){var n=Object.keys(t),o=Object.keys(e);return n.filter((function(t){return!o.includes(t)}))}var u=s(this.items,o),c=s(this.connections,i),l=s(o,this.items),d=s(i,this.connections);this.clearBaseItems(u,c,[]),this.ports=r,this.items=o,this.groups=a,l.forEach((function(t){e.addItem({item:o[t],ports:r})})),d.forEach((function(t){return e.connect(i[t])})),this.stepThroughCircuit()}function ta(t,e){return t.zIndex>e.zIndex?1:t.zIndex<e.zIndex?-1:0}function ea(){this.commitState(),this.incrementZIndex(-1)}function na(){this.commitState(),this.incrementZIndex(1)}function oa(){this.commitState(),this.setZIndex(1)}function ia(){this.commitState(),this.setZIndex(this.zIndex)}function ra(t){var e=Object.values(this.items),n=Object.values(this.connections),o=e.concat(n).sort(ta),i=o.filter((function(t){var e=t.isSelected;return e})).map((function(t){var e=t.id;return e}));t>0&&i.reverse();var r=[];i.forEach((function(e){var n,i=o.findIndex((function(t){return t.id===e})),a=i+t;if(a<0||a>=o.length)r.push(o[i].id);else if(!r.includes(null===(n=o[a])||void 0===n?void 0:n.id)){var s=o[i];o.splice(i,1),o.splice(a,0,s)}})),o.forEach((function(t,e){t.zIndex=e+1})),this.zIndex=Object.keys(o).length}function aa(t){for(var e=Object.values(this.items),n=Object.values(this.connections),o=e.concat(n).sort(ta),i=o.filter((function(t){var e=t.isSelected;return e})),r=0;r<o.length;r++)o[r].isSelected&&(o.splice(r,1),r--);o.splice.apply(o,[t-1,0].concat((0,N.Z)(i))),o.forEach((function(t,e){t.zIndex=e+1})),this.zIndex=Object.keys(o).length}var sa=.1,ua=2,ca=.1;function la(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.setZoom({zoom:this.zoomLevel+ca*t})}function da(t){var e=t.zoom,n=t.point;e<sa&&(e=sa),e>ua&&(e=ua),e=Math.round(100*e)/100,n||(n=et.getBoundingBoxMidpoint(this.viewport),n.x+=this.viewport.left,n.y+=this.viewport.top);var o=Hi(this.canvas,this.viewport,n,this.zoomLevel),i={x:o.x*e,y:o.y*e},r={x:n.x-this.viewport.x,y:n.y-this.viewport.y};this.panTo({x:Math.round(Math.min(r.x-i.x,0)),y:Math.round(Math.min(r.y-i.y,0))}),this.zoomLevel=e}var pa=function(t){return(0,w.Q_)({id:t,state:gi,getters:{baseItems:function(t){return Object.values(t.connections).concat(Object.values(t.items)).sort(ta)},zoom:function(t){return t.zoomLevel},hasSelection:function(t){return t.selectedItemIds.length>0||t.selectedConnectionIds.length>0},hasSelectedItems:function(t){return t.selectedItemIds.length>0},selectedGroupIds:function(t){var e=new Set;return t.selectedItemIds.forEach((function(n){var o;return e.add(null===(o=t.items[n])||void 0===o?void 0:o.groupId)})),Array.from(e)},canGroup:function(){return this.selectedGroupIds.length>1||null===[].slice.call(this.selectedGroupIds)[0]},canUngroup:function(){return!![].slice.call(this.selectedGroupIds).find((function(t){return!!t}))},canUndo:function(t){return t.undoStack.length>0},canRedo:function(t){return t.redoStack.length>0}},actions:(0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)((0,Eo.Z)({},o),i),r),a),s),u),c),l),d),p),f),h),v),m),g),y),b)})};function fa(t,e,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Kn.CustomCircuit,r=lo()(t),a=r.ports,s=r.items,u=r.connections,c=r.groups,l=ji((0,E.Z)(),$n.IntegratedCircuit,i,n,o);return Object.values(s).forEach((function(t){var e=t.portIds.map((function(t){return a[t]})),n=0,o=e.reduce((function(t,e){return void 0===t||t===e.type?e.type:null}),void 0);if("number"===typeof o){var i=o===_o.Input?Zt.Right:Zt.Left;e.filter((function(t){return t.type===o})).forEach((function(r){var s,u=(0,E.Z)(),c=(null===(s=t.properties.name)||void 0===s?void 0:s.value)||t.name;a[u]=(0,Eo.Z)((0,Eo.Z)({},lo()(r)),{},{type:o===_o.Input?_o.Output:_o.Input,name:e.length>1?"".concat(c," ").concat(n++):c,id:u,elementId:t.id,orientation:i,value:0}),t.portIds.push(u),l.portIds.push(u)})),t.type=$n.Buffer}})),l.name=e,l.integratedCircuit={items:s,connections:u,ports:a,groups:c,serializedState:JSON.stringify({items:t.items,connections:t.connections,ports:t.ports,groups:t.groups})},l}var ha=n(8764),ma=n(5733),va=n.n(ma),ga=function(){function t(){(0,zo.Z)(this,t)}return(0,Mo.Z)(t,null,[{key:"open",value:function(){var t=(0,P.Z)((0,_.Z)().mark((function t(e){var n,o,i,r,a;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new(va()),o=window.api.openFile(e),t.next=4,n.loadAsync(o);case 4:return i=t.sent,r=i.files,t.next=8,r.content.async("text");case 8:return a=t.sent,t.abrupt("return",a);case 10:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}()},{key:"writeBlob",value:function(){var t=(0,P.Z)((0,_.Z)().mark((function t(e,n){var o,i;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.arrayBuffer();case 2:o=t.sent,i=ha.lW.from(o),window.api.saveFile(e,i);case 5:case"end":return t.stop()}}),t)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"save",value:function(){var t=(0,P.Z)((0,_.Z)().mark((function t(e,n){var o,i;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=new(va()),o.file("content",JSON.stringify(n)),t.next=4,o.generateAsync({type:"blob"});case 4:i=t.sent,this.writeBlob(e,i);case 6:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}]),t}(),ya=(0,w.Q_)("integratedCircuit",{state:function(){return{isBuilderOpen:!1,model:null,factories:{},resolve:function(){}}},actions:{launchBuilder:function(t){var e=this;return this.isBuilderOpen=!0,this.model=fa(t,"My integrated circuit",400,400),new Promise((function(t){e.resolve=t}))},loadLibrary:function(){var t=this;return(0,P.Z)((0,_.Z)().mark((function e(){var n,o;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=window.api.getFilePaths("../../Desktop","aicx"),o=0;case 2:if(!(o<n.length)){e.next=8;break}return e.next=5,t.loadCircuit(n[o]);case 5:o++,e.next=2;break;case 8:case"end":return e.stop()}}),e)})))()},loadCircuit:function(t){var e=this;return(0,P.Z)((0,_.Z)().mark((function n(){var o,i;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ga.open(t);case 3:o=n.sent,i=JSON.parse(o),e.factories[i.name]=function(){var t=wi.mapIntegratedCircuitIds(i),e=t.portIds.map((function(e){var n;return null===(n=t.integratedCircuit)||void 0===n?void 0:n.ports[e]}));return{item:t,ports:e}},n.next=12;break;case 8:n.prev=8,n.t0=n["catch"](0),console.log(n.t0),window.api.showMessageBox({message:"Could not load ".concat(t," into the integrated circuit library. The file is not a valid Aristotle circuit."),title:"Error",type:"error"});case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))()},save:function(){var t=this;return(0,P.Z)((0,_.Z)().mark((function e(){var n,o;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.model){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,n="".concat(t.model.name,".aicx"),o=window.api.showSaveFileDialog([{name:"Aristotle Integrated Circuit (*.aicx)",extensions:["aicx"]}],n),o){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,ga.save(o,t.model);case 9:return e.next=11,t.loadCircuit(o);case 11:window.api.showMessageBox({message:"Integrated circuit successfully created. You can find it in the toolbox.",title:"Success",type:"info"}),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](2),window.api.showMessageBox({message:"An error occurred while trying to save the integrated circuit.",title:"Error",type:"error"});case 17:t.close();case 18:case"end":return e.stop()}}),e,null,[[2,14]])})))()},close:function(){this.resolve(),this.isBuilderOpen=!0}}});n(3123);function ba(t){var e;return(null===(e=t.split("\\").pop())||void 0===e?void 0:e.split("/").pop())||""}var wa=(0,w.Q_)({id:"root",state:function(){return{documents:{},clipboard:null,activeDocumentId:null,canExit:!1,isFullscreen:!1,isBuilderOpen:!1,isToolboxOpen:!1}},getters:{hasOpenDocuments:function(t){return Object.keys(t.documents).length>0},activeDocument:function(t){return t.activeDocumentId?t.documents[t.activeDocumentId]:null},isDialogOpen:function(t){return t.isBuilderOpen}},actions:{launchIntegratedCircuitBuilder:function(){var t=this;return(0,P.Z)((0,_.Z)().mark((function e(){var n,o,i,r;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=ya(),o=t.activeDocument,!o){e.next=18;break}return t.isBuilderOpen=!0,e.prev=4,e.next=7,n.launchBuilder(o.store().$state);case 7:i=o.store(),r=wi.mapIntegratedCircuitIds(n.model),i.insertItemAtPosition({item:r,ports:[]}),i.setItemBoundingBox(r.id),i.setSelectionState({id:r.id,value:!0}),e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](4),window.api.showMessageBox({message:"That's okay."});case 17:t.isBuilderOpen=!1;case 18:case"end":return e.stop()}}),e,null,[[4,14]])})))()},openIntegratedCircuit:function(t){t.integratedCircuit&&this.openDocument("",t.integratedCircuit.serializedState,t.id,t.name)},saveImage:function(t){var e=this;return(0,P.Z)((0,_.Z)().mark((function n(){var o,i,r;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(e.activeDocument){n.next=2;break}return n.abrupt("return");case 2:if(n.prev=2,o=e.activeDocument.displayName.replace(/\.[^/.]+$/,""),i="".concat(o,".png"),r=window.api.showSaveFileDialog([{name:"PNG Image",extensions:[".png"]}],i),r){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,ga.writeBlob(r,t);case 10:n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](2),console.log("ERROR: ",n.t0),window.api.showMessageBox({message:"An error occurred while trying to save the image.",title:"Error",type:"error"});case 16:case"end":return n.stop()}}),n,null,[[2,12]])})))()},newDocument:function(){var t=(0,E.Z)(),e=pa(t),n=e();n.resetCircuit(),this.documents[t]={fileName:"Untitled Circuit",displayName:"Untitled Circuit",store:e},this.activateDocument(t)},closeAll:function(){var t=this;return(0,P.Z)((0,_.Z)().mark((function e(){var n;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.activeDocumentId){e.next=9;break}return e.next=3,t.closeDocument(t.activeDocumentId);case 3:return n=e.sent,e.next=6,new Promise((function(t){return setTimeout(t)}));case 6:if(!n){e.next=8;break}return e.abrupt("return",t.closeAll());case 8:return e.abrupt("return",!1);case 9:return e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e)})))()},printActiveDocument:function(){this.activeDocument&&(this.activeDocument.store().isPrinting=!0)},closeDocument:function(t){var e=this;return(0,P.Z)((0,_.Z)().mark((function n(){var o,i,r,a,s;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=e.documents[t],i=o.store(),r=!0,e.activateDocument(t),!i.isDirty){n.next=12;break}if(a=window.api.showMessageBox({message:"Save changes to ".concat(o.fileName,"?"),title:"Confirm",buttons:["Yes","No","Cancel"]}),0!==a){n.next=10;break}return n.next=9,e.saveActiveDocument();case 9:r=n.sent;case 10:if(2!==a){n.next=12;break}return n.abrupt("return",!1);case 12:return e.activeDocumentId=null,i.simulation.stop(),i.$reset(),i.$dispose(),delete e.documents[t],s=Object.keys(e.documents).pop(),s&&e.activateDocument(s),n.abrupt("return",r);case 20:case"end":return n.stop()}}),n)})))()},saveActiveDocument:function(){var t=arguments,e=this;return(0,P.Z)((0,_.Z)().mark((function n(){var o,i,r,a,s;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t.length>0&&void 0!==t[0]&&t[0],n.prev=1,e.activeDocument){n.next=4;break}return n.abrupt("return",!0);case 4:if(e.activeDocument.filePath&&!o){n.next=10;break}if(i=e.activeDocument.fileName||"".concat(e.activeDocument.fileName,".alfx"),r=window.api.showSaveFileDialog([{name:"Aristotle Logic Circuit (*.alfx)",extensions:["alfx"]}],i),r){n.next=9;break}return n.abrupt("return",!0);case 9:r&&(a=ba(r),e.activeDocument.filePath=r,e.activeDocument.fileName=a,e.activeDocument.displayName=a);case 10:if(e.activeDocument.filePath){n.next=12;break}return n.abrupt("return",!0);case 12:return s=e.activeDocument.store(),ga.save(e.activeDocument.filePath,{items:s.items,connections:s.connections,groups:s.groups,ports:s.ports}),s.isDirty=!1,n.abrupt("return",!0);case 18:return n.prev=18,n.t0=n["catch"](1),window.api.showMessageBox({message:"An error occurred while trying to save the file.",title:"Error",type:"error"}),n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[1,18]])})))()},selectDocument:function(){var t=this;return(0,P.Z)((0,_.Z)().mark((function e(){var n,o;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=window.api.showOpenFileDialog([{name:"Aristotle Logic Circuit (*.alfx)",extensions:["alfx"]},{name:"Aristotle Integrated Circuit (*.aicx)",extensions:["aicx"]}]),o=0;case 2:if(!(o<n.length)){e.next=8;break}return e.next=5,t.openDocumentFromPath(n[o]);case 5:o++,e.next=2;break;case 8:case"end":return e.stop()}}),e)})))()},openDocumentFromPath:function(t){var e=this;return(0,P.Z)((0,_.Z)().mark((function n(){var o;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,ga.open(t);case 3:o=n.sent,o&&e.openDocument(t,o,(0,E.Z)()),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),console.log(n.t0),window.api.showMessageBox({message:"Could not open ".concat(t,". The file is not a valid Aristotle circuit."),title:"Error",type:"error"});case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},openDocument:function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(this.documents[n])return this.activateDocument(n);var i=pa(n),r=i(),a=ba(t);r.loadDocument(e),this.documents[n]={fileName:a,filePath:/^.*.aicx$/i.test(t)?void 0:t,displayName:o||a,store:i},this.activateDocument(n)},switchDocument:function(t){var e=this,n=Object.keys(this.documents),o=n.findIndex((function(t){return e.activeDocumentId===t})),i=o+t;0!==n.length&&(-1===o||i>=n.length?i=0:i<0&&(i=n.length-1),this.activateDocument(n[i]))},pauseActivity:function(){var t;null===(t=this.activeDocument)||void 0===t||t.store().simulation.stop()},resumeActivity:function(){var t;null===(t=this.activeDocument)||void 0===t||t.store().simulation.start()},activateDocument:function(t){this.pauseActivity(),this.activeDocumentId=t,this.resumeActivity()},openTestDocuments:function(){this.openDocument("flip-flop.alfx",JSON.stringify(Bo),(0,E.Z)(),"flip-flop.alfx"),ya().loadLibrary()},navigateDocumentList:function(t){var e=this,n=Object.keys(this.documents),o=n.findIndex((function(t){return t===e.activeDocumentId})),i=o+t;i<0&&(i=n.length-1),i>=n.length&&(i=0),this.activateDocument(n[i])},toggleFullscreen:function(){this.isFullscreen=!this.isFullscreen,window.api.setFullscreen(this.isFullscreen)},toggleToolbox:function(){this.isToolboxOpen=!this.isToolboxOpen}}}),xa=(0,I.aZ)({name:"Item",components:{CircuitComponent:Jn,Draggable:pt,PortItem:ko,Properties:wo},props:{zIndex:{type:Number,default:1},isSelected:{type:Boolean,default:!1},id:{type:String,required:!0},flash:{type:Boolean,default:!1},store:{type:Function,required:!0}},setup:function(t,e){e.emit;var n=t.store(),o=(0,I.Fl)((function(){return n.items[t.id]})),i=(0,I.Fl)((function(){return n.viewport})),r=(0,O.iH)(),a=(0,O.iH)(0);(0,I.YP)((function(){var t;return null===(t=o.value)||void 0===t?void 0:t.rotation}),(function(){return a.value++})),(0,I.YP)((function(){var t,e;return null===(t=o.value)||void 0===t||null===(e=t.properties.inputCount)||void 0===e?void 0:e.value}),(function(){return a.value++}));var s=(0,I.Fl)((function(){return n.items[t.id].portIds.map((function(t){return n.ports[t]}))})),u=(0,I.Fl)((function(){return t.isSelected&&1===n.selectedItemIds.length&&o.value.type!==$n.Freeport}));function c(){var t;null===(t=r.value)||void 0===t||t.$el.focus()}function l(){var t;(null===(t=o.value)||void 0===t?void 0:t.subtype)===Kn.CustomCircuit&&wa().openIntegratedCircuit(o.value)}function d(){n.cacheState(),n.setSnapBoundaries(t.id)}function p(e,i){n.dragItem(t.id,{x:e.x-i.x-o.value.width/2*n.zoomLevel,y:e.y-i.y-o.value.height/2*n.zoomLevel})}function f(t){var e;document.activeElement===(null===(e=r.value)||void 0===e?void 0:e.$el)?r.value.$el.blur():t.preventDefault()}function h(t){n.activePortId===t&&n.setActivePortId(null)}function m(e){n.setItemSize({id:t.id,rect:e})}function v(){t.isSelected||n.selectItem(t.id),window.api.showContextMenu(zt(t.store))}return{item:o,itemRef:r,store:n,ports:s,viewport:i,isPropertiesEnabled:u,portUpdates:a,focus:c,onDrag:p,onDragStart:d,onEscapeKey:f,onResize:m,onPortBlur:h,onContextMenu:v,revealCustomCircuit:l,ItemSubtype:Kn,ItemType:$n}}});const Ia=(0,st.Z)(xa,[["render",Lt]]);var Za=Ia;function Ca(t,e,n,o,i,r){var a=(0,I.up)("selector"),s=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(s,{onMousewheel:t.onMouseWheel,onMousedown:(0,x.iM)(t.onMouseDown,["right"]),onTouchstart:t.onTouchStart,onTouchmove:t.onTouchMove,onTouchend:t.onTouchEnd,onResize:e[0]||(e[0]=function(e){return t.$emit("resize",e)}),class:"editor"},{default:(0,I.w5)((function(){return[(0,I._)("div",{style:(0,Z.j5)(t.style),class:"editor__grid"},[(0,I.Wm)(a,{zoom:t.zoom,onSelectionStart:t.onSelectionStart,onSelectionEnd:t.onSelectionEnd,ref:"selector"},null,8,["zoom","onSelectionStart","onSelectionEnd"]),(0,I.WI)(t.$slots,"default")],4)]})),_:3},8,["onMousewheel","onMousedown","onTouchstart","onTouchmove","onTouchend"])}function Sa(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{onMousedown:e[0]||(e[0]=(0,x.iM)((function(){return t.onMouseDown&&t.onMouseDown.apply(t,arguments)}),["left","self"])),class:"selector",ref:"selector"},[t.hasSelection?((0,I.wg)(),(0,I.iD)("div",{key:0,style:(0,Z.j5)(t.style),class:"selector__selection"},null,4)):(0,I.kq)("",!0)],544)}var Da=(0,I.aZ)({name:"Selector",emits:{selectionStart:function(t){return!0},selectionEnd:function(t){return!0}},props:{zoom:{type:Number,default:1}},setup:function(t,e){var n=e.emit,o=(0,O.iH)({x:0,y:0}),i=(0,O.iH)({x:0,y:0}),r=(0,O.iH)(null),a=(0,O.iH)(!1),s=function(){return{left:Math.min(o.value.x,i.value.x),top:Math.min(o.value.y,i.value.y),width:Math.abs(o.value.x-i.value.x),height:Math.abs(o.value.y-i.value.y)}},u=(0,I.Fl)((function(){var t=s();return{left:"".concat(t.left,"px"),top:"".concat(t.top,"px"),width:"".concat(t.width,"px"),height:"".concat(t.height,"px")}}));function c(e){if(!r.value)return{x:0,y:0};var n=r.value.getBoundingClientRect(),o=n.top,i=n.left,a=(e.x-i)/t.zoom,s=(e.y-o)/t.zoom;return{x:a,y:s}}function l(){var t=s(),e=t.left,o=t.top,i=t.width,r=t.height;n("selectionEnd",{left:e,top:o,bottom:r+o,right:e+i})}function d(t){var e=c(t);a.value=!0,o.value=e,i.value=e,n("selectionStart",t)}function p(t){a.value&&(i.value=c(t))}function f(){a.value&&(l(),a.value=!1,o.value.x=0,o.value.y=0,i.value.x=0,i.value.y=0)}return(0,I.bv)((function(){window.addEventListener("mousemove",p),window.addEventListener("mouseup",f)})),(0,I.Jd)((function(){window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f)})),{selector:r,hasSelection:a,style:u,onMouseDown:d}}});const _a=(0,st.Z)(Da,[["render",Sa]]);var Pa=_a,Oa=(0,I.aZ)({name:"Editor",emits:{resize:function(t){return!0},pan:function(t,e){return!0},selection:function(t){return!0},deselect:function(){return!0},zoom:function(t){return!0},contextmenu:function(t){return!0}},components:{Selector:Pa,Resizable:ct},props:{zoom:{type:Number,default:1},gridSize:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},offset:{type:Object,default:function(){return{x:0,y:0}}},animatePan:{type:Boolean,default:!1}},setup:function(t,e){var n=e.emit,o={x:0,y:0},i={x:0,y:0},r={y:0,x:0},a=0,s=0,u=!1,c=0,l=1,d=(0,O.iH)(null),p=(0,I.Fl)((function(){return{backgroundSize:"".concat(t.gridSize,"px ").concat(t.gridSize,"px"),transform:"scale(".concat(t.zoom,")"),left:"".concat(t.offset.x,"px"),top:"".concat(t.offset.y,"px"),width:"".concat(t.width,"px"),height:"".concat(t.height,"px")}}));function f(t){var e=t.touches,n=e[0].clientX-e[1].clientX,o=e[0].clientY-e[1].clientY;return Math.hypot(n,o)}function h(e,n){u=!0,o={x:e-t.offset.x,y:n-t.offset.y},r={x:e,y:n},i={x:e,y:n},a=0,s=0}function m(t,e){if(u){var r=i.x-t,c=i.y-e;n("pan",{x:Math.min(t-o.x,0),y:Math.min(e-o.y,0)}),a=Math.hypot(r,c),s=Math.atan2(c,r),i={x:t,y:e}}}function v(){var e=2,o=a*Math.cos(s)*e,i=a*Math.sin(s)*e;n("pan",{x:Math.min(t.offset.x-o,0),y:Math.min(t.offset.y-i,0)},!0)}function g(t){h(t.x,t.y),t.preventDefault(),t.stopPropagation()}function y(t){m(t.x,t.y)}function b(t){u&&(u=!1,2===t.button&&et.isInNeighborhood(t,r,5)?n("contextmenu",t):v())}function w(e){var n=e.touches[0],o=n.clientX,i=n.clientY;e.targetTouches.length>1?(c=f(e),l=t.zoom):h(o,i),e.preventDefault(),e.stopPropagation()}function x(t){var e=t.touches[0],o=e.clientX,i=e.clientY;if(t.preventDefault(),t.stopPropagation(),t.targetTouches.length>1&&t.changedTouches.length>1){var r=f(t),a=Math.max(Math.min(l*(r/c),4),.1),s={x:(o+t.touches[1].clientX)/2,y:(i+t.touches[1].clientY)/2};n("zoom",{zoom:a,point:s})}else 0===c&&m(o,i)}function Z(t){var e;t.target===(null===(e=d.value)||void 0===e?void 0:e.$el)&&n("deselect"),u&&v(),u=!1,c=0}function C(e){var o=e.deltaY,i=e.x,r=e.y,a=e.shiftKey;if(a){var s=o<0?1:-1,u=t.zoom+s/10;n("zoom",{zoom:u,point:{x:i,y:r}})}}function S(t){t.shiftKey||n("deselect")}function D(t){n("selection",t)}return(0,I.bv)((function(){window.addEventListener("mousemove",y),window.addEventListener("mouseup",b)})),(0,I.Jd)((function(){window.removeEventListener("mousemove",y),window.removeEventListener("mouseup",b)})),{selector:d,style:p,onTouchStart:w,onTouchMove:x,onTouchEnd:Z,onMouseDown:g,onMouseMove:y,onMouseWheel:C,onSelectionStart:S,onSelectionEnd:D}}});const ka=(0,st.Z)(Oa,[["render",Ca]]);var Ba=ka;function Ea(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["group",{"group--is-selected":t.isSelected}]),tabindex:-1,style:(0,Z.j5)({position:"absolute",left:"".concat(t.boundingBox.left,"px"),top:"".concat(t.boundingBox.top,"px"),width:"".concat(t.boundingBox.right-t.boundingBox.left,"px"),height:"".concat(t.boundingBox.bottom-t.boundingBox.top,"px"),zIndex:t.zIndex})},null,6)}var Ma=(0,I.aZ)({name:"Group",props:{boundingBox:{type:Object,required:!0},id:{type:String,required:!0},isSelected:{type:Boolean,default:!1},zIndex:{type:Number,default:0},zoom:{type:Number,default:1}}});const za=(0,st.Z)(Ma,[["render",Ea]]);var Na=za,Fa=n(9306),ja=n.n(Fa);function La(t,e,n,o){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"printer-friendly",r=e.cloneNode(!0),a=n.right-n.left+2*o,s=n.bottom-n.top+2*o,u=0;u<r.children.length;u++){var c=r.children[u],l=parseInt(c.style.left.replace("px",""),10)+o,d=parseInt(c.style.top.replace("px",""),10)+o;c.style.left="".concat(l-n.left,"px"),c.style.top="".concat(d-n.top,"px")}return r.style["zoom"]=t.toString(),r.style.width="".concat(a,"px"),r.style.height="".concat(s,"px"),r.style.position="relative",r.style.top="0",r.style.left="0",r.style.background="none",i&&r.classList.add(i),{printArea:r,width:a,height:s}}function Ta(t,e){var n=document.createElement("iframe");n.name="print",n.style.width="1px",n.style.height="1px",n.style.opacity="0",n.style.position="absolute",n.style.top="0px",n.style.left="0px",document.body.appendChild(n);var o=n.contentWindow;if(o){var i=document.createElement("style");i.appendChild(document.createTextNode("\n      @page {\n        size: ".concat(e.map((function(t){return"".concat(t,"in")})).join(" "),";\n        margin: 0in;\n      }\n    "))),o.document.head.append(i),o.document.body.appendChild(t)}return n}function Wa(t,e){return Aa.apply(this,arguments)}function Aa(){return Aa=(0,P.Z)((0,_.Z)().mark((function t(e,n){var o;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return document.body.appendChild(e),t.next=3,ja()[n](e);case 3:return o=t.sent,e.remove(),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)}))),Aa.apply(this,arguments)}function Ra(t){return Va.apply(this,arguments)}function Va(){return Va=(0,P.Z)((0,_.Z)().mark((function t(e){return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){setTimeout((function(){if(!e)return t();e.addEventListener("afterprint",(function(){return t()})),e.print()}))})));case 1:case"end":return t.stop()}}),t)}))),Va.apply(this,arguments)}function Ua(t,e,n){return qa.apply(this,arguments)}function qa(){return qa=(0,P.Z)((0,_.Z)().mark((function t(e,n,o){var i,r,a,s,u,c,l,d,p,f,h,m;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i=La(1/e,n,o,20),r=i.printArea,a=i.width,s=i.height,t.next=3,Ha.createImage(r,"toPng");case 3:return u=t.sent,c=[8.5,11],l=96*Math.min.apply(Math,c),d=96*Math.max.apply(Math,c),p=new Image,f=1,p.src=u,(a>l||a>d||s>l||s>d)&&(h=a>s,f=h?d/a:d/s,h&&c.reverse()),p.style.width="".concat(Math.floor(a*f),"px"),p.style.height="".concat(Math.floor(s*f),"px"),m=Ha.createPrintFrame(p,c),t.next=16,Ha.printWindow(null===m||void 0===m?void 0:m.contentWindow);case 16:null===m||void 0===m||m.remove();case 17:case"end":return t.stop()}}),t)}))),qa.apply(this,arguments)}var Ha={createPrintArea:La,createPrintFrame:Ta,createImage:Wa,printImage:Ua,printWindow:Ra},$a=Ha,Ka=(0,I.aZ)({name:"Document",components:{Group:Na,Editor:Ba,Connection:jt,Item:Za},props:{store:{type:Function,required:!0}},setup:function(t){var e=t.store(),n=wa(),o=(0,O.iH)(),i=(0,O.iH)(0),r=1,a={};function s(t){if(o.value){var n=Object.values(e.items).map((function(t){var e=t.boundingBox;return e})),i=et.getGroupBoundingBox(n),r=o.value.$el.querySelector(".editor__grid");t(r,i)}}function u(){return c.apply(this,arguments)}function c(){return c=(0,P.Z)((0,_.Z)().mark((function t(){return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:s(function(){var t=(0,P.Z)((0,_.Z)().mark((function t(n,o){return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,$a.printImage(e.zoom,n,o);case 2:e.isPrinting=!1;case 3:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function l(){return d.apply(this,arguments)}function d(){return d=(0,P.Z)((0,_.Z)().mark((function t(){return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:s(function(){var t=(0,P.Z)((0,_.Z)().mark((function t(o,i){var r,a,s;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=$a.createPrintArea(1/e.zoom,o,i,20,""),a=r.printArea,t.next=3,$a.createImage(a,"toBlob");case 3:return s=t.sent,t.next=6,n.saveImage(s);case 6:e.isCreatingImage=!1;case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function p(t){return function(n){n.target instanceof HTMLInputElement||(e[t](),n.preventDefault())}}function f(t){if(!(t.target instanceof HTMLInputElement))switch(t.key){case"Escape":return e.deselectAll();case"a":return t.ctrlKey&&e.selectAll();default:return v(t)}}function h(t){a[t.key]=!1,r=1}function m(e){window.api.showContextMenu(zt(t.store)),e.preventDefault(),e.stopPropagation()}function v(t){var n=function(){switch(t.key){case"ArrowLeft":return{x:-1,y:0};case"ArrowUp":return{x:0,y:-1};case"ArrowRight":return{x:1,y:0};case"ArrowDown":return{x:0,y:1}}}();if(n){var o=Math.min(r,10);e.moveSelectionPosition({x:n.x*o,y:n.y*o}),r*=1.05}}function g(){a={}}return(0,I.m0)((function(){e.isPrinting&&u(),e.isCreatingImage&&l()})),(0,I.bv)((function(){document.addEventListener("keydown",f),document.addEventListener("keyup",h),document.addEventListener("cut",p("cut")),document.addEventListener("copy",p("copy")),document.addEventListener("paste",p("paste")),window.addEventListener("blur",g)})),(0,I.Jd)((function(){document.removeEventListener("keydown",f),document.removeEventListener("keyup",h),document.addEventListener("cut",p("cut")),document.addEventListener("copy",p("copy")),document.addEventListener("paste",p("paste")),window.removeEventListener("blur",g)})),{store:e,editor:o,updates:i,storeDefinition:t.store,onKeyDown:f,onKeyUp:h,onContextMenu:m,clearKeys:g,gridSize:20}}});const Ya=(0,st.Z)(Ka,[["render",k]]);var Ga=Ya,Xa={class:"toolbar"},Ja={class:"toolbar__fixed"},Qa={class:"toolbar__left"},ts={class:"toolbar__right"};function es(t,e,n,o,i,r){var a=(0,I.up)("toolbar-button"),s=(0,I.up)("toolbar-separator"),u=(0,I.up)("scroll-fade");return(0,I.wg)(),(0,I.iD)("div",Xa,[(0,I._)("div",Ja,[(0,I.Wm)(a,{icon:t.faScrewdriverWrench,text:"Toolbox","is-toolbox":"",onClick:t.rootStore.toggleToolbox,active:t.rootStore.isToolboxOpen},null,8,["icon","onClick","active"]),(0,I.Wm)(s)]),(0,I.Wm)(u,{class:"toolbar__scrollable"},{default:(0,I.w5)((function(){return[(0,I._)("div",Qa,[(0,I.Wm)(a,{icon:t.faFolderOpen,text:"Open"},null,8,["icon"]),(0,I.Wm)(a,{icon:t.faFile,text:"New"},null,8,["icon"]),(0,I.Wm)(a,{icon:t.faSave,text:"Save"},null,8,["icon"]),(0,I.Wm)(s),(0,I.Wm)(a,{onClick:t.documentStore.undo,disabled:!t.documentStore.canUndo,icon:t.faReply,text:"Undo"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(a,{onClick:t.documentStore.redo,disabled:!t.documentStore.canRedo,icon:t.faShare,text:"Redo"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(s),(0,I.Wm)(a,{onClick:e[0]||(e[0]=function(e){return t.documentStore.rotate(1)}),disabled:!t.documentStore.hasSelectedItems,icon:t.faRotateForward,text:"Rotate"},null,8,["disabled","icon"]),(0,I.Wm)(s),(0,I.Wm)(a,{onClick:t.documentStore.group,disabled:!t.documentStore.canGroup,icon:t.faObjectGroup,text:"Group"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(a,{onClick:t.documentStore.ungroup,disabled:!t.documentStore.canUngroup,icon:t.faObjectUngroup,text:"Ungroup"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(s),(0,I.Wm)(a,{icon:t.faScissors,text:"Cut"},null,8,["icon"]),(0,I.Wm)(a,{icon:t.faCopy,text:"Copy"},null,8,["icon"]),(0,I.Wm)(a,{icon:t.faPaste,text:"Paste"},null,8,["icon"]),(0,I.Wm)(a,{onClick:t.documentStore.deleteSelection,disabled:!t.documentStore.hasSelection,icon:t.faBan,text:"Delete"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(s),(0,I.Wm)(a,{onClick:t.rootStore.launchIntegratedCircuitBuilder,icon:t.faMicrochip,text:"Export"},null,8,["onClick","icon"])]),(0,I._)("div",ts,[(0,I.Wm)(a,{icon:t.faBug,active:t.documentStore.isDebugging,onClick:t.documentStore.toggleDebugger,text:"Debug"},null,8,["icon","active","onClick"]),(0,I.Wm)(s),(0,I.Wm)(a,{icon:t.faArrowsRotate,onClick:t.documentStore.resetCircuit,text:"Reset"},null,8,["icon","onClick"]),(0,I.Wm)(a,{icon:t.faForwardStep,disabled:!t.documentStore.isDebugging||t.documentStore.isCircuitEvaluated,onClick:t.documentStore.stepThroughCircuit,text:"Next"},null,8,["icon","disabled","onClick"]),(0,I.Wm)(s),(0,I.Wm)(a,{icon:t.faWaveSquare,disabled:t.documentStore.isDebugging,active:!t.documentStore.isDebugging&&t.documentStore.isOscilloscopeOpen,onClick:t.documentStore.toggleOscilloscope,text:"Analyze"},null,8,["icon","disabled","active","onClick"])])]})),_:1})])}var ns=n(6024),os={class:"toolbar-button__text"};function is(t,e,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("button",{tabindex:0,class:(0,Z.C_)([{"toolbar-button--active":t.active&&!t.isToolbox,"toolbar-button--toolbox":t.active&&t.isToolbox,"toolbar-button--disabled":t.disabled},"toolbar-button"]),role:"button",onClick:e[0]||(e[0]=function(){return t.onClick&&t.onClick.apply(t,arguments)})},[t.icon?((0,I.wg)(),(0,I.j4)(a,{key:0,icon:t.icon,class:"toolbar-button__icon"},null,8,["icon"])):((0,I.wg)(),(0,I.j4)(a,{key:1,icon:t.faUser,class:"toolbar-button__icon"},null,8,["icon"])),(0,I._)("div",os,(0,Z.zw)(t.text),1)],2)}var rs=(0,I.aZ)({name:"ToolbarButton",components:{Icon:go},data:function(){return{faUser:uo.ILF}},emits:{click:function(t){return!0}},props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},isToolbox:{type:Boolean,default:!1},icon:{type:Object,default:null},text:{type:String,default:""}},setup:function(t,e){var n=e.emit;function o(e){e.stopPropagation(),e.preventDefault(),t.disabled||n("click",e)}return{onClick:o}}});const as=(0,st.Z)(rs,[["render",is]]);var ss=as,us={class:"toolbar-separator"};function cs(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",us)}var ls=(0,I.aZ)({name:"ToolbarSeparator"});const ds=(0,st.Z)(ls,[["render",cs]]);var ps=ds;function fs(t,e,n,o,i,r){var a=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(a,{ref:"scroll",class:(0,Z.C_)(["scroll-fade",{"scrollbar-fade--show-scrollbar":!t.hideScrollbar}]),style:(0,Z.j5)("--mask-image-content: linear-gradient(to right, ".concat(t.gradientStyle,")")),onScroll:t.onChange,onResize:t.onChange},{default:(0,I.w5)((function(){return[(0,I.WI)(t.$slots,"default")]})),_:3},8,["class","style","onScroll","onResize"])}var hs=(0,I.aZ)({name:"ScrollFade",components:{Resizable:ct},props:{hideScrollbar:{type:Boolean,default:!1}},setup:function(){var t="transparent, black var(--mask-width)",e="black calc(100% - var(--mask-width)), transparent",n=(0,O.iH)(),o=(0,O.iH)("");function i(n){var i=n.scrollWidth,r=n.scrollLeft,a=n.clientWidth;if(i>a){var s=[];return r>0&&s.push(t),r+a<i&&s.push(e),o.value=s.join(", "),s.join(", ")}return"transparent transparent"}function r(){n.value&&(o.value=i(n.value.$el))}return{onChange:r,gradientStyle:o,scroll:n}}});const ms=(0,st.Z)(hs,[["render",fs]]);var vs=ms,gs=(0,I.aZ)({name:"Toolbar",components:{ToolbarButton:ss,ToolbarSeparator:ps,ScrollFade:vs},data:function(){return{faScrewdriverWrench:uo.eDR,faFolderOpen:ns.cC_,faFile:ns.gMD,faSave:ns.r6l,faScissors:uo.EQg,faCopy:ns.kZ_,faPaste:ns.O4,faObjectGroup:ns.tU8,faObjectUngroup:ns.B7S,faRotateBackward:uo.ptP,faRotateForward:uo.fbl,faReply:uo.Lh7,faShare:uo.zBy,faMicrochip:uo.zvy,faBan:uo.gPx,faArrowsRotate:uo.T80,faBug:uo.QLU,faForwardStep:uo.Jwg,faWaveSquare:uo.fQK}},props:{store:{type:Function,required:!0}},setup:function(t){var e=wa(),n=t.store(),o=(0,I.Fl)((function(){return n.simulation.circuit.isComplete()}));return{rootStore:e,documentStore:n,isComplete:o}}});const ys=(0,st.Z)(gs,[["render",es]]);var bs=ys;function ws(t,e,n,o,i,r){var a=(0,I.up)("toolbox-item"),s=(0,I.up)("toolbox-layout");return(0,I.wg)(),(0,I.j4)(s,{"is-open":t.isOpen},(0,I.Nv)({_:2},[(0,I.Ko)(t.factories,(function(e,n){return{name:n,fn:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e,(function(e,n){return(0,I.wg)(),(0,I.j4)(a,{factory:e,key:n,label:n,zoom:t.zoom,onDrop:t.onDrop},null,8,["factory","label","zoom","onDrop"])})),128))]}))}}))]),1032,["is-open"])}var xs={class:"toolbox-item__parent"},Is={class:"toolbox-item__label"};function Zs(t,e,n,o,i,r){var a=(0,I.up)("circuit-component"),s=(0,I.up)("resizable"),u=(0,I.up)("draggable");return(0,I.wg)(),(0,I.j4)(u,{class:"toolbox-item",tabindex:0,onTouchhold:t.onDragStart,onDrag:t.onDrag,onDragEnd:t.onDragEnd,onClick:e[2]||(e[2]=function(e){return t.$emit("drop",t.factory)}),"allow-touch-drag":t.isDragging},{default:(0,I.w5)((function(){return[(0,I._)("div",xs,[(0,I.Wm)(s,{class:"toolbox-item__preview",ref:"preview",onResize:e[1]||(e[1]=function(e){return t.onSizeChanged(e,"preview")})},{default:(0,I.w5)((function(){return[(0,I.Wm)(s,{class:"toolbox-item__inner",ref:"selectable",style:(0,Z.j5)({zoom:t.zoom}),onResize:e[0]||(e[0]=function(e){return t.onSizeChanged(e,"selectable")})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{type:t.item.type,subtype:t.item.subtype,ports:t.ports,properties:t.item.properties},null,8,["type","subtype","ports","properties"])]})),_:1},8,["style"])]})),_:1},512)]),(0,I._)("div",Is,(0,Z.zw)(t.item.name||t.item.subtype),1)]})),_:1},8,["onTouchhold","onDrag","onDragEnd","allow-touch-drag"])}var Cs=(0,I.aZ)({name:"ToolboxItem",components:{CircuitComponent:Jn,Draggable:pt,Resizable:ct},emits:{drop:function(t,e){return!0}},props:{factory:{type:Function,required:!0},zoom:{type:Number,default:1}},setup:function(t,e){var n=e.emit,o=(0,O.iH)(),i=(0,O.iH)(!1),r=(0,O.iH)(1),a=t.factory(),s=a.item,u=a.ports,c={selectable:new DOMRect,preview:new DOMRect},l=null;function d(t,e){c[e]=t;var n=c.selectable,o=c.preview,i=Math.max(n.width/o.width,n.height/o.height);r.value=Math.min(1/i,1)}function p(){var e,n=c.selectable;l=null===(e=o.value)||void 0===e?void 0:e.$el.cloneNode(!0),l.style.position="absolute",l.style["zoom"]="".concat(t.zoom),l.style.width="".concat(n.width,"px"),l.style.height="".concat(n.height,"px"),i.value=!0,navigator.vibrate(20)}function f(e){var n=e.x,o=e.y;if(!l)return p();document.body.contains(l)||document.body.appendChild(l);var i=l.getBoundingClientRect(),r=i.width,a=i.height;l.style.left="".concat((n-r/2*t.zoom)/t.zoom,"px"),l.style.top="".concat((o-a/2*t.zoom)/t.zoom,"px")}function h(e){l&&(l.remove(),l=null,i.value=!1,n("drop",t.factory,e))}return{onDragStart:p,onDrag:f,onDragEnd:h,onSizeChanged:d,item:s,ports:u,zoom:r,selectable:o,isDragging:i}}});const Ss=(0,st.Z)(Cs,[["render",Zs]]);var Ds=Ss,_s=["onClick"];function Ps(t,e,n,o,i,r){var a=(0,I.up)("scroll-fade");return(0,I.wg)(),(0,I.iD)("div",{ref:"toolbox",class:(0,Z.C_)(["toolbox-layout",{"toolbox-layout--open":t.isOpen}]),style:(0,Z.j5)({height:"".concat(t.height,"px")})},[(0,I.Wm)(a,{class:"toolbox-layout__categories","hide-scrollbar":!0},{default:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.categories,(function(e){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["toolbox-layout__badge",{"toolbox-layout__badge--active":e===t.selected}]),key:e,onClick:function(n){return t.select(e)}},(0,Z.zw)(e),11,_s)})),128))]})),_:1}),(0,I.Wm)(a,{class:"toolbox-layout__items"},{default:(0,I.w5)((function(){return[(0,I.WI)(t.$slots,t.selected)]})),_:3})],6)}var Os=(0,I.aZ)({name:"Toolbox",components:{ScrollFade:vs},props:{isOpen:{type:Boolean,default:!1}},setup:function(t,e){var n=e.slots,o=(0,O.iH)(null),i=(0,O.iH)(null),r=(0,I.Fl)((function(){return Object.keys(n)})),a=(0,I.Fl)((function(){var e;return t.isOpen?null===(e=i.value)||void 0===e?void 0:e.scrollHeight:0}));function s(t){o.value=t}return s(r.value[0]),{categories:r,selected:o,select:s,height:a,toolbox:i}}});const ks=(0,st.Z)(Os,[["render",Ps]]);var Bs,Es,Ms,zs,Ns=ks,Fs=function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(0,E.Z)(),r=[Li(i,(0,E.Z)(),Zt.Right,_o.Output,"Output Port")],a=ji(i,$n.InputNode,t,e,n,r);return a.properties=(0,Eo.Z)((0,Eo.Z)((0,Eo.Z)({},a.properties),o),{},{startValue:{label:"Start value",value:-1,type:"number",options:{True:1,"Hi-Z":0,False:-1}}}),{item:a,ports:r}},js=Fs,Ls=function(){return js(Kn.Clock,60,60,{interval:{label:"Interval",value:1e3,type:"number",min:100,step:100}})},Ts=Ls;n(3290);function Ws(){var t=[],e=Array(4).fill("").reduce((function(e,n,o){var i=(0,E.Z)(),r=(0,E.Z)(),a=Li(r,i,Zt.Left,_o.Output,"Input Port ".concat(o+1)),s=ji(r,$n.InputNode,Kn.Switch,0,0,[a]);return t.push(a),{connections:{},groups:{},items:(0,Eo.Z)((0,Eo.Z)({},e.items),{},(0,No.Z)({},r,s)),ports:(0,Eo.Z)((0,Eo.Z)({},e.ports),{},(0,No.Z)({},i,a))}}),{connections:{},ports:{},items:{},groups:{}}),n=fa(e,"Digit Display",40,40,Kn.DigitDisplay);return{item:n,ports:t}}function As(){var t=(0,E.Z)(),e=[Li(t,(0,E.Z)(),Zt.Left,_o.Input,"Input Port")],n=ji(t,$n.OutputNode,Kn.Lightbulb,40,40,e);return{item:n,ports:e}}function Rs(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=(0,E.Z)(),r=Array(o).fill("").map((function(t,e){return Li(i,(0,E.Z)(),0,1,"Input Port ".concat(e))})).concat(Li(i,(0,E.Z)(),2,0,"Output Port")),a=ji(i,$n.LogicGate,t,e,n,r);return a.properties=(0,Eo.Z)((0,Eo.Z)({},a.properties),{},{inputCount:{label:"Input count",value:o,type:"number",min:o},showInOscilloscope:{label:"Show in oscilloscope",value:!1,type:"boolean"}}),{item:a,ports:r}}var Vs=(zs={},(0,No.Z)(zs,$n.InputNode,(Bs={},(0,No.Z)(Bs,Kn.Switch,js.bind(void 0,Kn.Switch,60,60)),(0,No.Z)(Bs,Kn.Clock,Ts),Bs)),(0,No.Z)(zs,$n.OutputNode,(Es={},(0,No.Z)(Es,Kn.Lightbulb,As),(0,No.Z)(Es,Kn.DigitDisplay,Ws),Es)),(0,No.Z)(zs,$n.LogicGate,(Ms={},(0,No.Z)(Ms,Kn.And,Rs.bind(void 0,Kn.And,140,50)),(0,No.Z)(Ms,Kn.Nand,Rs.bind(void 0,Kn.Nand,140,50)),(0,No.Z)(Ms,Kn.Xnor,Rs.bind(void 0,Kn.Xnor,140,50)),(0,No.Z)(Ms,Kn.Nor,Rs.bind(void 0,Kn.Nor,140,50)),(0,No.Z)(Ms,Kn.Or,Rs.bind(void 0,Kn.Or,140,50)),(0,No.Z)(Ms,Kn.Not,Rs.bind(void 0,Kn.Not,140,50,1)),Ms)),zs),Us=(0,I.aZ)({name:"Toolbox",components:{ScrollFade:vs,ToolboxItem:Ds,ToolboxLayout:Ns},props:{store:{type:Function,required:!0},isOpen:{type:Boolean,default:!1}},setup:function(t){var e=t.store(),n=ya(),o=(0,I.Fl)((function(){return e.zoom})),i=(0,I.Fl)((function(){return n.factories}));function r(t,n){e.insertItemAtPosition(t(),n)}return{factories:(0,Eo.Z)((0,Eo.Z)({},Vs),{},(0,No.Z)({},$n.IntegratedCircuit,i.value)),zoom:o,onDrop:r}}});const qs=(0,st.Z)(Us,[["render",ws]]);var Hs=qs,$s={class:"tab-item__icon"},Ks={class:"tab-item__label"};function Ys(t,e,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)([{"tab-item--active":t.active,"tab-item--dirty":t.dirty},"tab-item"]),onMousedown:e[1]||(e[1]=function(e){return t.$emit("activate")}),onTouchstart:e[2]||(e[2]=function(e){return t.$emit("activate")})},[(0,I._)("div",$s,[(0,I.Wm)(a,{icon:t.faCodeBranch},null,8,["icon"])]),(0,I._)("div",Ks,(0,Z.zw)(t.label)+(0,Z.zw)(t.dirty?"*":""),1),(0,I._)("div",{class:"tab-item__icon tab-item__icon--close",onClick:e[0]||(e[0]=(0,x.iM)((function(e){return t.$emit("close")}),["stop"]))},[(0,I.Wm)(a,{icon:t.faClose},null,8,["icon"])])],34)}var Gs=(0,I.aZ)({name:"TabItem",components:{Icon:go},props:{active:{type:Boolean,default:!1},label:{type:String,required:!0},dirty:{type:Boolean,default:!1}},setup:function(){return{faClose:uo.YIN,faCodeBranch:uo.mh3}}});const Xs=(0,st.Z)(Gs,[["render",Ys]]);var Js=Xs,Qs={class:"tab-host"},tu={class:"tab-host__list"};function eu(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",Qs,[(0,I._)("div",tu,[(0,I.WI)(t.$slots,"tabs")]),(0,I.WI)(t.$slots,"default")])}var nu=(0,I.aZ)({name:"TabHost"});const ou=(0,st.Z)(nu,[["render",eu]]);var iu=ou,ru={key:0};function au(t,e,n,o,i,r){var a=(0,I.up)("oscilloscope-title-bar"),s=(0,I.up)("oscilloscope-timeline"),u=(0,I.up)("oscilloscope-viewer");return t.isOscilloscopeOpen?((0,I.wg)(),(0,I.j4)(u,{key:0,modelValue:t.oscilloscopeHeight,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.oscilloscopeHeight=e}),"collapse-height":40,onCollapse:t.closeOscilloscope},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{clearable:t.hasWaves,"is-recording":t.isOscilloscopeRecording,onClear:t.clearOscilloscope,onToggle:t.toggleOscillatorRecording},null,8,["clearable","is-recording","onClear","onToggle"]),t.hasWaves?((0,I.wg)(),(0,I.j4)(s,{key:1,oscillogram:t.oscillogram},null,8,["oscillogram"])):((0,I.wg)(),(0,I.iD)("div",ru," no waves to observe "))]})),_:1},8,["modelValue","onCollapse"])):(0,I.kq)("",!0)}var su={class:"oscilloscope-timeline"},uu={class:"oscilloscope-timeline__list",ref:"list"},cu=["width","viewBox"],lu=["points","stroke"];function du(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",su,[(0,I._)("div",uu,[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.oscillogram,(function(t,e){return(0,I.wg)(),(0,I.iD)("div",{key:e,style:(0,Z.j5)({color:"hsla(".concat(t.hue,", var(--lightness), var(--saturation), 0.8)")}),class:"oscilloscope-timeline__label"},(0,Z.zw)(e),5)})),128))],512),(0,I._)("div",{class:"oscilloscope-timeline__display",ref:"timeline",onWheel:e[0]||(e[0]=function(){return t.onWheel&&t.onWheel.apply(t,arguments)})},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.oscillogram,(function(e,n){return(0,I.wg)(),(0,I.iD)("div",{style:(0,Z.j5)({width:"".concat(t.totalWidth,"px")}),key:n,class:"oscilloscope-timeline__item"},[(0,I._)("div",{style:(0,Z.j5)({width:"".concat(e.width,"px")}),class:"oscilloscope-timeline__svg"},[((0,I.wg)(),(0,I.iD)("svg",{width:e.width,viewBox:"0 0 ".concat(e.width," 1"),preserveAspectRatio:"none"},[(0,I._)("polyline",{points:e.points,stroke:"hsla(".concat(e.hue,", var(--lightness), var(--saturation), 0.8)"),"stroke-width":"2",fill:"none","vector-effect":"non-scaling-stroke"},null,8,lu)],8,cu))],4)],4)})),128))],544)])}var pu=(0,I.aZ)({name:"OscilloscopeTimeline",props:{oscillogram:{type:Object,required:!0}},computed:{totalWidth:function(){return Object.values(this.oscillogram).reduce((function(t,e){var n=e.width;return Math.max(n,t)}),0)}},mounted:function(){var t=this.$refs.timeline,e=this.$refs.list;this.scrollToNextInterval(),e.addEventListener("scroll",this.onTimelineScroll),t.addEventListener("scroll",this.onTimelineScroll)},beforeUnmount:function(){var t=this.$refs.timeline,e=this.$refs.list;e.removeEventListener("scroll",this.onTimelineScroll),t.removeEventListener("scroll",this.onTimelineScroll)},methods:{onWheel:function(t){var e=this.$refs.timeline;e.scrollTop+=t.deltaY/10,t.preventDefault()},scrollToNextInterval:function(){var t=this.$refs.timeline;t.scrollLeft=t.scrollWidth},onTimelineScroll:function(){var t=this.$refs.list,e=this.$refs.timeline;e&&(t.scrollTop=e.scrollTop)}},watch:{oscillogram:{handler:function(){this.scrollToNextInterval()},deep:!0}}});const fu=(0,st.Z)(pu,[["render",du]]);var hu=fu,mu={class:"oscilloscope-title-bar"},vu=(0,I._)("div",{class:"oscilloscope-title-bar__title"},"Oscilloscope",-1),gu={class:"oscilloscope-title-bar__actions"},yu=["disabled"];function bu(t,e,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",mu,[vu,(0,I._)("div",gu,[(0,I._)("button",{class:"oscilloscope-title-bar__button",title:"Close",onClick:e[0]||(e[0]=function(e){return t.$emit("close")})},[(0,I.Wm)(a,{icon:t.faClose},null,8,["icon"])]),(0,I._)("button",{class:"oscilloscope-title-bar__button",title:"Clear oscilloscope",disabled:!t.clearable,onClick:e[1]||(e[1]=function(e){return t.$emit("clear")})},[(0,I.Wm)(a,{icon:t.faBan},null,8,["icon"])],8,yu),(0,I._)("button",{class:"oscilloscope-title-bar__button",title:"Close",onClick:e[2]||(e[2]=function(e){return t.$emit("toggle")})},[(0,I.Wm)(a,{icon:t.isRecording?t.faPause:t.faPlay},null,8,["icon"])])])])}var wu=(0,I.aZ)({name:"OscilloscopeTitleBar",components:{Icon:go},props:{clearable:{type:Boolean,default:!0},isRecording:{type:Boolean,default:!0}},setup:function(){return{faBan:uo.gPx,faClose:uo.YIN,faPause:uo.XQY,faPlay:uo.zc}}});const xu=(0,st.Z)(wu,[["render",bu]]);var Iu=xu;function Zu(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{ref:"viewer",class:"oscilloscope-viewer",style:(0,Z.j5)({height:"".concat(t.height,"px")})},[(0,I._)("div",{class:"oscilloscope-viewer__touch-resizer",onTouchstart:e[1]||(e[1]=function(){return t.onTouchStart&&t.onTouchStart.apply(t,arguments)}),onTouchmove:e[2]||(e[2]=function(){return t.onTouchMove&&t.onTouchMove.apply(t,arguments)}),onTouchcancel:e[3]||(e[3]=function(){return t.onMouseUp&&t.onMouseUp.apply(t,arguments)}),onTouchend:e[4]||(e[4]=function(){return t.onMouseUp&&t.onMouseUp.apply(t,arguments)})},[(0,I._)("div",{class:"oscilloscope-viewer__mouse-resizer",onMousedown:e[0]||(e[0]=function(){return t.onMouseDown&&t.onMouseDown.apply(t,arguments)})},null,32)],32),(0,I.WI)(t.$slots,"default")],4)}var Cu=(0,I.aZ)({name:"OscilloscopeViewer",props:{collapseHeight:{type:Number,default:20},modelValue:{type:Number,required:!0}},setup:function(t,e){var n=e.emit,o=(0,O.iH)(t.modelValue),i=(0,O.iH)(),r=0,a=0,s=!1;function u(t){r=o.value,a=t.clientY,s=!0}function c(t){u(t.touches[0])}function l(e){var u;if(s&&i.value){var c=null===(u=i.value.parentElement)||void 0===u?void 0:u.getBoundingClientRect();o.value+=Math.min(a-e.clientY,(null===c||void 0===c?void 0:c.height)||1/0),a=e.clientY,o.value<=t.collapseHeight?n("collapse",r):n("update:modelValue",o.value)}}function d(t){l(t.touches[0])}function p(){s=!1}return(0,I.bv)((function(){window.addEventListener("mousemove",l),window.addEventListener("mouseup",p)})),(0,I.Ah)((function(){window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",p)})),{onMouseDown:u,onMouseUp:p,onTouchStart:c,onTouchMove:d,height:o,viewer:i}}});const Su=(0,st.Z)(Cu,[["render",Zu]]);var Du=Su,_u=(0,I.aZ)({name:"Oscilloscope",components:{OscilloscopeTimeline:hu,OscilloscopeTitleBar:Iu,OscilloscopeViewer:Du},props:{store:{type:Function,required:!0}},setup:function(t){var e=t.store(),n=(0,w.Jk)(e),o=n.oscilloscopeHeight,i=n.isOscilloscopeOpen,r=n.isOscilloscopeRecording,a=n.oscillogram,s=e.clearOscilloscope,u=e.closeOscilloscope,c=e.toggleOscillatorRecording,l=(0,I.Fl)((function(){return Object.keys(e.oscillogram).length>0}));return{hasWaves:l,oscillogram:a,oscilloscopeHeight:o,isOscilloscopeOpen:i,isOscilloscopeRecording:r,clearOscilloscope:s,closeOscilloscope:u,toggleOscillatorRecording:c}}});const Pu=(0,st.Z)(_u,[["render",au]]);var Ou=Pu,ku={key:0},Bu={key:1},Eu={key:2};function Mu(t,e,n,o,i,r){var a=(0,I.up)("icon"),s=(0,I.up)("status-bar-button"),u=(0,I.up)("status-bar-zoom"),c=(0,I.up)("status-bar-viewer");return(0,I.wg)(),(0,I.j4)(c,null,{left:(0,I.w5)((function(){return[t.isPrinting?((0,I.wg)(),(0,I.iD)("span",ku,"Printing...")):t.isCreatingImage?((0,I.wg)(),(0,I.iD)("span",Bu,"Rendering image...")):((0,I.wg)(),(0,I.iD)("span",Eu,"Ready"))]})),right:(0,I.w5)((function(){return[(0,I.Wm)(s,{title:"Zoom out",disabled:t.store.zoomLevel<=.1,onClick:e[0]||(e[0]=function(e){return t.store.incrementZoom(-1)})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{icon:t.faMinus},null,8,["icon"])]})),_:1},8,["disabled"]),(0,I.Wm)(u,{type:"range",class:"status-bar__range",min:0,step:10,max:200,zoom:t.store.zoomLevel,onZoom:e[1]||(e[1]=function(e){return t.store.setZoom({zoom:e})})},null,8,["zoom"]),(0,I.Wm)(s,{title:"Zoom in",disabled:t.store.zoomLevel>=2,onClick:e[2]||(e[2]=function(e){return t.store.incrementZoom(1)})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{icon:t.faPlus},null,8,["icon"])]})),_:1},8,["disabled"]),(0,I.Wm)(s,{width:"3em",onClick:e[3]||(e[3]=function(e){return t.store.setZoom({zoom:1})})},{default:(0,I.w5)((function(){return[(0,I.Uk)((0,Z.zw)(t.zoomPercent)+"% ",1)]})),_:1}),(0,I.Wm)(s,{title:"Toggle fullscreen",onClick:e[4]||(e[4]=function(e){return t.$emit("fullscreen")})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{icon:t.isFullscreen?t.faCompress:t.faExpand},null,8,["icon"])]})),_:1})]})),_:1})}var zu=["disabled","title"];function Nu(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("button",{class:"status-bar-button",disabled:t.disabled,title:t.title,style:(0,Z.j5)({width:t.width})},[(0,I.WI)(t.$slots,"default")],12,zu)}var Fu=(0,I.aZ)({name:"StatusBarButton",props:{disabled:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:String,default:"2em"}}});const ju=(0,st.Z)(Fu,[["render",Nu]]);var Lu=ju,Tu={class:"status-bar-viewer"},Wu={class:"status-bar-viewer__left"},Au={class:"status-bar-viewer__right"};function Ru(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",Tu,[(0,I._)("div",Wu,[(0,I.WI)(t.$slots,"left")]),(0,I._)("div",Au,[(0,I.WI)(t.$slots,"right")])])}var Vu=(0,I.aZ)({name:"StatusBarViewer"});const Uu=(0,st.Z)(Vu,[["render",Ru]]);var qu=Uu,Hu=["step","min","max","value"];function $u(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("input",{type:"range",class:"status-bar-zoom",step:t.step,min:t.min,max:t.max,value:t.value,onInput:e[0]||(e[0]=function(){return t.onInput&&t.onInput.apply(t,arguments)})},null,40,Hu)}var Ku=(0,I.aZ)({name:"StatusBarZoom",components:{Icon:go},props:{zoom:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:200},step:{type:Number,default:10}},setup:function(t,e){var n=e.emit,o=(0,I.Fl)((function(){return Math.round(100*t.zoom)}));function i(t){var e=t.target,o=parseFloat(e.value);n("zoom",o/100)}return{onInput:i,value:o}}});const Yu=(0,st.Z)(Ku,[["render",$u]]);var Gu=Yu,Xu=(0,I.aZ)({name:"StatusBar",components:{Icon:go,StatusBarButton:Lu,StatusBarViewer:qu,StatusBarZoom:Gu},props:{store:{type:Function,required:!0},isFullscreen:{type:Boolean,default:!1}},setup:function(t){var e=t.store(),n=(0,I.Fl)((function(){return e.isPrinting})),o=(0,I.Fl)((function(){return e.isCreatingImage})),i=(0,I.Fl)((function(){return Math.round(100*e.zoomLevel)}));return{store:e,isPrinting:n,isCreatingImage:o,zoomPercent:i,faMinus:uo.Kl4,faPlus:uo.r8p,faExpand:uo.TL5,faCompress:uo.Qj4}}});const Ju=(0,st.Z)(Xu,[["render",Mu]]);var Qu=Ju;function tc(){var t,e=wa(),n=null!==e.activeDocumentId,o=Object.keys(e.documents),i=null===(t=e.activeDocument)||void 0===t?void 0:t.store(),r=[{label:"&New Circuit",accelerator:"CommandOrControl+N",click:e.newDocument},{type:"separator"},{label:"&Open Circuit",accelerator:"CommandOrControl+O",click:e.selectDocument},{label:"Open &Integrated Circuit",accelerator:"CommandOrControl+Shift+O",click:e.selectDocument},{type:"separator"},{label:"Save",enabled:n,accelerator:"CommandOrControl+S",click:function(){return e.saveActiveDocument()}},{label:"Save As...",enabled:n,accelerator:"CommandOrControl+Shift+S",click:function(){return e.saveActiveDocument(!0)}},{label:"Save All",enabled:n,accelerator:"CommandOrControl+Shift+A",click:function(){return console.log("root store save all")}},{type:"separator"},{label:"Print",enabled:n,accelerator:"CommandOrControl+P",click:function(){return null===i||void 0===i?void 0:i.print()}},{type:"separator"},{label:"Export...",enabled:n,submenu:[{label:"Integrated Circuit",accelerator:"CommandOrControl+Shift+E",click:function(){return console.log("export IC")}},{label:"PNG Image",accelerator:"CommandOrControl+Shift+I",click:function(){return null===i||void 0===i?void 0:i.createImage()}}]},{type:"separator"},{label:"Preferences",submenu:[{label:"Global Preferences",accelerator:"CommandOrControl+,",click:function(){return console.log("global prefs")}},{label:"Document Preferences",accelerator:"CommandOrControl+Shift+,",click:function(){return console.log("doc prefs")}}]}];if(Object.keys(e.documents).length>1){for(var a=[{label:"Previous File",accelerator:"Ctrl+Shift+Tab",click:function(){return e.switchDocument(-1)}},{label:"Next File",accelerator:"Ctrl+Tab",click:function(){return e.switchDocument(1)}},{type:"separator"}],s=function(t){a.push({type:"checkbox",label:e.documents[o[t]].displayName,checked:e.activeDocumentId===o[t],click:function(){return e.activateDocument(o[t])}})},u=0;u<o.length;u++)s(u);r.push({type:"separator"}),r.push({label:"Switch to...",submenu:a})}return r.push({type:"separator"}),r.push({label:"Close Document",accelerator:"CmdOrCtrl+W",enabled:n,click:function(){return e.closeDocument(e.activeDocumentId)}}),r.push({type:"separator"}),r.push({label:"Exit",accelerator:"CmdOrCtrl+Q",click:function(){return window.close()}}),r}function ec(t){for(var e=t(),n=[],o=!1,i=function(t){var i=25*t/100,r=e.zoomLevel===i;o=o||r,n.push({type:"checkbox",checked:r,label:"".concat(100*i,"%"),accelerator:1===i?"CommandOrControl+0":void 0,click:function(){return e.setZoom({zoom:i})}})},r=1;r<=8;r++)i(r);o||n.unshift({type:"checkbox",checked:!0,label:"Custom"});var a=[{label:"&Zoom In",accelerator:"CommandOrControl+=",enabled:e.zoomLevel<2,click:function(){return e.incrementZoom(1)}},{label:"&Zoom Out",accelerator:"CommandOrControl+-",enabled:e.zoomLevel>.1,click:function(){return e.incrementZoom(-1)}},{label:"&Zoom...",submenu:n},{type:"separator"},{label:"&Pan to Center",accelerator:"CommandOrControl+;",click:e.panToCenter},{type:"separator"}];return a.concat(Mt(t))}function nc(){var t=wa();if(t.isDialogOpen)return[{label:"File",submenu:[{label:"Exit"}]}];var e=[{label:"File",submenu:tc()}];return t.activeDocument&&(e.push({label:"Edit",submenu:Et(t.activeDocument.store)}),e.push({label:"View",submenu:ec(t.activeDocument.store).concat([{type:"separator"},{type:"checkbox",click:t.toggleFullscreen,checked:t.isFullscreen,accelerator:"F11",label:"Fullscreen"}])})),e}var oc={class:"main-view__top"},ic={class:"main-view__middle"},rc={class:"main-view__bottom"};function ac(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["main-view",{"main-view--blurred":t.isBlurred}])},[(0,I._)("div",oc,[(0,I.WI)(t.$slots,"top")]),(0,I._)("div",ic,[(0,I.WI)(t.$slots,"middle")]),(0,I._)("div",rc,[(0,I.WI)(t.$slots,"bottom")])],2)}var sc=(0,I.aZ)({name:"MainView",props:{isBlurred:{type:Boolean,default:!1}}});const uc=(0,st.Z)(sc,[["render",ac]]);var cc=uc,lc=!1,dc={class:"builder-canvas"};function pc(t,e,n,o,i,r){var a=(0,I.up)("builder"),s=(0,I.up)("modal-button"),u=(0,I.up)("modal");return(0,I.wg)(),(0,I.j4)(u,{modelValue:t.isBuilderOpen,"onUpdate:modelValue":[e[1]||(e[1]=function(e){return t.isBuilderOpen=e}),t.close],title:"Build Circuit"},{buttons:(0,I.w5)((function(){return[(0,I.Wm)(s,{text:"Cancel",onClick:t.close,inverted:""},null,8,["onClick"]),(0,I.Wm)(s,{text:"Save",onClick:t.save},null,8,["onClick"])]})),default:(0,I.w5)((function(){return[(0,I._)("div",dc,[(0,I.Wm)(a,{modelValue:t.item,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.item=e})},null,8,["modelValue"])])]})),_:1},8,["modelValue","onUpdate:modelValue"])}var fc={class:"builder__center"};function hc(t,e,n,o,i,r){var a=(0,I.up)("builder-drop-zone"),s=(0,I.up)("builder-editable-label"),u=(0,I.up)("container");return(0,I.wg)(),(0,I.j4)(u,{class:"builder"},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{type:"top","get-child-payload":t.getCardPayload("top"),ports:t.ports.top.children,onDrop:t.onWireDrop},null,8,["get-child-payload","ports","onDrop"]),(0,I._)("div",fc,[(0,I.Wm)(a,{type:"left","get-child-payload":t.getCardPayload("left"),ports:t.ports.left.children,onDrop:t.onWireDrop},null,8,["get-child-payload","ports","onDrop"]),(0,I.Wm)(s,{modelValue:t.item.name,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.item.name=e})},null,8,["modelValue"]),(0,I.Wm)(a,{type:"right","get-child-payload":t.getCardPayload("right"),ports:t.ports.right.children,onDrop:t.onWireDrop},null,8,["get-child-payload","ports","onDrop"])]),(0,I.Wm)(a,{type:"bottom","get-child-payload":t.getCardPayload("bottom"),ports:t.ports.bottom.children,onDrop:t.onWireDrop},null,8,["get-child-payload","ports","onDrop"])]})),_:1})}var mc=n(6523);function vc(t,e,n,o,i,r){var a=(0,I.up)("port-handle"),s=(0,I.up)("port-wire"),u=(0,I.up)("builder-editable-label"),c=(0,I.up)("Draggable"),l=(0,I.up)("Container");return(0,I.wg)(),(0,I.j4)(l,{orientation:t.orientation,"animation-duration":500,"group-name":t.type,class:(0,Z.C_)("builder-drop-zone builder-drop-zone--".concat(t.orientation)),onDrop:t.onDrop,onDragEnter:t.onDragEnter,onDragLeave:t.onDragLeave,"should-accept-drop":function(){return!0},"get-child-payload":t.getChildPayload,"get-ghost-parent":t.getGhostParent},{default:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t.ports,(function(e){return(0,I.wg)(),(0,I.j4)(c,{key:e.id,tag:{value:"div",props:{class:"builder-drop-zone__io builder-drop-zone__io--".concat(t.type)}}},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{modelValue:e.name,"onUpdate:modelValue":function(t){return e.name=t}},{default:(0,I.w5)((function(){return[(0,I.Wm)(s,{type:t.type},{default:(0,I.w5)((function(){return[(0,I.Wm)(a)]})),_:1},8,["type"])]})),_:2},1032,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["tag"])})),128))]})),_:1},8,["orientation","group-name","class","onDrop","onDragEnter","onDragLeave","should-accept-drop","get-child-payload","get-ghost-parent"])}n(4723);var gc={class:"builder-editable-label"},yc=["value"];function bc(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",gc,[(0,I._)("div",{tabindex:0,class:(0,Z.C_)([{"builder-editable-label__read-only--hidden":!t.isReadOnly},"builder-editable-label__read-only"]),onFocus:e[0]||(e[0]=function(){return t.onFocus&&t.onFocus.apply(t,arguments)})},(0,Z.zw)(t.modelValue),35),t.isReadOnly?(0,I.kq)("",!0):((0,I.wg)(),(0,I.iD)("input",{key:0,class:"builder-editable-label__textbox",type:"text",ref:"inputRef",value:t.modelValue,onInput:e[1]||(e[1]=function(){return t.onInput&&t.onInput.apply(t,arguments)}),onBlur:e[2]||(e[2]=function(e){return t.isReadOnly=!0})},null,40,yc)),(0,I.WI)(t.$slots,"default")])}var wc=(0,I.aZ)({name:"BuilderEditableLabel",props:{modelValue:{type:String,default:"node"}},setup:function(t,e){var n=e.emit,o=(0,O.iH)(!0),i=(0,O.iH)();function r(){o.value=!1,(0,I.Y3)((function(){i.value&&(i.value.focus(),i.value.select())}))}function a(t){var e=t.target.value;n("update:modelValue",e)}return{isReadOnly:o,inputRef:i,onFocus:r,onInput:a}}});const xc=(0,st.Z)(wc,[["render",bc]]);var Ic=xc,Zc=(0,I.aZ)({name:"BuilderDropZone",components:{BuilderEditableLabel:Ic,Container:mc.Container,Draggable:mc.Draggable,PortHandle:qt,PortWire:ve},emits:{drop:function(t,e){return!(!t||!e)}},props:{ports:{type:Array,default:function(){return[]}},getChildPayload:{type:Function,required:!0},type:{type:String,required:!0}},computed:{orientation:function(){return["left","right"].includes(this.type)?"vertical":"horizontal"}},setup:function(t,e){var n=e.emit,o=/--([a-z]+)/gi,i="";function r(t){document.querySelectorAll(".smooth-dnd-ghost, .smooth-dnd-ghost div").forEach((function(e){var n=e.className.match(o);n&&(i=n.pop()||""),e.className=e.className.replace(o,t)}))}function a(){r("--".concat(t.type))}function s(){r(i)}function u(e){n("drop",t.type,e)}function c(){return document.querySelector(".modal")}return{onDragEnter:a,onDragLeave:s,onDrop:u,getGhostParent:c}}});const Cc=(0,st.Z)(Zc,[["render",vc]]);var Sc=Cc,Dc=function(t,e){var n=e.removedIndex,o=e.addedIndex,i=e.payload;if(null===n&&null===o)return t;var r=(0,N.Z)(t),a=i;return null!==n&&(a=r.splice(n,1)[0]),null!==o&&r.splice(o,0,a),r},_c=(0,I.aZ)({name:"Builder",components:{BuilderDropZone:Sc,BuilderEditableLabel:Ic,Container:mc.Container},emits:["update:modelValue"],props:{modelValue:{type:Object,required:!0}},setup:function(t,e){var n=e.emit,o=(0,O.iH)({left:{children:[]},top:{children:[]},right:{children:[]},bottom:{children:[]}});function i(){var e=["left","top","right","bottom"];t.modelValue.portIds=[],Object.keys(o.value).forEach((function(n){var i=n,r=o.value[i].children;r.forEach((function(n){n.orientation=e.indexOf(i),t.modelValue.portIds.push(n.id)}))})),n("update:modelValue",t.modelValue)}function r(t,e){var n=Object.assign({},o.value[t]);o.value[t].children=Dc(n.children,e),i()}function a(t){return function(e){return o.value[t].children[e]}}return t.modelValue.portIds.forEach((function(e){var n,i=null===(n=t.modelValue.integratedCircuit)||void 0===n?void 0:n.ports[e];i&&o.value[i.type===_o.Input?"left":"right"].children.push(i)})),{item:t.modelValue,ports:o,onWireDrop:r,getCardPayload:a}}});const Pc=(0,st.Z)(_c,[["render",hc]]);var Oc=Pc,kc={key:0,class:"modal"},Bc={class:"modal__inner"},Ec={class:"modal__title"},Mc={class:"modal__title-text"},zc={class:"modal__content"},Nc={key:0,class:"modal__buttons"};function Fc(t,e,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.j4)(x.uT,{name:"modal",appear:""},{default:(0,I.w5)((function(){return[t.modelValue?((0,I.wg)(),(0,I.iD)("div",kc,[(0,I._)("div",Bc,[(0,I._)("div",Ec,[(0,I._)("div",Mc,(0,Z.zw)(t.title),1),(0,I._)("button",{title:"Close",onClick:e[0]||(e[0]=function(e){return t.$emit("update:modelValue",!1)}),class:"modal__close"},[(0,I.Wm)(a,{icon:t.faClose},null,8,["icon"])])]),(0,I._)("div",zc,[(0,I.WI)(t.$slots,"default")]),t.$slots["buttons"]?((0,I.wg)(),(0,I.iD)("div",Nc,[(0,I.WI)(t.$slots,"buttons")])):(0,I.kq)("",!0)])])):(0,I.kq)("",!0)]})),_:3})}var jc=(0,I.aZ)({name:"Modal",components:{Icon:go},props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},setup:function(){var t=(0,O.iH)(!1);return{faClose:uo.YIN,show:t}}});const Lc=(0,st.Z)(jc,[["render",Fc]]);var Tc=Lc;function Wc(t,e,n,o,i,r){return(0,I.wg)(),(0,I.iD)("button",{class:(0,Z.C_)(["modal-button",{"modal-button--inverted":t.inverted}]),role:"button"},(0,Z.zw)(t.text),3)}var Ac=(0,I.aZ)({name:"ModalButton",props:{text:{type:String,required:!0},disabled:{type:Boolean,default:!1},inverted:{type:Boolean,default:!1}}});const Rc=(0,st.Z)(Ac,[["render",Wc]]);var Vc=Rc,Uc=(0,I.aZ)({name:"BuilderView",components:{Builder:Oc,Modal:Tc,ModalButton:Vc},setup:function(){var t=ya(),e=t.isBuilderOpen,n=t.model,o=t.save,i=t.close,r=(0,O.iH)(!1);return r.value=!0,{item:n,isBuilderOpen:e,save:o,close:i,isOpen:r}}});const qc=(0,st.Z)(Uc,[["render",pc]]);var Hc=qc,$c=(0,I.aZ)({name:"App",components:{Document:Ga,Toolbar:bs,TabItem:Js,TabHost:iu,Toolbox:Hs,Oscilloscope:Ou,StatusBar:Qu,MainView:cc,BuilderView:Hc},setup:function(){var t=wa(),e=(0,w.Jk)(t),n=e.activeDocument,o=e.activeDocumentId,i=e.documents,r=e.hasOpenDocuments,a=e.isFullscreen,s=e.isDialogOpen,u=e.isBuilderOpen,c=e.isToolboxOpen,l=(0,O.iH)(!1);function d(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer&&(t.dataTransfer.dropEffect="copy"),l.value=!0}function p(t){return f.apply(this,arguments)}function f(){return f=(0,P.Z)((0,_.Z)().mark((function e(n){var o,i,r;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n.stopPropagation(),n.preventDefault(),i=null===(o=n.dataTransfer)||void 0===o?void 0:o.files,!i){e.next=11;break}r=0;case 5:if(!(r<i.length)){e.next=11;break}return e.next=8,t.openDocumentFromPath(i[r].path);case 8:r++,e.next=5;break;case 11:l.value=!1;case 12:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function h(){l.value=!1}function m(t){t.ctrlKey&&"R"===t.key.toUpperCase()&&window.location.reload()}function v(){}return r.value||t.openTestDocuments(),(0,I.m0)((function(){return window.api.setApplicationMenu(nc())})),(0,I.m0)((function(){document.title=t.activeDocument?"".concat(t.activeDocument.displayName," - Aristotle"):"Aristotle"})),window.api.onBeforeClose(t.closeAll),window.api.onOpenFile(t.openDocumentFromPath),(0,I.bv)((function(){document.addEventListener("keydown",m),document.addEventListener("dragover",d),document.addEventListener("dragleave",h),document.addEventListener("drop",p)})),(0,I.Jd)((function(){document.removeEventListener("keydown",m),document.removeEventListener("dragover",d),document.removeEventListener("dragleave",h),document.removeEventListener("drop",p)})),{activeDocument:n,activeDocumentId:o,documents:i,hasOpenDocuments:r,isDropping:l,isFullscreen:a,isDialogOpen:s,isBuilderOpen:u,isToolboxOpen:c,onContextMenu:v,toggleFullscreen:t.toggleFullscreen,activateDocument:t.activateDocument,closeDocument:t.closeDocument,switchDocument:t.switchDocument,openIntegratedCircuit:t.openIntegratedCircuit}},data:function(){return{horizontal:!1,lastPosition:0,toolboxWidth:20,oscilloscopeHeight:80,isMobile:lc}}});const Kc=(0,st.Z)($c,[["render",D]]);var Yc=Kc;window.api||(window.api={showContextMenu:function(){},setApplicationMenu:function(){},showOpenFileDialog:function(){return[]},showSaveFileDialog:function(){return""},showMessageBox:function(){return 0},beep:function(){},quit:function(){},copy:function(){},paste:function(){return""},onBeforeClose:function(){},onOpenFile:function(){},openFile:function(){return""},saveFile:function(){},setFullscreen:function(){},getFilePaths:function(){return[]}}),(0,x.ri)(Yc).use((0,w.WB)()).mount("#app")}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={id:o,loaded:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=t,function(){var t=[];n.O=function(e,o,i,r){if(!o){var a=1/0;for(l=0;l<t.length;l++){o=t[l][0],i=t[l][1],r=t[l][2];for(var s=!0,u=0;u<o.length;u++)(!1&r||a>=r)&&Object.keys(n.O).every((function(t){return n.O[t](o[u])}))?o.splice(u--,1):(s=!1,r<a&&(a=r));if(s){t.splice(l--,1);var c=i();void 0!==c&&(e=c)}}return e}r=r||0;for(var l=t.length;l>0&&t[l-1][2]>r;l--)t[l]=t[l-1];t[l]=[o,i,r]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){n.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){var t={826:0};n.O.j=function(e){return 0===t[e]};var e=function(e,o){var i,r,a=o[0],s=o[1],u=o[2],c=0;if(a.some((function(e){return 0!==t[e]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(u)var l=u(n)}for(e&&e(o);c<a.length;c++)r=a[c],n.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return n.O(l)},o=self["webpackChunkaristotle"]=self["webpackChunkaristotle"]||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(354)}));o=n.O(o)})();
//# sourceMappingURL=index-legacy.4744faa3.js.map