(function(){"use strict";var e={2725:function(e,t,n){var o={};n.r(o),n.d(o,{copy:function(){return lr},cut:function(){return cr},paste:function(){return dr}});var i={};n.r(i),n.d(i,{commitPreviewedConnection:function(){return mr},connect:function(){return gr},createConnection:function(){return vr},cycleConnectionPreviews:function(){return hr},destroyConnection:function(){return br},disconnect:function(){return yr},setConnectionPreview:function(){return pr},unsetConnectionPreview:function(){return fr}});var r={};n.r(r),n.d(r,{clearBaseItems:function(){return Cr},clearStatelessInfo:function(){return Zr},createImage:function(){return Ir},loadDocument:function(){return wr},print:function(){return xr}});var a={};n.r(a),n.d(a,{addFreeportItem:function(){return Dr},connectFreeport:function(){return kr},createFreeport:function(){return Pr},disconnectFreeport:function(){return Or}});var u={};n.r(u),n.d(u,{destroyGroup:function(){return Er},group:function(){return Mr},ungroup:function(){return Br}});var s={};n.r(s),n.d(s,{addItem:function(){return Nr},insertItemAtPosition:function(){return jr},removeElement:function(){return Fr},resetItemValue:function(){return Tr},setInputCount:function(){return Lr},setProperties:function(){return Wr}});var c={};n.r(c),n.d(c,{panDelta:function(){return Ar},panTo:function(){return Vr},panToCenter:function(){return Rr}});var l={};n.r(l),n.d(l,{addPort:function(){return qr},monitorPort:function(){return Xr},removePort:function(){return Hr},setActivePortId:function(){return $r},setConnectablePortIds:function(){return Gr},setPortValue:function(){return Yr},togglePortMonitoring:function(){return Kr},unmonitorPort:function(){return Jr}});var d={};n.r(d),n.d(d,{centerAll:function(){return Qr},dragItem:function(){return na},moveSelectionPosition:function(){return oa},setItemPosition:function(){return ta},setPortRelativePosition:function(){return ea},setSelectionPosition:function(){return ia}});var p={};n.r(p),n.d(p,{rotate:function(){return sa}});var f={};n.r(f),n.d(f,{createSelection:function(){return fa},deleteSelection:function(){return ba},deselectAll:function(){return pa},deselectItem:function(){return ca},recycleSelection:function(){return ga},selectAll:function(){return da},selectItem:function(){return la},selectItemConnections:function(){return ma},setSelectionState:function(){return va},updateSelectionList:function(){return ha}});var m={};n.r(m),n.d(m,{clearOscilloscope:function(){return Oa},closeOscilloscope:function(){return Da},onError:function(){return xa},onSimulationUpdate:function(){return wa},openOscilloscope:function(){return _a},resetCircuit:function(){return Ia},stepThroughCircuit:function(){return Za},toggleDebugger:function(){return Ca},toggleOscillatorRecording:function(){return ya},toggleOscilloscope:function(){return Sa}});var h={};n.r(h),n.d(h,{setGroupBoundingBox:function(){return za},setItemBoundingBox:function(){return Ea},setItemSize:function(){return Ba},setViewerSize:function(){return Ma},updateCanvasSize:function(){return ka}});var v={};n.r(v),n.d(v,{setSnapBoundaries:function(){return Na}});var g={};n.r(g),n.d(g,{applyState:function(){return Va},cacheState:function(){return La},commitCachedState:function(){return Wa},commitState:function(){return Fa},redo:function(){return Ta},undo:function(){return ja}});var b={};n.r(b),n.d(b,{bringForward:function(){return Ua},bringToFront:function(){return Ha},incrementZIndex:function(){return $a},sendBackward:function(){return Ra},sendToBack:function(){return qa},setZIndex:function(){return Ga}});var y={};n.r(y),n.d(y,{incrementZoom:function(){return Ja},setZoom:function(){return Qa}});n(6992),n(8674),n(9601),n(7727);var w=n(8262),x=n(9963),I=n(6252),Z=n(3577),C={key:1};function S(e,t,n,o,i,r){var a=(0,I.up)("mobile-header"),u=(0,I.up)("mobile-pullout-heading"),s=(0,I.up)("mobile-preferences"),c=(0,I.up)("mobile-pullout"),l=(0,I.up)("mobile-document-tab-item"),d=(0,I.up)("mobile-popout-menu"),p=(0,I.up)("toolbar"),f=(0,I.up)("toolbox"),m=(0,I.up)("tab-item"),h=(0,I.up)("document"),v=(0,I.up)("tab-host"),g=(0,I.up)("oscilloscope"),b=(0,I.up)("status-bar"),y=(0,I.up)("main-view"),w=(0,I.up)("builder-view"),x=(0,I.up)("theme");return(0,I.wg)(),(0,I.j4)(x,{dark:e.experience.darkMode.value},{default:(0,I.w5)((function(){return[(0,I._)("div",{class:(0,Z.C_)(["app__dropzone",{"app__dropzone--active":e.isDropping}])},null,2),e.activeDocumentId&&e.activeDocument?((0,I.wg)(),(0,I.j4)(y,{key:0,"is-blurred":e.isDialogOpen,onContextmenu:e.onContextMenu},{top:(0,I.w5)((function(){return[e.isMobile?((0,I.wg)(),(0,I.iD)(I.HY,{key:0},[(0,I.Wm)(a,{onSelect:t[0]||(t[0]=function(t){return e.isDocumentSelectOpen=!0}),onOpen:t[1]||(t[1]=function(t){return e.isSettingsOpen=!0}),"document-name":e.activeDocument.displayName,"document-count":3},null,8,["document-name"]),(0,I.Wm)(c,{modelValue:e.isSettingsOpen,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.isSettingsOpen=t})},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{onClose:t[2]||(t[2]=function(t){return e.isSettingsOpen=!1})}),(0,I.Wm)(s)]})),_:1},8,["modelValue"]),(0,I.Wm)(d,{modelValue:e.isDocumentSelectOpen,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.isDocumentSelectOpen=t})},{default:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.documents,(function(t,n){return(0,I.wg)(),(0,I.j4)(l,{key:n,label:t.displayName,dirty:t.store().isDirty,active:e.activeDocumentId===n,onActivate:function(t){return e.activateDocument(n)},onClose:function(t){return e.closeDocument(n)}},null,8,["label","dirty","active","onActivate","onClose"])})),128))]})),_:1},8,["modelValue"])],64)):(0,I.kq)("",!0),((0,I.wg)(),(0,I.j4)(p,{key:e.activeDocumentId,store:e.activeDocument.store},null,8,["store"])),(0,I.Wm)(f,{"is-open":e.isToolboxOpen,store:e.activeDocument.store},null,8,["is-open","store"])]})),middle:(0,I.w5)((function(){return[(0,I.Wm)(v,null,(0,I.Nv)({default:(0,I.w5)((function(){return[((0,I.wg)(),(0,I.j4)(h,{key:e.activeDocumentId,store:e.activeDocument.store,onSwitch:e.switchDocument,onOpenIntegratedCircuit:e.openIntegratedCircuit},null,8,["store","onSwitch","onOpenIntegratedCircuit"]))]})),_:2},[e.isMobile?void 0:{name:"tabs",fn:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.documents,(function(t,n){return(0,I.wg)(),(0,I.j4)(m,{key:n,label:t.displayName,active:e.activeDocumentId===n,dirty:t.store().isDirty,onActivate:function(t){return e.activateDocument(n)},onClose:function(t){return e.closeDocument(n)}},null,8,["label","active","dirty","onActivate","onClose"])})),128))]}))}]),1024)]})),bottom:(0,I.w5)((function(){return[((0,I.wg)(),(0,I.j4)(g,{key:e.activeDocumentId,store:e.activeDocument.store},null,8,["store"])),e.isMobile?(0,I.kq)("",!0):((0,I.wg)(),(0,I.j4)(b,{key:e.activeDocumentId,store:e.activeDocument.store,"is-fullscreen":e.isFullscreen,onFullscreen:e.toggleFullscreen},null,8,["store","is-fullscreen","onFullscreen"]))]})),_:1},8,["is-blurred","onContextmenu"])):((0,I.wg)(),(0,I.iD)("div",C," no documents open "+(0,Z.zw)(e.isDropping),1)),e.isBuilderOpen?((0,I.wg)(),(0,I.j4)(w,{key:2})):(0,I.kq)("",!0)]})),_:1},8,["dark"])}var _=n(124),D=n(8534),O=n(1436),P=n(2262),k={class:"builder-canvas"};function M(e,t,n,o,i,r){var a=(0,I.up)("builder"),u=(0,I.up)("modal-button"),s=(0,I.up)("modal");return(0,I.wg)(),(0,I.j4)(s,{modelValue:e.isBuilderOpen,"onUpdate:modelValue":[t[1]||(t[1]=function(t){return e.isBuilderOpen=t}),e.close],title:"Build Circuit"},{buttons:(0,I.w5)((function(){return[(0,I.Wm)(u,{text:"Cancel",onClick:e.close,inverted:""},null,8,["onClick"]),(0,I.Wm)(u,{text:"Save",onClick:e.save},null,8,["onClick"])]})),default:(0,I.w5)((function(){return[(0,I._)("div",k,[(0,I.Wm)(a,{modelValue:e.item,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.item=t})},null,8,["modelValue"])])]})),_:1},8,["modelValue","onUpdate:modelValue"])}n(8309);var B={class:"builder__center"};function E(e,t,n,o,i,r){var a=(0,I.up)("builder-drop-zone"),u=(0,I.up)("builder-editable-label"),s=(0,I.up)("container");return(0,I.wg)(),(0,I.j4)(s,{class:"builder"},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{type:"top","get-child-payload":e.getCardPayload("top"),ports:e.ports.top.children,onDrop:e.onWireDrop},null,8,["get-child-payload","ports","onDrop"]),(0,I._)("div",B,[(0,I.Wm)(a,{type:"left","get-child-payload":e.getCardPayload("left"),ports:e.ports.left.children,onDrop:e.onWireDrop},null,8,["get-child-payload","ports","onDrop"]),(0,I.Wm)(u,{modelValue:e.item.name,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.item.name=t})},null,8,["modelValue"]),(0,I.Wm)(a,{type:"right","get-child-payload":e.getCardPayload("right"),ports:e.ports.right.children,onDrop:e.onWireDrop},null,8,["get-child-payload","ports","onDrop"])]),(0,I.Wm)(a,{type:"bottom","get-child-payload":e.getCardPayload("bottom"),ports:e.ports.bottom.children,onDrop:e.onWireDrop},null,8,["get-child-payload","ports","onDrop"])]})),_:1})}var z=n(9584),N=(n(561),n(1539),n(4747),n(7941),n(6523));function j(e,t,n,o,i,r){var a=(0,I.up)("port-handle"),u=(0,I.up)("port-wire"),s=(0,I.up)("builder-editable-label"),c=(0,I.up)("Draggable"),l=(0,I.up)("Container");return(0,I.wg)(),(0,I.j4)(l,{orientation:e.orientation,"animation-duration":500,"group-name":e.type,class:(0,Z.C_)("builder-drop-zone builder-drop-zone--".concat(e.orientation)),onDrop:e.onDrop,onDragEnter:e.onDragEnter,onDragLeave:e.onDragLeave,"should-accept-drop":function(){return!0},"get-child-payload":e.getChildPayload,"get-ghost-parent":e.getGhostParent},{default:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.ports,(function(t){return(0,I.wg)(),(0,I.j4)(c,{key:t.id,tag:{value:"div",props:{class:"builder-drop-zone__io builder-drop-zone__io--".concat(e.type)}}},{default:(0,I.w5)((function(){return[(0,I.Wm)(s,{modelValue:t.name,"onUpdate:modelValue":function(e){return t.name=e}},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{type:e.type},{default:(0,I.w5)((function(){return[(0,I.Wm)(a)]})),_:1},8,["type"])]})),_:2},1032,["modelValue","onUpdate:modelValue"])]})),_:2},1032,["tag"])})),128))]})),_:1},8,["orientation","group-name","class","onDrop","onDragEnter","onDragLeave","should-accept-drop","get-child-payload","get-ghost-parent"])}n(6699),n(4916),n(4723),n(5306);var T={class:"builder-editable-label"},F=["value"];function L(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",T,[(0,I._)("div",{tabindex:0,class:(0,Z.C_)([{"builder-editable-label__read-only--hidden":!e.isReadOnly},"builder-editable-label__read-only"]),onFocus:t[0]||(t[0]=function(){return e.onFocus&&e.onFocus.apply(e,arguments)})},(0,Z.zw)(e.modelValue),35),e.isReadOnly?(0,I.kq)("",!0):((0,I.wg)(),(0,I.iD)("input",{key:0,class:"builder-editable-label__textbox",type:"text",ref:"inputRef",value:e.modelValue,onInput:t[1]||(t[1]=function(){return e.onInput&&e.onInput.apply(e,arguments)}),onBlur:t[2]||(t[2]=function(t){return e.isReadOnly=!0})},null,40,F)),(0,I.WI)(e.$slots,"default")])}var W=(0,I.aZ)({name:"BuilderEditableLabel",props:{modelValue:{type:String,default:"node"}},setup:function(e,t){var n=t.emit,o=(0,P.iH)(!0),i=(0,P.iH)();function r(){o.value=!1,(0,I.Y3)((function(){i.value&&(i.value.focus(),i.value.select())}))}function a(e){var t=e.target.value;n("update:modelValue",t)}return{isReadOnly:o,inputRef:i,onFocus:r,onInput:a}}}),V=n(3744);const A=(0,V.Z)(W,[["render",L]]);var R=A,U={class:"port-handle"};function q(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",U,[(0,I._)("div",{class:(0,Z.C_)(["port-handle__display",{"port-handle__display--active":e.active}])},[(0,I._)("div",{class:"port-handle__hue",style:(0,Z.j5)({backgroundColor:e.backgroundColor})},null,4)],2)])}n(9653);var H=(0,I.aZ)({name:"PortHandle",props:{active:{type:Boolean,default:!1},hue:{type:Number,default:0}},setup:function(e){var t=(0,I.Fl)((function(){return e.hue>0?"hsla(".concat(e.hue,", var(--lightness), var(--saturation), 0.8)"):"var(--color-bg-secondary)"}));return{backgroundColor:t}}});const $=(0,V.Z)(H,[["render",q]]);var G=$,Y={class:"wire__port"};function K(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)("wire wire--".concat(e.type))},[(0,I._)("div",{class:(0,Z.C_)("wire__connector wire__connector--".concat(e.type))},null,2),(0,I._)("div",Y,[(0,I.WI)(e.$slots,"default")])],2)}var X=(0,I.aZ)({name:"PortWire",props:{type:{type:String,default:"top"}}});const J=(0,V.Z)(X,[["render",K]]);var Q=J,ee=(0,I.aZ)({name:"BuilderDropZone",components:{BuilderEditableLabel:R,Container:N.Container,Draggable:N.Draggable,PortHandle:G,PortWire:Q},emits:{drop:function(e,t){return!(!e||!t)}},props:{ports:{type:Array,default:function(){return[]}},getChildPayload:{type:Function,required:!0},type:{type:String,required:!0}},computed:{orientation:function(){return["left","right"].includes(this.type)?"vertical":"horizontal"}},setup:function(e,t){var n=t.emit,o=/--([a-z]+)/gi,i="";function r(e){document.querySelectorAll(".smooth-dnd-ghost, .smooth-dnd-ghost div").forEach((function(t){var n=t.className.match(o);n&&(i=n.pop()||""),t.className=t.className.replace(o,e)}))}function a(){r("--".concat(e.type))}function u(){r(i)}function s(t){n("drop",e.type,t)}function c(){return document.querySelector(".modal")}return{onDragEnter:a,onDragLeave:u,onDrop:s,getGhostParent:c}}});const te=(0,V.Z)(ee,[["render",j]]);var ne,oe=te;(function(e){e[e["Output"]=0]="Output",e[e["Input"]=1]="Input"})(ne||(ne={}));var ie=ne,re=function(e,t){var n=t.removedIndex,o=t.addedIndex,i=t.payload;if(null===n&&null===o)return e;var r=(0,z.Z)(e),a=i;return null!==n&&(a=r.splice(n,1)[0]),null!==o&&r.splice(o,0,a),r},ae=(0,I.aZ)({name:"Builder",components:{BuilderDropZone:oe,BuilderEditableLabel:R,Container:N.Container},emits:["update:modelValue"],props:{modelValue:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,o=(0,P.iH)({left:{children:[]},top:{children:[]},right:{children:[]},bottom:{children:[]}});function i(){var t=["left","top","right","bottom"];e.modelValue.portIds=[],Object.keys(o.value).forEach((function(n){var i=n,r=o.value[i].children;r.forEach((function(n){n.orientation=t.indexOf(i),e.modelValue.portIds.push(n.id)}))})),n("update:modelValue",e.modelValue)}function r(e,t){var n=Object.assign({},o.value[e]);o.value[e].children=re(n.children,t),i()}function a(e){return function(t){return o.value[e].children[t]}}return e.modelValue.portIds.forEach((function(t){var n,i=null===(n=e.modelValue.integratedCircuit)||void 0===n?void 0:n.ports[t];i&&o.value[i.type===ie.Input?"left":"right"].children.push(i)})),{item:e.modelValue,ports:o,onWireDrop:r,getCardPayload:a}}});const ue=(0,V.Z)(ae,[["render",E]]);var se,ce=ue,le=(n(1249),n(5082)),de=(n(2479),n(7327),n(2222),n(8862),n(3465)),pe=n.n(de),fe=n(5934);(function(e){e["Buffer"]="Buffer",e["CircuitNode"]="CircuitNode",e["Freeport"]="Freeport",e["InputNode"]="InputNode",e["IntegratedCircuit"]="IntegratedCircuit",e["LogicGate"]="LogicGate",e["OutputNode"]="OutputNode"})(se||(se={}));var me,he=se;(function(e){e[e["Left"]=0]="Left",e[e["Top"]=1]="Top",e[e["Right"]=2]="Right",e[e["Bottom"]=3]="Bottom"})(me||(me={}));var ve,ge=me;function be(e,t,n,o,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];return{id:e,name:"",type:t,subtype:n,portIds:r.map((function(e){var t=e.id;return t})),groupId:null,rotation:0,boundingBox:{top:0,left:0,right:o,bottom:i},position:{x:0,y:0},zIndex:0,width:o,height:i,isSelected:!1,properties:{name:{type:"text",label:"Name",value:""}}}}(function(e){e["None"]="None",e["CustomCircuit"]="CustomCircuit",e["Switch"]="Switch",e["PushButton"]="PushButton",e["Clock"]="Clock",e["Lightbulb"]="Lightbulb",e["DigitDisplay"]="DigitDisplay",e["Buffer"]="Buffer",e["Not"]="Not",e["Tristate"]="Tristate",e["And"]="And",e["Or"]="Or",e["Nand"]="Nand",e["Nor"]="Nor",e["Xnor"]="Xnor",e["Xor"]="Xor"})(ve||(ve={}));var ye=ve;function we(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ye.CustomCircuit,r=pe()(e),a=r.ports,u=r.items,s=r.connections,c=r.groups,l=be((0,fe.Z)(),he.IntegratedCircuit,i,n,o);return Object.values(u).forEach((function(e){var t=e.portIds.map((function(e){return a[e]})),n=0,o=t.reduce((function(e,t){return void 0===e||e===t.type?t.type:null}),void 0);if("number"===typeof o){var i=o===ie.Input?ge.Right:ge.Left;t.filter((function(e){return e.type===o})).forEach((function(r){var u,s=(0,fe.Z)(),c=(null===(u=e.properties.name)||void 0===u?void 0:u.value)||e.name;a[s]=(0,le.Z)((0,le.Z)({},pe()(r)),{},{type:o===ie.Input?ie.Output:ie.Input,name:t.length>1?"".concat(c," ").concat(n++):c,id:s,elementId:e.id,orientation:i,value:0}),e.portIds.push(s),l.portIds.push(s)})),e.type=he.Buffer}})),l.name=t,l.integratedCircuit={items:u,connections:s,ports:a,groups:c,serializedState:JSON.stringify({items:e.items,connections:e.connections,ports:e.ports,groups:e.groups})},l}var xe=n(3087),Ie=n(2833),Ze=n(8764),Ce=n(5733),Se=n.n(Ce),_e=function(){function e(){(0,xe.Z)(this,e)}return(0,Ie.Z)(e,null,[{key:"open",value:function(){var e=(0,D.Z)((0,_.Z)().mark((function e(t){var n,o,i,r,a;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new(Se()),o=window.api.openFile(t),e.next=4,n.loadAsync(o);case 4:return i=e.sent,r=i.files,e.next=8,r.content.async("text");case 8:return a=e.sent,e.abrupt("return",a);case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"writeBlob",value:function(){var e=(0,D.Z)((0,_.Z)().mark((function e(t,n){var o,i;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,n.arrayBuffer();case 2:o=e.sent,i=Ze.lW.from(o),window.api.saveFile(t,i);case 5:case"end":return e.stop()}}),e)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var e=(0,D.Z)((0,_.Z)().mark((function e(t,n){var o,i;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=new(Se()),o.file("content",JSON.stringify(n)),e.next=4,o.generateAsync({type:"blob"});case 4:i=e.sent,this.writeBlob(t,i);case 6:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()}]),e}(),De=n(2482);function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=pe()(e),o=n.items,i=n.connections,r=n.ports,a=n.groups;function u(e){return Object.values(e).forEach((function(n){var o=n.id,i=(0,fe.Z)();t[o]=i,e[i]=pe()(n),delete e[o]})),e}function s(e,n){return Object.values(e).forEach((function(e){e.groupId=null!==e.groupId?t[e.groupId]:null})),Object.values(n).forEach((function(e){e.groupId=null!==e.groupId?t[e.groupId]:null})),{connections:e,items:n}}function c(e){return Object.values(e).forEach((function(n){var o=n.id,i=(0,fe.Z)();t[o]=i,e[i]=pe()(n),e[i].id=i,e[i].source=t[e[i].source],e[i].target=t[e[i].target],delete e[o]})),e}function l(e){return Object.values(e).forEach((function(n){e[n.id].connectionChainId=t[e[n.id].connectionChainId]})),e}function d(e){return Object.values(e).forEach((function(n){var o=n.id,i=(0,fe.Z)();t[o]=i,e[i]=pe()(n),n.integratedCircuit?e[i].integratedCircuit=(0,le.Z)({serializedState:n.integratedCircuit.serializedState},Oe(pe()(n.integratedCircuit),t)):e[i].id=i,e[i].portIds=n.portIds.map((function(e){return t[e]})),delete e[o]})),e}function p(e){return Object.values(e).forEach((function(n){e[n.id].elementId=t[n.elementId]})),e}function f(e){return Object.values(e).forEach((function(n){var o=n.id,i=(0,fe.Z)();t[o]=i,e[i]=pe()(n),e[i].id=i,delete e[o]})),e}return r=f(r),o=d(o),r=p(r),i=c(i),i=l(i),a=u(a),(0,le.Z)((0,le.Z)({},s(i,o)),{},{ports:r,groups:a})}function Pe(e){if(!e.integratedCircuit)return e;var t=Oe({items:(0,De.Z)({},e.id,e),connections:{},ports:{},groups:{}}),n=t.items,o=Object.values(n)[0];return o.id=(0,fe.Z)(),o}var ke={mapStandardCircuitIds:Oe,mapIntegratedCircuitIds:Pe},Me=(0,w.Q_)("integratedCircuit",{state:function(){return{isBuilderOpen:!1,model:null,factories:{},resolve:function(){}}},actions:{launchBuilder:function(e){var t=this;return this.isBuilderOpen=!0,this.model=we(e,"My integrated circuit",400,400),new Promise((function(e){t.resolve=e}))},loadLibrary:function(){var e=this;return(0,D.Z)((0,_.Z)().mark((function t(){var n,o;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=window.api.getFilePaths("../../Desktop","aicx"),o=0;case 2:if(!(o<n.length)){t.next=8;break}return t.next=5,e.loadCircuit(n[o]);case 5:o++,t.next=2;break;case 8:case"end":return t.stop()}}),t)})))()},loadCircuit:function(e){var t=this;return(0,D.Z)((0,_.Z)().mark((function n(){var o,i;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_e.open(e);case 3:o=n.sent,i=JSON.parse(o),t.factories[i.name]=function(){var e=ke.mapIntegratedCircuitIds(i),t=e.portIds.map((function(t){var n;return null===(n=e.integratedCircuit)||void 0===n?void 0:n.ports[t]}));return{item:e,ports:t}},n.next=12;break;case 8:n.prev=8,n.t0=n["catch"](0),console.log(n.t0),window.api.showMessageBox({message:"Could not load ".concat(e," into the integrated circuit library. The file is not a valid Aristotle circuit."),title:"Error",type:"error"});case 12:case"end":return n.stop()}}),n,null,[[0,8]])})))()},save:function(){var e=this;return(0,D.Z)((0,_.Z)().mark((function t(){var n,o;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.model){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,n="".concat(e.model.name,".aicx"),o=window.api.showSaveFileDialog([{name:"Aristotle Integrated Circuit (*.aicx)",extensions:["aicx"]}],n),o){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,_e.save(o,e.model);case 9:return t.next=11,e.loadCircuit(o);case 11:window.api.showMessageBox({message:"Integrated circuit successfully created. You can find it in the toolbox.",title:"Success",type:"info"}),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](2),window.api.showMessageBox({message:"An error occurred while trying to save the integrated circuit.",title:"Error",type:"error"});case 17:e.close();case 18:case"end":return t.stop()}}),t,null,[[2,14]])})))()},close:function(){this.resolve(),this.isBuilderOpen=!0}}}),Be={key:0,class:"modal"},Ee={class:"modal__inner"},ze={class:"modal__title"},Ne={class:"modal__title-text"},je={class:"modal__content"},Te={key:0,class:"modal__buttons"};function Fe(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.j4)(x.uT,{name:"modal",appear:""},{default:(0,I.w5)((function(){return[e.modelValue?((0,I.wg)(),(0,I.iD)("div",Be,[(0,I._)("div",Ee,[(0,I._)("div",ze,[(0,I._)("div",Ne,(0,Z.zw)(e.title),1),(0,I._)("button",{title:"Close",onClick:t[0]||(t[0]=function(t){return e.$emit("update:modelValue",!1)}),class:"modal__close"},[(0,I.Wm)(a,{icon:e.faClose},null,8,["icon"])])]),(0,I._)("div",je,[(0,I.WI)(e.$slots,"default")]),e.$slots["buttons"]?((0,I.wg)(),(0,I.iD)("div",Te,[(0,I.WI)(e.$slots,"buttons")])):(0,I.kq)("",!0)])])):(0,I.kq)("",!0)]})),_:3})}var Le=["viewBox"],We=["d"];function Ve(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",viewBox:"0 0 ".concat(e.width," ").concat(e.height)},[(0,I._)("path",{fill:"currentColor",d:e.svgPath},null,8,We)],8,Le)}var Ae=(0,I.aZ)({name:"Icon",props:{icon:{type:Object,required:!0}},setup:function(e){var t=(0,I.Fl)((function(){return e.icon.icon[0]})),n=(0,I.Fl)((function(){return e.icon.icon[1]})),o=(0,I.Fl)((function(){return e.icon.icon[4]}));return{width:t,height:n,svgPath:o}}});const Re=(0,V.Z)(Ae,[["render",Ve]]);var Ue=Re,qe=(0,I.aZ)({name:"Modal",components:{Icon:Ue},props:{modelValue:{type:Boolean,required:!0},title:{type:String,default:""}},setup:function(){var e=(0,P.iH)(!1);return{faClose:O.YIN,show:e}}});const He=(0,V.Z)(qe,[["render",Fe]]);var $e=He;function Ge(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("button",{class:(0,Z.C_)(["modal-button",{"modal-button--inverted":e.inverted}]),role:"button"},(0,Z.zw)(e.text),3)}var Ye=(0,I.aZ)({name:"ModalButton",props:{text:{type:String,required:!0},disabled:{type:Boolean,default:!1},inverted:{type:Boolean,default:!1}}});const Ke=(0,V.Z)(Ye,[["render",Ge]]);var Xe=Ke,Je=(0,I.aZ)({name:"BuilderView",components:{Builder:ce,Modal:$e,ModalButton:Xe},setup:function(){var e=Me(),t=e.isBuilderOpen,n=e.model,o=e.save,i=e.close,r=(0,P.iH)(!1);return r.value=!0,{item:n,isBuilderOpen:t,save:o,close:i,isOpen:r}}});const Qe=(0,V.Z)(Je,[["render",M]]);var et=Qe;function tt(e,t,n,o,i,r){var a=(0,I.up)("item"),u=(0,I.up)("connection"),s=(0,I.up)("group"),c=(0,I.up)("editor");return(0,I.wg)(),(0,I.j4)(c,{ref:"editor",zoom:e.store.zoomLevel,"grid-size":e.grid.showGrid.value?e.grid.gridSize.value:0,tabindex:0,offset:{x:e.store.canvas.left,y:e.store.canvas.top},style:(0,Z.j5)({"--color-on":e.colors.onColor.value,"--color-off":e.colors.offColor.value,"--color-hi-i":e.colors.unknownColor.value}),width:e.store.canvas.right-e.store.canvas.left,height:e.store.canvas.bottom-e.store.canvas.top,onPan:e.store.panTo,onDeselect:e.store.deselectAll,onSelection:e.store.createSelection,onZoom:e.store.setZoom,onContextmenu:e.onContextMenu,onResize:e.store.setViewerSize},{default:(0,I.w5)((function(){return[(0,I._)("div",{tabindex:0,onFocus:t[0]||(t[0]=function(t){return e.store.recycleSelection(!1)})},null,32),e.store.hasLoaded?((0,I.wg)(!0),(0,I.iD)(I.HY,{key:0},(0,I.Ko)(e.store.baseItems,(function(t){return(0,I.wg)(),(0,I.iD)(I.HY,null,["type"in t?((0,I.wg)(),(0,I.j4)(a,{tabindex:0,store:e.storeDefinition,id:t.id,key:t.id,"is-selected":t.isSelected,flash:e.store.isDebugging&&e.store.isCircuitEvaluated,"z-index":t.zIndex+1e3,onContextmenu:e.onContextMenu},null,8,["store","id","is-selected","flash","z-index","onContextmenu"])):((0,I.wg)(),(0,I.j4)(u,{tabindex:0,store:e.storeDefinition,id:t.id,key:"c".concat(t.id),"is-selected":t.isSelected,"is-preview":e.store.connectionPreviewId===t.id,flash:e.store.isDebugging&&e.store.isCircuitEvaluated,"z-index":t.zIndex,onContextmenu:e.onContextMenu},null,8,["store","id","is-selected","is-preview","flash","z-index","onContextmenu"]))],64)})),256)):(0,I.kq)("",!0),(0,I._)("div",{tabindex:0,onFocus:t[1]||(t[1]=function(t){return e.store.recycleSelection(!0)})},null,32),((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.store.groups,(function(t){return(0,I.wg)(),(0,I.j4)(s,{key:t.id,id:t.id,"bounding-box":t.boundingBox,"is-selected":t.isSelected,"z-index":e.store.zIndex,zoom:e.store.zoom},null,8,["id","bounding-box","is-selected","z-index","zoom"])})),128))]})),_:1},8,["zoom","grid-size","offset","style","width","height","onPan","onDeselect","onSelection","onZoom","onContextmenu","onResize"])}function nt(e,t,n,o,i,r){var a=(0,I.up)("wire"),u=(0,I.up)("draggable");return(0,I.wg)(),(0,I.j4)(u,{style:(0,Z.j5)({zIndex:e.zIndex}),position:e.position,"is-selected":e.isSelected,"allow-touch-drag":null!==e.freeportId,onTouchhold:e.onDragStart,onDrag:e.onDrag,onDragEnd:e.onDragEnd,onSelect:t[0]||(t[0]=function(t){return e.selectItem(e.id,t)}),onDeselect:t[1]||(t[1]=function(t){return e.deselectItem(e.id)}),onContextmenu:e.onContextMenu},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{source:e.source,target:e.target,geometry:e.geometry,"is-selected":e.isSelected,"is-preview":e.isPreview,flash:e.flash,label:"TODO",ref:"root","data-test":"wire"},null,8,["source","target","geometry","is-selected","is-preview","flash"])]})),_:1},8,["style","position","is-selected","allow-touch-drag","onTouchhold","onDrag","onDragEnd","onContextmenu"])}function ot(e,t,n,o,i,r){var a=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(a,{class:"draggable",ref:"draggable",style:(0,Z.j5)(e.style),onMousedown:(0,x.iM)(e.onMouseDown,["left"]),onMouseup:e.onMouseUp,onTouchstart:e.onTouchStart,onTouchmove:e.onTouchMove,onTouchend:e.onTouchEnd,onTouchcancel:e.dragEnd,onFocus:e.onFocus},{default:(0,I.w5)((function(){return[(0,I.WI)(e.$slots,"default")]})),_:3},8,["style","onMousedown","onMouseup","onTouchstart","onTouchmove","onTouchend","onTouchcancel","onFocus"])}var it;n(5438);(function(e){e[e["Outer"]=0]="Outer",e[e["Inner"]=1]="Inner",e[e["Radial"]=2]="Radial",e[e["Grid"]=3]="Grid",e[e["None"]=4]="None"})(it||(it={}));var rt=it;function at(e,t){return Math.round(e/t)*t}function ut(e,t,n){return Math.hypot(e.x-t.x,e.y-t.y)<=n}function st(e,t){return{x:at(e.left,t)-e.left,y:at(e.top,t)-e.top}}function ct(e,t,n){for(var o=0;o<e.length;o++){var i=e[o];if(ut({x:i.left,y:i.top},{x:t.left,y:t.top},n))return{x:i.left-t.left,y:i.top-t.top}}return{x:0,y:0}}function lt(e,t,n){for(var o={x:0,y:0},i=0;i<e.length;i++){var r=e[i],a=Math.abs(r.top-t.bottom)<=n,u=Math.abs(r.bottom-t.top)<=n,s=Math.abs(r.left-t.right)<=n,c=Math.abs(r.right-t.left)<=n;(t.left<=r.right&&t.left>=r.left||t.right>=r.left&&t.right<=r.right||t.left<=r.left&&t.right>=r.right)&&(a&&(o.y=r.top-t.bottom),u&&(o.y=r.bottom-t.top)),(t.top<=r.bottom&&t.top>=r.top||t.bottom>=r.top&&t.bottom<=r.bottom||t.top<=r.top&&t.bottom>=r.bottom)&&(s&&(o.x=r.left-t.right),c&&(o.x=r.right-t.left))}return o}function dt(e,t,n,o){switch(n){case rt.Radial:return ct(e,t,o);case rt.Grid:return st(t,o);case rt.Outer:default:return lt(e,t,o)}}function pt(e,t,n,o){var i=function(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)};return i(e,n,o)!==i(t,n,o)&&i(e,t,n)!==i(e,t,o)}function ft(e,t,n){var o={x:n.left,y:n.top},i={x:n.right,y:n.top},r={x:n.right,y:n.bottom},a={x:n.left,y:n.bottom};return pt(e,t,o,i)||pt(e,t,i,r)||pt(e,t,r,a)||pt(e,t,a,o)}function mt(e,t){return!(e.left>=t.right||t.left>=e.right)&&!(e.top>=t.bottom||t.top>=e.bottom)}function ht(e,t){return{left:e.left*t,top:e.top*t,bottom:e.bottom*t,right:e.right*t}}function vt(e){return e.left!==e.right||e.top!==e.bottom}function gt(e){return[{left:e.x,right:e.x,top:-1/0,bottom:1/0},{left:-1/0,right:1/0,top:e.y,bottom:e.y}]}function bt(e){return{left:e.x,top:e.y,right:e.x,bottom:e.y}}function yt(e,t,n,o){if(t%2===0)return{left:e.x,top:e.y,bottom:o+e.y,right:n+e.x};var i=e.x+n/2,r=e.y+o/2;return{left:i-o/2,top:r-n/2,right:i+o/2,bottom:r+n/2}}function wt(e){return e.reduce((function(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)}}),{left:1/0,top:1/0,right:0,bottom:0})}function xt(e){var t=e.right-e.left,n=e.bottom-e.top;return{x:t/2,y:n/2}}function It(e,t,n){var o=xt(e),i=t.right-t.left,r=t.bottom-t.top;return{x:at(o.x-i/2,n),y:at(o.y-r/2,n)}}function Zt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];var i=Math[e].apply(Math,(0,z.Z)(n.map((function(e){var t=e.x;return t})))),r=Math[e].apply(Math,(0,z.Z)(n.map((function(e){var t=e.y;return t}))));return{x:i,y:r}}var Ct={isInNeighborhood:ut,getRadialSnapOffset:ct,getOuterSnapOffset:lt,getGridSnapPosition:st,isLineIntersectingRectangle:ft,scaleBoundingBox:ht,isOneOrTwoDimensional:vt,getLinearBoundaries:gt,getPointBoundary:bt,hasIntersection:mt,getBoundingBox:yt,getGroupBoundingBox:wt,getBoundingBoxMidpoint:xt,getCenteredScreenPoint:It,getSnapOffset:dt,getExtremePoint:Zt},St={ref:"resizable"};function _t(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",St,[(0,I.WI)(e.$slots,"default")],512)}var Dt=n(6084),Ot=n(1033),Pt=(0,I.aZ)({name:"Resizable",emits:{resize:function(e){return!0}},setup:function(e,t){var n=t.emit,o=(0,P.iH)();function i(e){var t=(0,Dt.Z)(e,1),o=t[0];n("resize",o.target.getBoundingClientRect())}var r=new Ot.Z(i);return(0,I.bv)((function(){o.value&&r.observe(o.value)})),{onSizeChanged:i,resizable:o}}});const kt=(0,V.Z)(Pt,[["render",_t]]);var Mt=kt,Bt=(0,I.aZ)({name:"Draggable",components:{Resizable:Mt},props:{position:{type:Object,default:function(){return{x:0,y:0}}},isSelected:{type:Boolean,default:!1},isMobile:{type:Boolean,default:!1},allowTouchDrag:{type:Boolean,default:!0}},emits:{dragStart:function(e,t){return!0},drag:function(e,t){return!0},dragEnd:function(e,t){return!0},select:function(e){return!0},deselect:function(){return!0},touchhold:function(e){return!0}},setup:function(e,t){var n=t.emit,o=(0,I.Fl)((function(){return{left:"".concat(e.position.x,"px"),top:"".concat(e.position.y,"px")}})),i=(0,P.iH)(),r=0,a=!1,u=!1,s=!1,c={x:0,y:0},l={x:0,y:0},d={x:0,y:0};function p(){setTimeout((function(){e.isSelected||n("select",!1)}))}function f(e){var t=e.clientX,o=e.clientY;a&&(l.x===t&&l.y===o||(l={x:t,y:o},n(s?"drag":"dragStart",l,d),s=!0,u=!0))}function m(e){var t=e.clientX,n=e.clientY;if(i.value){var o=i.value.$el.getBoundingClientRect(),r=o.x,u=o.y,c=o.width,p=o.height;l={x:t,y:n},d={x:t-(r+c/2),y:n-(u+p/2)},a=!0,s=!1}}function h(){a&&(a=!1,u&&n("dragEnd",l,d))}function v(e){m(e)}function g(e){a&&(e.stopImmediatePropagation(),e.preventDefault(),f(e))}function b(e){}function y(e){u=!1,c={x:e.touches[0].clientX,y:e.touches[0].clientY},r=window.setTimeout((function(){n("touchhold",e)}),500)}function w(t){var n={x:t.touches[0].clientX,y:t.touches[0].clientY};Ct.isInNeighborhood(c,n,5)||1!==t.touches.length||(u=!0,clearTimeout(r)),e.allowTouchDrag&&(t.stopPropagation(),t.preventDefault(),a||m(t.touches[0])),a&&f(t.touches[0])}function x(){clearTimeout(r),a?h():u||(e.isSelected?n("deselect"):n("select",!0))}return(0,I.bv)((function(){window.addEventListener("mousemove",g),window.addEventListener("mouseup",h)})),(0,I.Jd)((function(){window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",h)})),(0,I.m0)((function(){var t;e.isSelected&&(null===(t=i.value)||void 0===t||t.$el.focus())})),{style:o,draggable:i,onMouseDown:v,onMouseUp:b,onTouchStart:y,onTouchMove:w,onTouchEnd:x,dragEnd:h,onFocus:p}}});const Et=(0,V.Z)(Bt,[["render",ot]]);var zt=Et,Nt=["width","height"],jt=["transform","d"],Tt=["transform","d"],Ft=["transform","d"],Lt=["transform","d"];function Wt(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",{class:(0,Z.C_)(["wire",{"wire--selected":e.isSelected,"wire--flash":e.flash,"wire--preview":e.isPreview}]),width:e.geometry.width,height:e.geometry.height},[(0,I._)("title",null,(0,Z.zw)(e.label),1),(0,I._)("path",{class:"wire__outline",fill:"none",transform:"translate(".concat(Math.abs(e.geometry.minX),", ").concat(Math.abs(e.geometry.minY),")"),d:e.geometry.path},null,8,jt),(0,I._)("path",{class:(0,Z.C_)(["wire__display",{"wire__display--on":1===e.source.value,"wire__display--off":-1===e.source.value}]),fill:"none",transform:"translate(".concat(Math.abs(e.geometry.minX),", ").concat(Math.abs(e.geometry.minY),")"),d:e.geometry.path},null,10,Tt),e.isAnimated?((0,I.wg)(),(0,I.iD)("path",{key:0,class:"wire__animation",fill:"none",transform:"translate(".concat(Math.abs(e.geometry.minX),", ").concat(Math.abs(e.geometry.minY),")"),d:e.geometry.path},null,8,Ft)):(0,I.kq)("",!0),(0,I._)("path",{class:"wire__clickable",fill:"none",transform:"translate(".concat(Math.abs(e.geometry.minX),", ").concat(Math.abs(e.geometry.minY),")"),d:e.geometry.path},null,8,Lt)],10,Nt)}var Vt=(0,I.aZ)({name:"Wire",props:{isAnimated:{type:Boolean,default:!1},source:{type:Object,required:!0},target:{type:Object,required:!0},label:{type:String,default:""},isPreview:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},geometry:{type:Object,required:!0}}});const At=(0,V.Z)(Vt,[["render",Wt]]);var Rt=At;n(6977),n(9600),n(9714);function Ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e+t%4+4)%4}var qt=15;function Ht(e,t){var n=e.position,o=t.position,i=Kt(n,o),r=i.start,a=i.end;if(r.x===a.x||r.y===a.y||a.x<=1&&r.x<=1||a.y<=1&&r.y<=1)return $t(r,a);var u=Yt(e,n,o),s=Yt(t,n,o);return Xt(u,s,r,a)}function $t(e,t){return{path:"M ".concat(e.x,",").concat(e.y," L ").concat(t.x,",").concat(t.y),width:Math.abs(e.x-t.x)+qt,height:Math.abs(e.y-t.y)+qt,minX:-qt/2,minY:-qt/2}}function Gt(e,t,n){switch(e){case ge.Left:return t.y>n.y?ge.Right:ge.Left;case ge.Top:return t.x<n.x?ge.Bottom:ge.Top;case ge.Right:return t.y>n.y?ge.Left:ge.Right;case ge.Bottom:return t.x<n.x?ge.Top:ge.Bottom;default:return Gt(Ut(e),t,n)}}function Yt(e,t,n){var o=Ut(e.orientation+e.rotation-1);return e.isFreeport&&(o=Gt(o,t,n),e.rotation%4!==1&&e.rotation%4!==2||(o=Ut(o-2))),o}function Kt(e,t){return e.x<=t.x?e.y<=t.y?{start:{x:0,y:0},end:{x:Math.floor(t.x-e.x),y:Math.floor(t.y-e.y)}}:{start:{x:0,y:Math.floor(e.y-t.y)},end:{x:Math.floor(t.x-e.x),y:0}}:e.y<=t.y?{start:{x:Math.floor(e.x-t.x),y:0},end:{x:0,y:Math.floor(t.y-e.y)}}:{start:{x:Math.floor(e.x-t.x),y:Math.floor(e.y-t.y)},end:{x:0,y:0}}}function Xt(e,t,n,o){var i=n.x,r=n.y,a=o.x,u=o.y,s=Math.max(Math.abs(i-a)/2,10),c=Math.max(Math.abs(r-u)/2,10),l=[i,i+s,i,i-s][e].toFixed(3),d=[r-c,r,r+c,r][e].toFixed(3),p=[a,a+s,a,a-s][t].toFixed(3),f=[u-c,u,u+c,u][t].toFixed(3),m=["M",i.toFixed(3),r.toFixed(3),"C",l,d,p,f,a.toFixed(3),u.toFixed(3)].join(" "),h=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){return parseInt(e.toString(),10)}))},v=Math.min.apply(Math,(0,z.Z)(h(i,l,p,a)))-qt/2,g=Math.max.apply(Math,(0,z.Z)(h(i,l,p,a)))+qt/2,b=Math.min.apply(Math,(0,z.Z)(h(r,d,f,u)))-qt/2,y=Math.max.apply(Math,(0,z.Z)(h(r,d,f,u)))+qt/2,w=g-v+qt,x=y-b+qt;return{width:w,height:x,path:m,minX:v,minY:b}}function Jt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e(),o=[{label:"&Undo",enabled:n.canUndo,accelerator:"CommandOrControl+Z",click:n.undo},{type:"separator"},{role:"cut",enabled:n.hasSelection},{role:"copy",enabled:n.hasSelection},{role:"paste",enabled:n.hasSelection},{label:"Delete",accelerator:"Delete",enabled:n.hasSelection,click:n.deleteSelection},{type:"separator"},{role:"selectAll",enabled:n.baseItems.length>0}];return n.selectedItemIds.length>0&&(o.push({type:"separator"}),o.push({label:"&Rotate",submenu:[{label:"Rotate 90° &CW",accelerator:"CmdOrCtrl+R",click:function(){return n.rotate(1)}},{label:"Rotate 90° CC&W",accelerator:"CmdOrCtrl+Shift+R",click:function(){return n.rotate(-1)}}]})),n.hasSelection&&(o.push({type:"separator"}),o.push({label:"&Bring to Front",submenu:[{label:"&Bring to Front",click:function(){return n.setZIndex(n.zIndex)}},{label:"Bring &Forward",click:function(){return n.incrementZIndex(1)}}]}),o.push({label:"&Send to Back",submenu:[{label:"&Send to Back",click:function(){return n.setZIndex(n.zIndex)}},{label:"Send &Backward",click:function(){return n.incrementZIndex(-1)}}]})),n.canGroup&&o.push({label:"&Group",submenu:[{label:"&Group"},{label:"&Ungroup",enabled:n.canUngroup}]}),t.length>0&&(o.push({type:"separator"}),o=o.concat(t)),1===n.selectedItemIds.length&&(o.push({type:"separator"}),o.push({label:"&Item Properties"})),n.activePortId&&(o.push({type:"separator"}),o.push({type:"checkbox",label:"Show in &Oscilloscope",checked:!0})),o}function Qt(e){e();return[{label:"&Grid",submenu:[{label:"&Show grid"},{type:"separator"},{label:"Snap to &grid"},{label:"Snap to &elements"}]}]}function en(e){return Jt(e,Qt(e).concat({type:"separator"}))}var tn=(0,I.aZ)({name:"Connection",components:{Draggable:zt,Wire:Rt},props:{isSelected:{type:Boolean,default:!1},id:{type:String,required:!0},zIndex:{type:Number,default:0},isPreview:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},store:{type:Function,required:!0}},setup:function(e){var t=e.store(),n=(0,P.iH)(t.connections[e.id]),o=(0,P.iH)(),i=(0,I.Fl)((function(){return t.ports[n.value.source]})),r=(0,I.Fl)((function(){return t.ports[n.value.target]})),a=(0,I.Fl)((function(){return Ct.getExtremePoint("min",i.value.position,r.value.position)})),u=(0,I.Fl)((function(){return Ht(i.value,r.value)})),s=(0,I.Fl)((function(){return{y:a.value.y+u.value.minY,x:a.value.x+u.value.minX}})),c=(0,P.iH)(null);function l(e){var t=e.touches;d({x:t[0].clientX,y:t[0].clientY})}function d(e){var a;null!==(a=o.value)&&void 0!==a&&a.$el&&null===n.value.groupId&&(o.value.$el.style.opacity="0",c.value=(0,fe.Z)(),navigator.vibrate(20),t.createFreeport({itemId:c.value,inputPortId:(0,fe.Z)(),outputPortId:(0,fe.Z)(),connectionChainId:n.value.connectionChainId,sourceId:i.value.id,targetId:r.value.id,value:i.value.value}),t.setSnapBoundaries(c.value),t.dragItem(c.value,e))}function p(e){return f.apply(this,arguments)}function f(){return f=(0,D.Z)((0,_.Z)().mark((function e(n){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:c.value?t.dragItem(c.value,n):d(n);case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function m(){c&&t.destroyConnection({source:n.value.source,target:n.value.target}),c.value=null}function h(){e.isSelected||t.selectItem(e.id),window.api.showContextMenu(en(e.store))}return{root:o,geometry:u,position:s,onDragStart:l,onDrag:p,onDragEnd:m,onContextMenu:h,source:i,target:r,freeportId:c,selectItem:t.selectItem,deselectItem:t.deselectItem}}});const nn=(0,V.Z)(tn,[["render",nt]]);var on=nn;function rn(e,t,n,o,i,r){var a=(0,I.up)("properties"),u=(0,I.up)("port-item"),s=(0,I.up)("circuit-component"),c=(0,I.up)("draggable");return(0,I.wg)(),(0,I.j4)(c,{style:(0,Z.j5)({outline:"none",pointerEvents:"none",zIndex:e.zIndex}),position:e.item.position,"is-selected":e.isSelected,"allow-touch-drag":e.isSelected,onResize:e.onResize,onKeydown:(0,x.D2)(e.onEscapeKey,["esc"]),onDrag:e.onDrag,onDragStart:e.onDragStart,onContextmenu:e.onContextMenu,onDblclick:e.revealCustomCircuit,onTouchhold:e.revealCustomCircuit,onDragEnd:e.store.commitCachedState,onSelect:t[1]||(t[1]=function(t){return e.store.selectItem(e.id,t)}),onDeselect:t[2]||(t[2]=function(t){return e.store.deselectItem(e.id)}),ref:"itemRef","data-test":"item"},{default:(0,I.w5)((function(){return[e.isPropertiesEnabled?((0,I.wg)(),(0,I.j4)(a,{key:0,properties:e.item.properties,id:e.id,viewport:e.viewport,onUpdate:e.store.setProperties,onFocus:t[0]||(t[0]=function(t){return e.store.setActivePortId(null)}),onPan:e.store.panDelta,"aria-label":"Properties dialog","data-test":"properties"},null,8,["properties","id","viewport","onUpdate","onPan"])):(0,I.kq)("",!0),(0,I.Wm)(s,{type:e.item.type,subtype:e.item.subtype,name:e.item.name,ports:e.ports,properties:e.item.properties,"is-selected":e.isSelected,flash:e.flash,style:(0,Z.j5)({transform:"rotate(".concat(90*e.item.rotation,"deg)")}),onSignal:e.store.setPortValue},(0,I.Nv)({_:2},[(0,I.Ko)(4,(function(t,n){return{name:n,fn:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.ports.filter((function(e){return e.orientation===n})),(function(t){return(0,I.wg)(),(0,I.j4)(u,{tabindex:0,store:e.$props.store,id:t.id,key:"".concat(t.id,"_").concat(e.portUpdates),title:t.name,type:t.type,position:t.position,orientation:t.orientation+e.item.rotation,"connected-port-ids":t.connectedPortIds,hue:t.isMonitored?t.hue:0,rotation:e.item.rotation,onKeypress:(0,x.D2)(e.onEscapeKey,["esc"]),onFocus:function(n){return e.store.setActivePortId(t.id)},onBlur:function(n){return e.onPortBlur(t.id)},onDeselect:e.focus,"data-test":"port-item"},null,8,["store","id","title","type","position","orientation","connected-port-ids","hue","rotation","onKeypress","onFocus","onBlur","onDeselect"])})),128))]}))}}))]),1032,["type","subtype","name","ports","properties","is-selected","flash","style","onSignal"])]})),_:1},8,["style","position","is-selected","allow-touch-drag","onResize","onKeydown","onDrag","onDragStart","onContextmenu","onDblclick","onTouchhold","onDragEnd"])}function an(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["circuit-component",{"circuit-component--selected":e.isSelected,"circuit-component--flash":e.flash,"circuit-component--custom":e.subtype===e.ItemSubtype.CustomCircuit}])},[((0,I.wg)(),(0,I.j4)((0,I.LL)(e.type),(0,I.dG)(e.$props,{onSignal:e.onChange}),null,16,["onSignal"])),e.type!==e.ItemType.Freeport?((0,I.wg)(),(0,I.iD)(I.HY,{key:0},(0,I.Ko)(["left","top","right","bottom"],(function(t,n){return(0,I._)("div",{key:n,class:(0,Z.C_)(["circuit-component__ports--".concat(t),"circuit-component__ports"])},[(0,I.WI)(e.$slots,n)],2)})),64)):(0,I.kq)("",!0)],2)}function un(e,t,n,o,i,r){var a=(0,I.up)("port-handle");return(0,I.wg)(),(0,I.j4)(a)}var sn=(0,I.aZ)({name:"Freeport",components:{PortHandle:G}});const cn=(0,V.Z)(sn,[["render",un]]);var ln=cn,dn={class:"input-node"},pn={key:0},fn={key:1},mn={key:2};function hn(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",dn,[(0,I._)("button",{type:"button",class:(0,Z.C_)(["input-node__flipper",{"input-node__flipper--on":1===e.model,"input-node__flipper--off":-1===e.model,"input-node__flipper--high-z":0===e.model}]),tabindex:0,onMousedown:t[0]||(t[0]=(0,x.iM)((function(){return e.onInput&&e.onInput.apply(e,arguments)}),["stop"])),onTouchstart:t[1]||(t[1]=(0,x.iM)((function(){return e.onInput&&e.onInput.apply(e,arguments)}),["stop"]))},[1===e.model?((0,I.wg)(),(0,I.iD)("span",pn,"ON")):-1===e.model?((0,I.wg)(),(0,I.iD)("span",fn,"OFF")):((0,I.wg)(),(0,I.iD)("span",mn,"?"))],34)])}var vn=(0,I.aZ)({name:"InputNode",props:{ports:{type:Array,default:function(){return[]}}},emits:{signal:function(e){return!0}},setup:function(e,t){var n=t.emit,o=(0,P.iH)(0);function i(t){t.preventDefault(),t.stopPropagation(),o.value=1===o.value?-1:1,n("signal",{id:e.ports[0].id,value:o.value})}return(0,I.m0)((function(){var t;o.value=(null===(t=e.ports[0])||void 0===t?void 0:t.value)||0})),{model:o,onInput:i}}});const gn=(0,V.Z)(vn,[["render",hn]]);var bn=gn;function yn(e,t,n,o,i,r){return(0,I.wg)(),(0,I.j4)((0,I.LL)(e.subtype),(0,Z.vs)((0,I.F4)(e.$props)),null,16)}var wn={class:"custom-circuit"},xn={class:"custom-circuit__center"},In={class:"custom-circuit__name"};function Zn(e,t,n,o,i,r){var a=(0,I.up)("custom-circuit-port-zone");return(0,I.wg)(),(0,I.iD)("div",wn,[(0,I.Wm)(a,{ports:e.ports.filter((function(e){return 1===e.orientation})),orientation:"horizontal",type:"top"},null,8,["ports"]),(0,I._)("div",xn,[(0,I.Wm)(a,{ports:e.ports.filter((function(e){return 0===e.orientation})),orientation:"vertical",type:"left"},null,8,["ports"]),(0,I._)("div",In,(0,Z.zw)(e.name),1),(0,I.Wm)(a,{ports:e.ports.filter((function(e){return 2===e.orientation})),orientation:"vertical",type:"right"},null,8,["ports"])]),(0,I.Wm)(a,{ports:e.ports.filter((function(e){return 3===e.orientation})),orientation:"horizontal",type:"bottom"},null,8,["ports"])])}function Cn(e,t,n,o,i,r){var a=(0,I.up)("custom-circuit-port");return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)("custom-circuit-port-zone custom-circuit-port-zone--".concat(e.orientation))},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.ports,(function(t){return(0,I.wg)(),(0,I.iD)("div",{key:t.id,class:(0,Z.C_)(["custom-circuit-port-zone__io--".concat(e.type),"custom-circuit-port-zone__io"])},[(0,I.Wm)(a,{label:t.name,type:e.type},null,8,["label","type"])],2)})),128))],2)}var Sn={class:"custom-circuit-port"},_n={class:"custom-circuit-port__label"};function Dn(e,t,n,o,i,r){var a=(0,I.up)("port-wire");return(0,I.wg)(),(0,I.iD)("div",Sn,[(0,I._)("div",_n,(0,Z.zw)(e.label),1),(0,I.Wm)(a,{type:e.type},null,8,["type"])])}var On=(0,I.aZ)({name:"CustomCircuitPort",components:{PortWire:Q},props:{label:{type:String,default:""},type:{type:String,required:!0}}});const Pn=(0,V.Z)(On,[["render",Dn]]);var kn=Pn,Mn=(0,I.aZ)({name:"CustomCircuitPortZone",components:{CustomCircuitPort:kn},props:{ports:{type:Array,default:function(){return[]}},orientation:{type:String,required:!0},type:{type:String,required:!0}}});const Bn=(0,V.Z)(Mn,[["render",Cn]]);var En=Bn,zn=(0,I.aZ)({name:"CustomCircuit",components:{CustomCircuitPortZone:En},props:{ports:{type:Array,default:function(){return[]}},name:{type:String,default:"circuit"}}});const Nn=(0,V.Z)(zn,[["render",Zn]]);var jn=Nn,Tn={class:"digit"},Fn={width:"58",height:"98"},Ln=["d"];function Wn(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",Tn,[((0,I.wg)(),(0,I.iD)("svg",Fn,[(0,I._)("g",null,[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.segments,(function(e,t){return(0,I.wg)(),(0,I.iD)("path",{key:t,style:(0,Z.j5)(e.style),d:e.path},null,12,Ln)})),128))])]))])}var Vn={" ":[0,0,0,0,0,0,0],0:[1,1,1,1,1,1,0],1:[0,0,1,1,0,0,0],2:[0,1,1,0,1,1,1],3:[0,1,1,1,1,0,1],4:[1,0,1,1,0,0,1],5:[1,1,0,1,1,0,1],6:[1,1,0,1,1,1,1],7:[0,1,1,1,0,0,0],8:[1,1,1,1,1,1,1],9:[1,1,1,1,0,0,1],a:[1,1,1,1,0,1,1],b:[1,0,0,1,1,1,1],c:[1,1,0,0,1,1,0],d:[0,0,1,1,1,1,1],e:[1,1,0,0,1,1,1],f:[1,1,0,0,0,1,1]},An=["M 8,10 L 12,14 L 12,42 L 8,46 L 4,42 L 4,14 L 8,10 z","M 10,8 L 14,4 L 42,4 L 46,8 L 42,12 L 14,12 L 10,8 z","M 48,10 L 52,14 L 52,42 L 48,46 L 44,42 L 44,14 L 48,10 z","M 48,50 L 52,54 L 52,82 L 48,86 L 44,82 L 44,54 L 48,50 z","M 10,88 L 14,84 L 42,84 L 46,88 L 42,92 L 14,92 L 10,88 z","M 8,50 L 12,54 L 12,82 L 8,86 L 4,82 L 4,54 L 8,50 z","M 10,48 L 14,44 L 42,44 L 46,48 L 42,52 L 14,52 L 10,48 z"],Rn=(0,I.aZ)({name:"DigitDisplay",props:{ports:{type:Array,default:function(){return[]}}},setup:function(e){var t=(0,I.Fl)((function(){var t=e.ports.map((function(e){return 1===e.value?1:0})).join(""),n=parseInt(t,2).toString(16).toLowerCase();return Vn[n].map((function(e,t){var n=e?"on":"bg-tertiary";return{path:An[t],style:{fill:"var(--color-".concat(n,")")}}}))}));return{segments:t}}});const Un=(0,V.Z)(Rn,[["render",Wn]]);var qn=Un,Hn={CustomCircuit:jn,DigitDisplay:qn},$n=(0,I.aZ)({name:"IntegratedCircuit",components:Hn,props:{ports:{type:Array,default:function(){return[]}},subtype:{type:String,required:!0},name:{type:String,default:""}}});const Gn=(0,V.Z)($n,[["render",yn]]);var Yn=Gn,Kn=(0,I._)("div",{class:"logic-gate__wire"},null,-1),Xn={key:0,class:"logic-gate__wires--multiwire"},Jn=(0,I._)("div",{class:"logic-gate__wires-divider"},[(0,I._)("div",{class:"logic-gate__wire"})],-1);function Qn(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{style:(0,Z.j5)({height:"".concat(25*e.inputCount,"px")}),class:"logic-gate"},[(0,I._)("div",{style:(0,Z.j5)({width:(e.inputCount,"100%")}),class:"logic-gate__wires"},[(0,I._)("div",{class:(0,Z.C_)([{"logic-gate__wires-divider--multiwire":e.inputCount>2},"logic-gate__wires-divider"])},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.inputCount-1,(function(e){return(0,I.wg)(),(0,I.iD)("div",{key:e,class:"logic-gate__wire"})})),128)),Kn],2),e.inputCount>2?((0,I.wg)(),(0,I.iD)("div",Xn)):(0,I.kq)("",!0),Jn],4),((0,I.wg)(),(0,I.j4)((0,I.LL)(e.subtype),{class:"logic-gate__component"}))],4)}var eo={class:"and",width:"100",height:"50",viewBox:"0 -1 100 50"},to=(0,I._)("path",{transform:"translate(20, 0)",class:"and__element",d:"M 0 0 V 48 H 24 C 36 48 48 36 48 24 C 48 12 36 0 24 0 Z"},null,-1),no={key:0,cx:"73",cy:"24",r:"5",class:"and__negation"};function oo(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",eo,[to,e.isNegated?((0,I.wg)(),(0,I.iD)("circle",no)):(0,I.kq)("",!0)])}var io=(0,I.aZ)({name:"And",props:{isNegated:{type:Boolean,default:!1}}});const ro=(0,V.Z)(io,[["render",oo]]);var ao=ro,uo={width:"100",height:"50",viewBox:"0 -1 100 50",class:"or"},so=(0,I._)("path",{transform:"translate(10, 0)",fill:"#fff",d:"M 0 0 C 12 12 12 36 0 48 H 0 H 24 C 48 48 60 36 72 24 C 60 12 48 0 24 0 Z",class:"or__element"},null,-1),co={key:0,fill:"none",d:"M 0 0 C 12 12 12 36 0 48",class:"or__tail"},lo={key:1,cx:"88",cy:"24",r:"5",class:"or__negation"};function po(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",uo,[so,e.isXor?((0,I.wg)(),(0,I.iD)("path",co)):(0,I.kq)("",!0),e.isNegated?((0,I.wg)(),(0,I.iD)("circle",lo)):(0,I.kq)("",!0)])}var fo=(0,I.aZ)({name:"Or",props:{isNegated:{type:Boolean,default:!1},isXor:{type:Boolean,default:!1}}});const mo=(0,V.Z)(fo,[["render",po]]);var ho=mo;function vo(e,t,n,o,i,r){var a=(0,I.up)("or");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0})}var go=(0,I.aZ)({name:"Nor",components:{Or:ho}});const bo=(0,V.Z)(go,[["render",vo]]);var yo=bo;function wo(e,t,n,o,i,r){var a=(0,I.up)("buffer");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0})}var xo={class:"buffer",width:"100",height:"50",viewBox:"0 -1 100 50"},Io=(0,I._)("path",{class:"buffer__element",transform:"translate(40, 0)",stroke:"#000","stroke-width":"2",fill:"#fff",d:"M 0 0 V 48 L 36 24 Z"},null,-1),Zo={key:0,class:"buffer__negation",stroke:"#000","stroke-width":"2",cx:"88",cy:"24",r:"5",fill:"#fff"};function Co(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("svg",xo,[Io,e.isNegated?((0,I.wg)(),(0,I.iD)("circle",Zo)):(0,I.kq)("",!0)])}var So=(0,I.aZ)({name:"Buffer",props:{isNegated:{type:Boolean,default:!1}}});const _o=(0,V.Z)(So,[["render",Co]]);var Do=_o,Oo=(0,I.aZ)({name:"Not",components:{Buffer:Do}});const Po=(0,V.Z)(Oo,[["render",wo]]);var ko=Po;function Mo(e,t,n,o,i,r){var a=(0,I.up)("and");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0})}var Bo=(0,I.aZ)({name:"Nand",components:{And:ao}});const Eo=(0,V.Z)(Bo,[["render",Mo]]);var zo=Eo;function No(e,t,n,o,i,r){var a=(0,I.up)("or");return(0,I.wg)(),(0,I.j4)(a,{"is-negated":!0,"is-xor":!0})}var jo=(0,I.aZ)({name:"Xnor",components:{Or:ho}});const To=(0,V.Z)(jo,[["render",No]]);var Fo=To;function Lo(e,t,n,o,i,r){var a=(0,I.up)("or");return(0,I.wg)(),(0,I.j4)(a,{"is-xor":!0})}var Wo=(0,I.aZ)({name:"Xor",components:{Or:ho}});const Vo=(0,V.Z)(Wo,[["render",Lo]]);var Ao=Vo,Ro=(0,I.aZ)({name:"LogicGate",components:{And:ao,Or:ho,Nor:yo,Not:ko,Nand:zo,Xnor:Fo,Xor:Ao},props:{properties:{type:Object,default:function(){return{}}},subtype:{subtype:String,required:!0}},setup:function(e){var t=(0,I.Fl)((function(){var t;return(null===(t=e.properties.inputCount)||void 0===t?void 0:t.value)||2}));return{inputCount:t}}});const Uo=(0,V.Z)(Ro,[["render",Qn]]);var qo=Uo;function Ho(e,t,n,o,i,r){return(0,I.wg)(),(0,I.j4)((0,I.LL)(e.subtype),(0,Z.vs)((0,I.F4)(e.$props)),null,16)}var $o=["title"];function Go(e,t,n,o,i,r){var a;return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["lightbulb","lightbulb--".concat(e.modifier)]),title:null===(a=e.ports[0])||void 0===a?void 0:a.value},null,10,$o)}var Yo=(0,I.aZ)({name:"Lightbulb",props:{ports:{type:Array,default:function(){return[]}}},setup:function(e){var t=(0,I.Fl)((function(){var t;switch(null===(t=e.ports[0])||void 0===t?void 0:t.value){case 1:return"on";case-1:return"off";default:return"high-z"}}));return{modifier:t}}});const Ko=(0,V.Z)(Yo,[["render",Go]]);var Xo=Ko,Jo={Lightbulb:Xo},Qo=(0,I.aZ)({name:"OutputNode",components:Jo,props:{ports:{type:Array,default:function(){return[]}},subtype:{type:String,required:!0}}});const ei=(0,V.Z)(Qo,[["render",Ho]]);var ti=ei,ni={Freeport:ln,InputNode:bn,IntegratedCircuit:Yn,LogicGate:qo,OutputNode:ti},oi=(0,I.aZ)({name:"CircuitComponent",components:ni,emits:{signal:function(e){return!0}},props:{isSelected:{type:Boolean,default:!1},flash:{type:Boolean,default:!1},type:{type:String,required:!0},subtype:{type:String,required:!0},name:{type:String,default:""},ports:{type:Array,default:function(){return[]}},properties:{type:Object,default:function(){return{}}}},setup:function(e,t){var n=t.emit;return{onChange:function(e){n("signal",e)},ItemType:he,ItemSubtype:ye}}});const ii=(0,V.Z)(oi,[["render",an]]);var ri=ii,ai=["aria-hidden"],ui={class:"properties__heading",role:"title"},si=(0,I.Uk)(" Properties "),ci=["for"],li=["onUpdate:modelValue","id"],di=["value"],pi=["onUpdate:modelValue","id"],fi=["onUpdate:modelValue","min","max","type","id"];function mi(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",{onContextmenu:t[3]||(t[3]=function(){return e.stopPropagation&&e.stopPropagation.apply(e,arguments)}),onMousedown:t[4]||(t[4]=function(){return e.stopPropagation&&e.stopPropagation.apply(e,arguments)}),onMouseup:t[5]||(t[5]=function(){return e.stopPropagation&&e.stopPropagation.apply(e,arguments)}),onKeydown:t[6]||(t[6]=(0,x.D2)((function(){return e.onKeyDown&&e.onKeyDown.apply(e,arguments)}),["esc"])),class:"properties"},[e.isOpen?((0,I.wg)(),(0,I.iD)("div",{key:0,class:"properties__dialog",ref:"propertiesRef","aria-hidden":!e.isOpen},[(0,I._)("div",ui,[si,(0,I.Wm)(a,{tabindex:0,icon:e.faClose,onClick:e.close,role:"button",class:"properties__close"},null,8,["icon","onClick"])]),((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.model,(function(n,o){return(0,I.wg)(),(0,I.iD)("div",{key:o,class:"properties__entry"},[(0,I._)("label",{for:"".concat(e.id,"_").concat(o),class:"properties__label"},(0,Z.zw)(n.label),9,ci),n.options?(0,I.wy)(((0,I.wg)(),(0,I.iD)("select",{key:0,"onUpdate:modelValue":function(e){return n.value=e},id:"".concat(e.id,"_").concat(o),class:"properties__input",onChange:t[0]||(t[0]=function(){return e.onChange&&e.onChange.apply(e,arguments)})},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(n.options,(function(e,t){return(0,I.wg)(),(0,I.iD)("option",{key:t,value:e},(0,Z.zw)(t),9,di)})),128))],40,li)),[[x.bM,n.value]]):"boolean"===n.type?(0,I.wy)(((0,I.wg)(),(0,I.iD)("input",{key:1,"onUpdate:modelValue":function(e){return n.value=e},id:"".concat(e.id,"_").concat(o),type:"checkbox",class:"properties__input",onChange:t[1]||(t[1]=function(){return e.onChange&&e.onChange.apply(e,arguments)})},null,40,pi)),[[x.e8,n.value]]):(0,I.wy)(((0,I.wg)(),(0,I.iD)("input",{key:2,"onUpdate:modelValue":function(e){return n.value=e},min:n.min,max:n.max,type:n.type,id:"".concat(e.id,"_").concat(o),class:"properties__input",onChange:t[2]||(t[2]=function(){return e.onChange&&e.onChange.apply(e,arguments)})},null,40,fi)),[[x.YZ,n.value]])])})),128))],8,ai)):((0,I.wg)(),(0,I.j4)(a,{key:1,onKeydown:(0,x.D2)(e.openProperties,["space"]),onClick:e.openProperties,tabindex:0,icon:e.faWrench,class:"properties__icon"},null,8,["onKeydown","onClick","icon"]))],32)}var hi=(0,I.aZ)({name:"Properties",components:{Icon:Ue},props:{properties:{type:Object,default:function(){return{}}},id:{type:String,default:""},viewport:{type:Object,required:!0}},emits:{update:function(e,t){return!0},pan:function(e,t){return!0}},setup:function(e,t){var n=t.emit,o=(0,P.iH)(),i=(0,P.iH)(!1),r=(0,P.iH)(pe()(e.properties));function a(e){i.value=!1,e.preventDefault()}function u(e){var t;a(e),null===(t=o.value)||void 0===t||t.focus()}function s(e){e.stopPropagation()}function c(){n("update",e.id,r.value)}function l(){i.value=!0,(0,I.Y3)((function(){if(o.value){var t=o.value.getBoundingClientRect(),i=t.bottom,r=t.right,a=Math.max(r-e.viewport.right,0),u=Math.max(i-e.viewport.bottom,0);(a>0||u>0)&&n("pan",{x:-a,y:-u},!0)}}))}return(0,I.YP)(e.properties,(function(e){r.value=pe()(e)}),{deep:!0}),{faClose:O.YIN,faWrench:O.klh,model:r,isOpen:i,propertiesRef:o,close:a,onKeyDown:u,onChange:c,openProperties:l,stopPropagation:s}}});const vi=(0,V.Z)(hi,[["render",mi]]);var gi=vi;n(2023);function bi(e,t,n,o,i,r){var a=(0,I.up)("port-handle"),u=(0,I.up)("draggable"),s=(0,I.up)("port-pivot");return(0,I.wg)(),(0,I.j4)(s,{rotation:e.rotation,onBlur:e.onBlur,onKeydown:[(0,x.D2)(e.onEscapeKey,["esc"]),t[0]||(t[0]=(0,x.D2)((function(t){return e.store.cycleConnectionPreviews(e.id)}),["space"])),(0,x.D2)(e.store.commitPreviewedConnection,["enter"])],onResize:e.onResize,onContextmenu:t[1]||(t[1]=function(t){return e.store.setActivePortId(e.id)})},{default:(0,I.w5)((function(){return[e.isFreeport?((0,I.wg)(),(0,I.j4)(a,{key:1,type:e.type,hue:e.hue,active:e.store.activePortId===e.id||e.store.connectablePortIds.includes(e.id)},null,8,["type","hue","active"])):((0,I.wg)(),(0,I.j4)(u,{key:0,onDragStart:e.onDragStart,onDrag:e.onDrag,onDragEnd:e.onDragEnd,onTouchhold:e.onTouchHold,onDblclick:e.onDoubleClick,tabindex:-1},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{type:e.type,hue:e.hue,active:e.store.activePortId===e.id||e.store.connectablePortIds.includes(e.id),"touch-friendly":""},null,8,["type","hue","active"])]})),_:1},8,["onDragStart","onDrag","onDragEnd","onTouchhold","onDblclick"]))]})),_:1},8,["rotation","onBlur","onKeydown","onResize"])}function yi(e,t,n,o,i,r){var a=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(a,{class:"port-pivot",style:(0,Z.j5)({transform:"rotate(-".concat(90*e.rotation,"deg)")}),onKeydown:t[0]||(t[0]=(0,x.D2)((function(t){return e.$emit("connect")}),["space"]))},{default:(0,I.w5)((function(){return[(0,I.WI)(e.$slots,"default")]})),_:3},8,["style"])}var wi=(0,I.aZ)({name:"PortPivot",components:{Resizable:Mt},props:{rotation:{type:Number,default:0}}});const xi=(0,V.Z)(wi,[["render",yi]]);var Ii=xi,Zi=(0,I.aZ)({name:"PortItem",components:{PortHandle:G,PortPivot:Ii,Draggable:zt,Resizable:Mt},props:{id:{type:String,default:""},rotation:{type:Number,default:0},position:{type:Object,default:function(){return{x:0,y:0}}},isFreeport:{type:Boolean,default:!1},type:{type:Number,default:0},orientation:{type:Number,default:0},hue:{type:Number,default:0},connectedPortIds:{type:Object,default:[]},store:{type:Function,required:!0}},setup:function(e,t){var n=t.emit,o=e.store(),i=rt.Radial,r=null,a="",u=!1;function s(e){e.preventDefault(),e.stopPropagation(),n("deselect",e)}function c(){o.unsetConnectionPreview(),o.cachedState=null}function l(){r={itemId:(0,fe.Z)()},a=(0,fe.Z)(),u=!1,e.type===ie.Input?(r.outputPortId=a,r.targetId=e.id):(r.inputPortId=a,r.sourceId=e.id)}function d(t){var n=t.x,i=t.y;null!==r&&(u||(o.createFreeport(r,!1),o.setConnectablePortIds({portId:e.id,isDragging:!0}),o.setSnapBoundaries(a)),o.dragItem(r.itemId,{x:n,y:i},rt.Radial))}function p(){null!==r&&(r.inputPortId?o.connectFreeport({portId:r.inputPortId,sourceId:e.id}):r.outputPortId&&o.connectFreeport({portId:r.outputPortId,targetId:e.id}))}function f(t){t.stopPropagation(),t.preventDefault(),navigator.vibrate(100),o.togglePortMonitoring(e.id)}function m(t){o.setPortRelativePosition(t,e.id)}function h(t){t.stopPropagation(),t.preventDefault(),o.togglePortMonitoring(e.id)}return{store:o,snapMode:i,onDragStart:l,onDrag:d,onDragEnd:p,onEscapeKey:s,onBlur:c,onTouchHold:f,onResize:m,onDoubleClick:h,PortType:ie}}});const Ci=(0,V.Z)(Zi,[["render",bi]]);var Si=Ci,_i=(n(7601),n(4553),JSON.parse('{"groups":{},"connections":{"switch1_nor1_conn":{"id":"switch1_nor1_conn","connectionChainId":"switch1_nor1_conn","source":"switchOutputPort1","target":"nor1InputPort1","isSelected":false,"groupId":null,"zIndex":7},"switch2_nor2_conn":{"id":"switch2_nor2_conn","connectionChainId":"switch2_nor2_conn","source":"switchOutputPort2","target":"nor2InputPort1","isSelected":false,"groupId":null,"zIndex":8},"nor1_nor2_conn":{"id":"nor1_nor2_conn","connectionChainId":"nor1_nor2_conn","source":"nor1OutputPort1","target":"nor2InputPort2","isSelected":false,"groupId":null,"zIndex":9},"nor2_nor1_conn":{"id":"nor2_nor1_conn","connectionChainId":"nor2_nor1_conn","source":"nor2OutputPort1","target":"nor1InputPort2","isSelected":false,"groupId":null,"zIndex":10},"nor1_lightbulb1_conn":{"id":"nor1_lightbulb1_conn","connectionChainId":"nor1_lightbulb1_conn","source":"nor1OutputPort1","target":"lightbulbInputPort1","isSelected":false,"groupId":null,"zIndex":11},"nor2_lightbulb2_conn":{"id":"nor2_lightbulb2_conn","connectionChainId":"nor2_lightbulb2_conn","source":"nor2OutputPort1","target":"lightbulbInputPort2","isSelected":false,"groupId":null,"zIndex":12}},"ports":{"nor1InputPort1":{"id":"nor1InputPort1","elementId":"nor1","name":"Input Port 1","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor1InputPort2":{"id":"nor1InputPort2","elementId":"nor1","name":"Input Port 2","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor1OutputPort1":{"id":"nor1OutputPort1","elementId":"nor1","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"nor2InputPort1":{"id":"nor2InputPort1","elementId":"nor2","name":"Input Port 1","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor2InputPort2":{"id":"nor2InputPort2","elementId":"nor2","name":"Input Port 2","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor2OutputPort1":{"id":"nor2OutputPort1","elementId":"nor2","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"switchOutputPort1":{"id":"switchOutputPort1","elementId":"switch1","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"switchOutputPort2":{"id":"switchOutputPort2","elementId":"switch2","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"lightbulbInputPort1":{"id":"lightbulbInputPort1","elementId":"lightbulb1","name":"Input Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"lightbulbInputPort2":{"id":"lightbulbInputPort2","elementId":"lightbulb2","name":"Input Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false}},"items":{"nor1":{"id":"nor1","type":"LogicGate","subtype":"Nor","portIds":["nor1InputPort1","nor1InputPort2","nor1OutputPort1"],"position":{"x":300,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"inputCount":{"label":"Input count","value":2,"type":"number","min":2}},"groupId":null,"zIndex":1,"width":100,"height":150},"nor2":{"id":"nor2","type":"LogicGate","subtype":"Nor","portIds":["nor2InputPort2","nor2InputPort1","nor2OutputPort1"],"position":{"x":300,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"inputCount":{"label":"Input count","value":2,"type":"number","min":2}},"groupId":null,"zIndex":2,"width":120,"height":51},"switch1":{"id":"switch1","type":"InputNode","subtype":"Clock","portIds":["switchOutputPort1"],"position":{"x":100,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"interval":{"label":"Interval","value":1000,"type":"number","min":100,"step":100},"startValue":{"label":"Start value","value":-1,"type":"number","options":{"True":1,"Hi-Z":0,"False":-1}}},"groupId":null,"zIndex":3,"width":40,"height":40},"switch2":{"id":"switch2","type":"InputNode","subtype":"Switch","portIds":["switchOutputPort2"],"position":{"x":100,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"startValue":{"label":"Start value","value":1,"type":"number","options":{"True":1,"Hi-Z":0,"False":-1}}},"groupId":null,"zIndex":4,"width":40,"height":40},"lightbulb1":{"id":"lightbulb1","type":"OutputNode","subtype":"Lightbulb","portIds":["lightbulbInputPort1"],"position":{"x":700,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"}},"groupId":null,"zIndex":5,"width":40,"height":40},"lightbulb2":{"id":"lightbulb2","type":"OutputNode","subtype":"Lightbulb","portIds":["lightbulbInputPort2"],"position":{"x":700,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"}},"groupId":null,"zIndex":6,"width":40,"height":40}}}')),Di=(n(2707),n(189),n(8783),n(3948),n(1038),n(7042),n(9826),(0,Ie.Z)((function e(t,n){(0,xe.Z)(this,e),(0,De.Z)(this,"node",void 0),(0,De.Z)(this,"id",void 0),this.node=t,this.id=n}))),Oi=Di,Pi={TRUE:1,FALSE:-1,UNKNOWN:0},ki=Pi,Mi=n(2417),Bi=n(3806),Ei=n(5744),zi=(0,Ie.Z)((function e(t){var n=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,xe.Z)(this,e),(0,De.Z)(this,"inputValues",{}),(0,De.Z)(this,"outputs",[]),(0,De.Z)(this,"isValueChanged",!0),(0,De.Z)(this,"forceContinue",!1),(0,De.Z)(this,"name",void 0),(0,De.Z)(this,"value",ki.UNKNOWN),(0,De.Z)(this,"newValue",ki.UNKNOWN),(0,De.Z)(this,"events",[]),(0,De.Z)(this,"setValue",(function(e){n.newValue=e})),(0,De.Z)(this,"invokeEvent",(function(e,t,o){n.events.forEach((function(n){n.eventType===e&&n.callback(t,o)}))})),(0,De.Z)(this,"eval",(function(){return n.value})),(0,De.Z)(this,"valueCount",(function(e){return Object.values(n.inputValues).filter((function(t){return t===e})).length})),(0,De.Z)(this,"updateOutputs",(function(e){var t=[];n.outputs.forEach((function(n){var o=n.node,i=n.id;o.update(e,i),t.push(i)})),n.invokeEvent("change",e,t)})),(0,De.Z)(this,"update",(function(e,t){n.inputValues[t]=e,n.newValue=n.eval(),n.invokeEvent("change",n.newValue,n.outputs.map((function(e){var t=e.id;return t})))})),(0,De.Z)(this,"propagate",(function(){var e=[];return n.value!==n.newValue&&(n.isValueChanged=!0,n.value=n.newValue,n.updateOutputs(n.newValue),n.outputs.forEach((function(t){var n=t.node;n.forceContinue?e=e.concat(n.propagate()):e.push(n)}))),e})),(0,De.Z)(this,"reset",(function(){n.value=ki.UNKNOWN,n.newValue=ki.UNKNOWN,n.invokeEvent("change",n.newValue,n.outputs.map((function(e){var t=e.id;return t})))})),(0,De.Z)(this,"on",(function(e,t){n.events.push({eventType:e,callback:t})})),(0,De.Z)(this,"getProjectedValue",(function(){return n.eval()||n.newValue||n.value})),this.name=t,this.inputValues=o.reduce((function(e,t){return(0,le.Z)((0,le.Z)({},e),{},(0,De.Z)({},t,ki.UNKNOWN))}),{})})),Ni=zi,ji=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"reset",(function(){})),e}return(0,Ie.Z)(n)}(Ni),Ti=ji,Fi=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"update",(function(t){e.newValue!==t&&(e.newValue=t,e.invokeEvent("change",e.newValue,[]))})),e}return(0,Ie.Z)(n)}(Ni),Li=Fi,Wi=(0,Ie.Z)((function e(){var t=this;(0,xe.Z)(this,e),(0,De.Z)(this,"queue",[]),(0,De.Z)(this,"nodes",[]),(0,De.Z)(this,"inputNodes",[]),(0,De.Z)(this,"addNode",(function(e){e instanceof Ti&&(t.inputNodes.push(e),t.enqueue(e)),t.nodes.push(e)})),(0,De.Z)(this,"removeNode",(function(e){if(e instanceof Ti){var n=t.inputNodes.findIndex((function(t){var n=t.name;return n===e.name}));-1!==n&&t.inputNodes.splice(n,1)}var o=t.nodes.findIndex((function(t){var n=t.name;return n===e.name}));-1!==o&&(t.removeNodeOutputs(e),t.nodes.splice(o,1)),t.next()})),(0,De.Z)(this,"addConnection",(function(e,n,o){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ki.UNKNOWN;e.outputs.push(new Oi(n,o)),e.value=i,i||t.enqueue(e)})),(0,De.Z)(this,"removeConnection",(function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ki.UNKNOWN;e.outputs.concat().forEach((function(i,r){var a=i.node,u=i.id;n===a&&(n.update(o,u),e.outputs.splice(r,1),t.enqueue(n))}))})),(0,De.Z)(this,"removeNodeOutputs",(function(e){for(var n=0;n<e.outputs.length;n++)t.removeConnection(e,e.outputs[n].node)})),(0,De.Z)(this,"enqueue",(function(){for(var e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];n.forEach((function(e){~t.queue.indexOf(e)||t.queue.push(e)}))})),(0,De.Z)(this,"dequeue",(function(e){var n=t.queue.indexOf(e);~n&&t.queue.splice(n,1)})),(0,De.Z)(this,"reset",(function(){t.nodes.forEach((function(e){return e.reset()}))})),(0,De.Z)(this,"next",(function(){var e=!1,n=[];while(t.queue.length>0){var o=t.queue.shift();o&&(n=n.concat(o.propagate()),t.dequeue(o),o.isValueChanged&&(e=!0),o.forceContinue&&(t.enqueue.apply(t,(0,z.Z)(n)),n=[]))}e&&t.enqueue.apply(t,(0,z.Z)(n))})),(0,De.Z)(this,"isComplete",(function(){var e=!0;return 0===t.queue.length||(t.queue.forEach((function(t){var n=t.getProjectedValue();n===t.value||t instanceof Li||(e=!1)})),e&&(t.queue=[]),e)}))})),Vi=Wi,Ai=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"eval",(function(){return e.valueCount(ki.TRUE)?ki.FALSE:e.valueCount(ki.UNKNOWN)?ki.UNKNOWN:ki.TRUE})),e}return(0,Ie.Z)(n)}(Ni),Ri=Ai,Ui=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"eval",(function(){return e.valueCount(ki.TRUE)?ki.TRUE:e.valueCount(ki.UNKNOWN)?ki.UNKNOWN:ki.FALSE})),e}return(0,Ie.Z)(n)}(Ni),qi=Ui,Hi=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"forceContinue",!0),(0,De.Z)((0,Mi.Z)(e),"update",(function(t){var n=Object.keys(e.inputValues).pop();n&&(e.inputValues[n]=t,e.newValue=e.eval())})),(0,De.Z)((0,Mi.Z)(e),"eval",(function(){return Object.values(e.inputValues).pop()||ki.UNKNOWN})),e}return(0,Ie.Z)(n)}(Ni),$i=Hi,Gi=n(4279),Yi=(0,Ie.Z)((function e(t,n,o,i){var r=this;(0,xe.Z)(this,e),(0,De.Z)(this,"id",void 0),(0,De.Z)(this,"name",void 0),(0,De.Z)(this,"width",0),(0,De.Z)(this,"lastY",0),(0,De.Z)(this,"segments",[]),(0,De.Z)(this,"hue",0),(0,De.Z)(this,"initialize",(function(e){var t={x:1,y:1};1===e?(t.y=0,r.lastY=1):(t.y=1,r.lastY=0),r.addSegment(t),r.updateWidth()})),(0,De.Z)(this,"reset",(function(){r.segments=[],r.width=0,r.initialize(1===r.lastY?0:1)})),(0,De.Z)(this,"update",(function(e){r.drawPulseConstant()})),(0,De.Z)(this,"addSegment",(function(e){var t=r.segments[r.segments.length-1];!t&&e.x>0?r.segments.push({x:0,y:e.y}):t&&t.x!==e.x&&t.y!==e.y&&r.segments.pop(),r.segments.push(e),r.updateWidth()})),(0,De.Z)(this,"drawPulseChange",(function(e){var t=r.segments[r.segments.length-1].x,n=e===ki.TRUE?0:1;r.updateWidth(),r.addSegment({x:t,y:n})})),(0,De.Z)(this,"drawPulseConstant",(function(){var e=r.segments[r.segments.length-1],t=r.lastY!==e.y?e:r.segments.pop();t&&(r.updateWidth(),r.addSegment({x:t.x+1,y:t.y})),r.lastY=e.y})),(0,De.Z)(this,"truncateSegments",(function(e){if(!(e>r.width)){for(var t=r.width-e,n=0;n<r.segments.length;n++){var o=r.segments[n],i=o.x,a=o.y;if(i>t){i-t,r.segments.splice(0,n),r.segments.unshift({x:0,y:a});break}}for(var u=1;u<r.segments.length;u++){var s=r.segments[u],c=s.x,l=s.y;r.segments[u]={x:c-t,y:l}}r.updateWidth()}})),(0,De.Z)(this,"updateWidth",(function(){var e;r.width=(null===(e=r.segments.slice(-1)[0])||void 0===e?void 0:e.x)||0})),this.id=t,this.name=n,this.hue=i,this.initialize(o)})),Ki=(0,Ie.Z)((function e(t,n,o){var i=this;(0,xe.Z)(this,e),(0,De.Z)(this,"id",(0,fe.Z)()),(0,De.Z)(this,"name",void 0),(0,De.Z)(this,"signal",0),(0,De.Z)(this,"interval",0),(0,De.Z)(this,"lastUpdate",void 0),(0,De.Z)(this,"emitter",new Gi.TinyEmitter),(0,De.Z)(this,"isStopped",!1),(0,De.Z)(this,"on",(function(e,t){i.emitter.on(e,t)})),(0,De.Z)(this,"stop",(function(){i.isStopped=!0})),(0,De.Z)(this,"start",(function(){i.isStopped=!1})),(0,De.Z)(this,"update",(function(e){!i.isStopped&&e>=i.lastUpdate+i.interval&&(i.signal=-1===i.signal?1:-1,i.lastUpdate=e,i.emitter.emit("change",i.signal))})),this.name=t,this.signal=o,this.interval=n,this.lastUpdate=-n})),Xi=(0,Ie.Z)((function e(){var t=this;(0,xe.Z)(this,e),(0,De.Z)(this,"isPaused",!0),(0,De.Z)(this,"waves",{}),(0,De.Z)(this,"refreshRate",20),(0,De.Z)(this,"lastUpdateTime",Date.now()),(0,De.Z)(this,"timeMsElapsed",0),(0,De.Z)(this,"timeMsOffset",0),(0,De.Z)(this,"emitter",new Gi.TinyEmitter),(0,De.Z)(this,"start",(function(){if(t.isPaused){var e=t.lastUpdateTime%t.refreshRate;t.lastUpdateTime=Date.now()+e,t.isPaused=!1,t.tick()}})),(0,De.Z)(this,"stop",(function(){t.isPaused=!0})),(0,De.Z)(this,"clear",(function(){Object.values(t.waves).forEach((function(e){e instanceof Yi&&e.reset()}))})),(0,De.Z)(this,"computeWaveGeometry",(function(e){var t={},n=function(e){return e.map((function(e){var t=e.x,n=e.y;return"".concat(t,",").concat(n)}))};for(var o in e)if(e[o]instanceof Yi){var i=e[o],r=n(i.segments);t[o]={points:r.join(" "),width:i.width,hue:i.hue}}return t})),(0,De.Z)(this,"on",(function(e,n){t.emitter.on(e,n)})),(0,De.Z)(this,"broadcast",(function(){var e=window.screen.width,n=1e3/t.refreshRate,o=e/n;t.timeMsElapsed>=t.timeMsOffset+o/2*1e3&&(t.timeMsOffset=t.timeMsElapsed,Object.values(t.waves).forEach((function(t){t instanceof Yi&&t.truncateSegments(e)}))),t.emitter.emit("change",t.computeWaveGeometry(t.waves))})),(0,De.Z)(this,"tick",(function(){if(!t.isPaused){var e=Date.now(),n=1e4,o=!1;if(e>=t.lastUpdateTime+n)return t.stop(),void t.start();while(e>=t.lastUpdateTime+t.refreshRate){var i=Math.min(t.refreshRate,e-t.lastUpdateTime);o=!0,t.timeMsElapsed+=i,t.lastUpdateTime+=i,t.update()}o&&t.broadcast(),requestAnimationFrame(t.tick)}})),(0,De.Z)(this,"update",(function(){Object.values(t.waves).forEach((function(e){return e.update(t.timeMsElapsed)}))})),(0,De.Z)(this,"add",(function(e){t.waves.hasOwnProperty(e.id)||(t.waves[e.id]=e,0===t.timeMsElapsed&&t.broadcast())})),(0,De.Z)(this,"remove",(function(e){var n=e.id;delete t.waves[n],0===Object.keys(t.waves).length&&(t.stop(),t.clear())}))})),Ji=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"eval",(function(){return Object.values(e.inputValues).reduce((function(e,t){return e&&t===ki.TRUE}),!0)?ki.TRUE:ki.FALSE})),e}return(0,Ie.Z)(n)}(Ni),Qi=Ji,er=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"eval",(function(){return Object.values(e.inputValues).reduce((function(e,t){return e||t===ki.FALSE}),!1)?ki.TRUE:ki.FALSE})),e}return(0,Ie.Z)(n)}(Ni),tr=er,nr=function(e){(0,Bi.Z)(n,e);var t=(0,Ei.Z)(n);function n(){var e;(0,xe.Z)(this,n);for(var o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];return e=t.call.apply(t,[this].concat(i)),(0,De.Z)((0,Mi.Z)(e),"eval",(function(){var t=Object.values(e.inputValues).pop();switch(t){case ki.TRUE:return ki.FALSE;case ki.FALSE:return ki.TRUE;default:return ki.UNKNOWN}})),e}return(0,Ie.Z)(n)}(Ni),or=nr;function ir(e,t,n){switch(e){case ye.And:return new Qi(t,n);case ye.Nand:return new tr(t,n);case ye.Or:return new qi(t,n);case ye.Nor:return new Ri(t,n);case ye.Not:return new or(t,n);default:return new Ri(t,n)}}function rr(e,t){var n=e.id,o=e.type,i=e.subtype;switch(o){case he.CircuitNode:return new Ni(n,t);case he.InputNode:return new Ti(n,t);case he.LogicGate:return ir(i,n,t);case he.Buffer:case he.Freeport:return new $i(n,t);default:return new Li(n,t)}}var ar={getLogicGateNode:ir,getCircuitNode:rr},ur=(0,Ie.Z)((function e(t,n,o){var i=this;(0,xe.Z)(this,e),(0,De.Z)(this,"nodes",{}),(0,De.Z)(this,"waves",{}),(0,De.Z)(this,"clocks",{}),(0,De.Z)(this,"valueMap",{}),(0,De.Z)(this,"circuit",new Vi),(0,De.Z)(this,"oscillator",new Xi),(0,De.Z)(this,"emitter",new Gi.TinyEmitter),(0,De.Z)(this,"oscillogram",{}),(0,De.Z)(this,"canContinue",!1),(0,De.Z)(this,"nextState",null),(0,De.Z)(this,"isDebug",!1),(0,De.Z)(this,"nextValueMap",{}),(0,De.Z)(this,"addElements",(function(e,t,n){e.forEach((function(e){return i.addNode(e,n)})),t.forEach((function(e){return i.addConnection(e.source,e.target)}))})),(0,De.Z)(this,"onChange",(function(e){i.emitter.on("change",e)})),(0,De.Z)(this,"onError",(function(e){i.emitter.on("error",e)})),(0,De.Z)(this,"emit",(function(){i.emitter.emit("change",i.valueMap)})),(0,De.Z)(this,"step",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;i.circuit.next();var t=i.circuit.queue.length>0;e>1e3&&i.emitter.emit("error","INFINITE_LOOP"),t&&i.step(++e),i.isDebug||i.emit()})),(0,De.Z)(this,"toggleClocks",(function(e){Object.values(i.clocks).forEach((function(t){return t[e]()}))})),(0,De.Z)(this,"start",(function(){i.isDebug||i.toggleClocks("start"),i.oscillator.start()})),(0,De.Z)(this,"stop",(function(){i.toggleClocks("stop"),i.oscillator.stop()})),(0,De.Z)(this,"startDebugging",(function(){i.isDebug=!0,i.computeNextState(),i.toggleClocks("stop")})),(0,De.Z)(this,"stopDebugging",(function(){i.isDebug=!1,i.advanceDebuggerStep(),i.nextState=null,i.toggleClocks("start")})),(0,De.Z)(this,"advanceDebuggerStep",(function(){if(!i.isDebug)return i.step();var e=Object.keys(i.nextValueMap);e.length>0?e.forEach((function(e){return i.updatePortValue(e,i.nextValueMap[e])})):i.nextState&&(i.valueMap=JSON.parse(i.nextState)),i.nextValueMap={},i.computeNextState(),i.emit()})),(0,De.Z)(this,"computeNextState",(function(){var e=JSON.stringify(i.valueMap);i.circuit.next();var t=JSON.stringify(i.valueMap);i.nextState=e!==t?t:null,i.canContinue=null!==i.nextState})),(0,De.Z)(this,"updatePortValue",(function(e,t){var n;i.nodes[e].setValue(t),i.circuit.enqueue(i.nodes[e]),null===(n=i.waves[e])||void 0===n||n.drawPulseChange(t)})),(0,De.Z)(this,"enqueuePortValueChange",(function(e,t){i.nextValueMap[e]=t,i.canContinue=Object.keys(i.nextValueMap).reduce((function(e,t){return e||i.valueMap[t]!==i.nextValueMap[t]}),!1)})),(0,De.Z)(this,"setPortValue",(function(e,t){if(i.isDebug)return i.enqueuePortValueChange(e,t);i.nodes[e]&&i.nodes[e].value!==t&&(i.updatePortValue(e,t),i.step())})),(0,De.Z)(this,"addIntegratedCircuit",(function(e){if(e.integratedCircuit){var t=e.integratedCircuit,n=t.items,o=t.connections,r=t.ports;Object.values(n).forEach((function(e){i.addNode(e,r)})),Object.values(o).forEach((function(e){i.addConnection(e.source,e.target)}))}})),(0,De.Z)(this,"addNode",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==e.portIds.length){if(e.integratedCircuit)return i.addIntegratedCircuit(e);var o,r=e.portIds.filter((function(e){return t[e].type===ie.Input})),a=e.portIds.filter((function(e){return t[e].type===ie.Output})),u=ar.getCircuitNode(e,r);if(n&&(u.forceContinue=!0),e.portIds.forEach((function(e){return i.addPort(e,u)})),u.on("change",(function(e,t){t.concat(a).forEach((function(t){var n;i.valueMap[t]=e,null===(n=i.waves[t])||void 0===n||n.drawPulseChange(e)}))})),e.type===he.InputNode&&e.subtype===ye.Clock)i.addClock(a[0],null===(o=e.properties.interval)||void 0===o?void 0:o.value);i.circuit.addNode(u),e.portIds.forEach((function(e){var n=t[e];n.isMonitored&&i.monitorPort(e,n.value,n.hue)}))}})),(0,De.Z)(this,"removeNode",(function(e){var t=function e(t){return t.integratedCircuit?Object.values(t.integratedCircuit.items).reduce((function(t,n){return n.integratedCircuit?t.concat(e(n)).concat(n.portIds):t.concat(n.portIds)}),[]):[]};e.portIds.concat(t(e)).forEach((function(e){var t=i.nodes[e];t&&(i.circuit.removeNode(t),i.removePort(e))})),i.emit()})),(0,De.Z)(this,"addClock",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;i.clocks[e]=new Ki(e,t,1),i.clocks[e].on("change",(function(t){i.setPortValue(e,t)})),i.oscillator.add(i.clocks[e])})),(0,De.Z)(this,"setClockInterval",(function(e,t){i.clocks[e]&&(i.clocks[e].interval=t)})),(0,De.Z)(this,"addPort",(function(e,t){i.nodes[e]=t})),(0,De.Z)(this,"removePort",(function(e){i.clocks[e]&&i.oscillator.remove(i.clocks[e]),i.unmonitorPort(e),delete i.nodes[e],delete i.valueMap[e],delete i.clocks[e],delete i.waves[e]})),(0,De.Z)(this,"addConnection",(function(e,t,n){i.nodes[e]&&i.nodes[t]&&(i.circuit.addConnection(i.nodes[e],i.nodes[t],t,n),i.advanceDebuggerStep())})),(0,De.Z)(this,"removeConnection",(function(e,t,n){i.nodes[e]&&i.nodes[t]&&(i.circuit.removeConnection(i.nodes[e],i.nodes[t],n),i.advanceDebuggerStep())})),(0,De.Z)(this,"monitorPort",(function(e,t,n){i.waves[e]||(i.waves[e]=new Yi(e,e,t,n),i.oscillator.add(i.waves[e]))})),(0,De.Z)(this,"unmonitorPort",(function(e){i.waves[e]&&(i.oscillator.remove(i.waves[e]),i.oscillator.broadcast()),delete i.waves[e],delete i.oscillator.waves[e],delete i.oscillogram[e]})),this.addElements(t,n,o)})),sr=function(){return{undoStack:[],redoStack:[],simulation:new ur([],[],{}),oscillogram:{},itemNames:[],zoomLevel:1,zIndex:1,oscilloscopeHeight:200,isOscilloscopeOpen:!1,isOscilloscopeRecording:!0,isCircuitEvaluated:!1,isDebugging:!1,isDirty:!1,hasLoaded:!1,isPrinting:!1,isCreatingImage:!1,animatePan:!1,debugger:{timeout:0,hasUpdated:!1},viewport:new DOMRect,canvas:{top:0,left:0,bottom:0,right:0},snapBoundaries:[],connectablePortIds:[],selectedConnectionIds:[],selectedItemIds:[],selectedPortIndex:-1,cachedState:null,activeFreeportId:null,activePortId:null,connectionPreviewId:null,items:{},connections:{},ports:{},groups:{}}};function cr(){this.copy(),this.deleteSelection()}function lr(){var e=this;if(this.hasSelection){var t={},n={};this.selectedItemIds.forEach((function(o){t[o]=e.items[o],t[o].portIds.forEach((function(t){n[t]=e.ports[t]}))}));var o=Object.values(this.connections).reduce((function(e,t){return n[t.source]&&n[t.target]&&(e[t.id]=t),e}),{}),i=Object.values(this.groups).filter((function(e){var t=e.isSelected;return t})).reduce((function(e,t){return(0,le.Z)((0,le.Z)({},e),{},(0,De.Z)({},t.id,t))}),{}),r={items:t,ports:n,connections:o,groups:i,pasteCount:1};window.api.copy(JSON.stringify(r))}}function dr(){var e=this;try{var t=window.api.paste(),n=JSON.parse(t),o=ke.mapStandardCircuitIds(n);this.commitState(),this.deselectAll(),Object.keys(o.ports).forEach((function(e){o.ports[e].value=0})),Object.values(o.items).forEach((function(t){t.position.x+=20*n.pasteCount,t.position.y+=20*n.pasteCount,t.isSelected=!1,e.addItem({item:t,ports:o.ports}),e.setSelectionState({id:t.id,value:!0})})),Object.values(o.connections).forEach((function(t){return e.connect(t)})),Object.values(o.groups).forEach((function(t){e.groups[t.id]=t,e.setGroupBoundingBox(t.id),e.setSelectionState({id:t.id,value:!0})}));var i=(0,le.Z)((0,le.Z)({},JSON.parse(t)),{},{pasteCount:n.pasteCount+1});window.api.copy(JSON.stringify(i))}catch(r){console.log("ERROR: ",r)}}function pr(e){if(this.activePortId&&e){var t=this.activePortId,n=e;this.ports[this.activePortId].type===ie.Input&&(t=e,n=this.activePortId);var o=(0,fe.Z)();this.unsetConnectionPreview(),this.connect({source:t,target:n,id:o}),this.connectionPreviewId=o}}function fr(){this.connectionPreviewId&&this.disconnect(this.connections[this.connectionPreviewId]),this.connectionPreviewId=null}function mr(){if(this.connectionPreviewId){var e=this.connections[this.connectionPreviewId],t=e.source,n=e.target;this.disconnect({source:t,target:n}),this.commitState(),this.connect({source:t,target:n}),this.connectionPreviewId=null}}function hr(e){var t;e&&e!==this.activePortId&&this.setActivePortId(e);var n=this.selectedPortIndex+1;n<=0&&(n=0),n>=this.connectablePortIds.length&&(n=-1);var o=this.connectablePortIds[n];!o||null!==(t=this.ports[e])&&void 0!==t&&t.connectedPortIds.includes(o)?(0===this.connectablePortIds.length&&window.api.beep(),this.unsetConnectionPreview()):this.setConnectionPreview(o),this.selectedPortIndex=n}function vr(e){var t=e.id||(0,fe.Z)();this.connections[t]=(0,le.Z)((0,le.Z)({},e),{},{id:t,connectionChainId:e.connectionChainId||t,groupId:null,zIndex:++this.zIndex,isSelected:!1}),this.ports[e.source].connectedPortIds.push(e.target),this.ports[e.target].connectedPortIds.push(e.source)}function gr(e){this.createConnection(e),this.simulation.addConnection(e.source,e.target),this.simulation.circuit.next()}function br(e){var t=e.source,n=e.target,o=Object.values(this.connections).find((function(e){return e.source===t&&e.target===n}));if(o){var i=this.ports[t].connectedPortIds.findIndex((function(e){return e===n})),r=this.ports[n].connectedPortIds.findIndex((function(e){return e===t}));this.ports[t].connectedPortIds.splice(i,1),this.ports[n].connectedPortIds.splice(r,1),delete this.connections[o.id]}}function yr(e){var t=e.source,n=e.target;this.simulation.removeConnection(t,n),this.simulation.circuit.next(),this.destroyConnection({source:t,target:n})}function wr(e){var t=JSON.parse(e),n=t.integratedCircuit?JSON.stringify(t.integratedCircuit):e;this.applyState(n),this.resetCircuit()}function xr(){this.isPrinting=!0}function Ir(){this.isCreatingImage=!0}function Zr(){this.unsetConnectionPreview(),this.connectablePortIds=[],this.selectedConnectionIds=[],this.selectedItemIds=[],this.selectedPortIndex=-1,this.cachedState=null,this.activePortId=null,this.connectionPreviewId=null}function Cr(e,t,n){var o=this,i=e.reduce((function(e,t){return e.concat(o.items[t].portIds)}),[]),r=new Set;Object.values(this.connections).forEach((function(e){var t=e.source,n=e.target,o=e.connectionChainId;(i.includes(t)||i.includes(n))&&r.add(o)}));var a=Object.values(this.connections).filter((function(e){var t=e.connectionChainId;return r.has(t)})).concat(t.map((function(e){return o.connections[e]})));a.forEach((function(e){var t;o.disconnect(e),null!==(t=o.ports[e.source])&&void 0!==t&&t.isFreeport&&o.removeElement(o.ports[e.source].elementId)})),e.forEach(this.removeElement),n.forEach((function(e){delete o.groups[e]}))}function Sr(e,t,n,o,i){return{id:t,orientation:n,name:i,position:{x:0,y:0},type:o,rotation:0,elementId:e,value:0,hue:0,isMonitored:!1,isFreeport:!1,connectedPortIds:[]}}var _r=(0,w.Q_)({id:"preferences",state:function(){return{colors:{onColor:{type:"color",label:"High state",value:"#0000ff",description:"When a signal is present."},offColor:{type:"color",label:"Low state",value:"#c0c0c0",description:"When no signal is present."},unknownColor:{type:"color",label:"Unknown state",value:"#ff0000",description:"High impedance (Hi-Z)."}},snapping:{snapToGrid:{type:"boolean",label:"Snap to grid",value:!1,description:"Snap elements to the grid lines.",excludes:["snapToAlign"]},snapToAlign:{type:"boolean",label:"Snap to align",value:!0,description:"Snap elements together.",excludes:["snapToGrid"]},snapTolerance:{type:"number",label:"Snap tolerance",value:15,description:"Maximum distance from a dragging object to snap to another element."}},grid:{showGrid:{type:"boolean",label:"Show grid",value:!0,description:"Display a grid on the canvas."},gridSize:{type:"number",label:"Grid size",value:20,description:"Distance between grid lines.",excludes:["snapToAlign"]}},simulation:{startPaused:{type:"boolean",label:"Pause on startup",value:!0,description:"Start simulation paused."}},experience:{vibration:{type:"boolean",label:"Vibration",value:!0,description:"Haptic feedback on gestures.",mobileOnly:!0},autosave:{type:"boolean",label:"Auto-save",value:!0,description:"Automatically save your work.",desktopOnly:!0},darkMode:{type:"boolean",label:"Dark mode",value:!0}}}},actions:{writeSettings:function(){return(0,D.Z)((0,_.Z)().mark((function e(){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case 1:case"end":return e.stop()}}),e)})))()},updateSettings:function(e){var t=this;return(0,D.Z)((0,_.Z)().mark((function e(){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.writeSettings();case 2:case"end":return e.stop()}}),e)})))()}}});function Dr(e){var t=e.itemId,n=e.inputPortId,o=e.outputPortId,i=e.value,r=void 0===i?0:i,a=[];o&&(this.ports[o]=Sr(t,o,ge.Left,ie.Output,o),this.ports[o].value=r,this.ports[o].isFreeport=!0,a.push(this.ports[o])),n&&(this.ports[n]=Sr(t,n,ge.Right,ie.Input,n),this.ports[n].value=r,this.ports[n].isFreeport=!0,a.push(this.ports[n])),this.items[t]=be(t,he.Freeport,ye.None,1,1,a),this.items[t].zIndex=this.zIndex++,this.simulation.addNode(this.items[t],this.ports,!0)}function Or(e){var t=this.items[e],n="",o="";Object.values(this.connections).forEach((function(e){e.target===t.portIds[1]&&(n=e.source),e.source===t.portIds[0]&&(o=e.target)})),n&&this.disconnect({source:n,target:t.portIds[1]}),o&&this.disconnect({source:t.portIds[0],target:o}),n&&o&&this.connect({source:n,target:o})}function Pr(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.items[e.itemId]){e.sourceId&&e.targetId&&this.commitState(),this.deselectAll(),this.addFreeportItem(e),this.setItemBoundingBox(e.itemId),this.activeFreeportId=e.itemId;var o=[];e.sourceId&&e.inputPortId&&o.push({source:e.sourceId,target:e.inputPortId}),e.targetId&&e.outputPortId&&o.push({source:e.outputPortId,target:e.targetId}),o.forEach((function(o){t.createConnection((0,le.Z)((0,le.Z)({},o),{},{connectionChainId:e.connectionChainId})),n&&t.simulation.addConnection(o.source,o.target,t.ports[o.source].value)})),e.sourceId&&e.targetId&&this.simulation.removeConnection(e.sourceId,e.targetId,this.ports[e.sourceId].value),e.sourceId&&e.targetId&&(this.deselectAll(),this.setSelectionState({id:e.itemId,value:!0}),this.incrementZIndex(1)),this.simulation.circuit.next()}}function kr(e){var t=this,n=e.sourceId,o=e.targetId,i=e.portId,r=this.ports[i],a=_r().snapping.snapTolerance.value,u=Object.values(this.ports).find((function(e){return e.id!==i&&t.connectablePortIds.includes(e.id)&&Ct.isInNeighborhood(e.position,r.position,a)}));u?n?(this.disconnect({source:n,target:i}),this.connect({source:n,target:u.id})):o&&(this.disconnect({source:i,target:o}),this.connect({source:u.id,target:o})):this.disconnect({source:n||i,target:o||i});var s=Object.values(this.items).find((function(e){var t=e.portIds;return t.includes(i)}));s&&this.removeElement(s.id),this.clearStatelessInfo()}function Mr(){var e=this;this.commitState();var t=(0,fe.Z)(),n=Object.values(this.items).filter((function(e){var t=e.isSelected;return t})),o=n.reduce((function(e,t){return e.concat(t.portIds)}),[]),i=Object.values(this.connections).filter((function(e){return o.includes(e.source)&&o.includes(e.target)&&e.isSelected}));n.forEach((function(t){return t.groupId&&e.destroyGroup(t.groupId)})),i.forEach((function(t){return t.groupId&&e.destroyGroup(t.groupId)}));var r=[].concat((0,z.Z)(n),(0,z.Z)(i)).reduce((function(e,t){return Math.max(t.zIndex,e)}),0),a={id:t,itemIds:n.map((function(e){var t=e.id;return t})),connectionIds:i.map((function(e){var t=e.id;return t})),isSelected:!0,boundingBox:{left:0,top:0,right:0,bottom:0},position:{x:0,y:0},zIndex:r};this.groups[t]=a,a.itemIds.forEach((function(t){e.items[t].groupId=a.id})),a.connectionIds.forEach((function(t){e.connections[t].groupId=a.id})),this.setZIndex(r),this.setGroupBoundingBox(t)}function Br(){for(var e in this.commitState(),this.groups)this.groups[e].isSelected&&this.destroyGroup(e)}function Er(e){var t=this,n=this.groups[e];n.itemIds.forEach((function(e){t.items[e].groupId=null,t.selectedItemIds.push(e)})),n.connectionIds.forEach((function(e){t.connections[e].groupId=null,t.selectedConnectionIds.push(e)})),delete this.groups[e]}function zr(e,t,n,o){return{x:(n.x-t.x-e.left)/o,y:(n.y-t.y-e.top)/o}}function Nr(e){var t,n=this,o=e.item,i=e.ports,r=(null===(t=o.integratedCircuit)||void 0===t?void 0:t.ports)||i;o.portIds.forEach((function(e){var t=r[e];t&&(n.ports[t.id]=t,t.isMonitored&&n.monitorPort(t.id))}));var a=o.name,u=0;while(this.itemNames.includes(a))a="".concat(o.name," ").concat(++u);o.name=a,this.items[o.id]=o,this.items[o.id].zIndex=++this.zIndex,this.simulation.addNode(o,this.ports),this.resetItemValue(o),this.setProperties(o.id,o.properties),this.setItemBoundingBox(o.id)}function jr(e){var t=e.item,n=e.ports,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!o){var i=Ct.getBoundingBoxMidpoint(this.viewport);o={x:i.x+this.viewport.left,y:i.y+this.viewport.top}}var r=zr(this.canvas,this.viewport,o,this.zoomLevel);r.x-=t.width/2,r.y-=t.height/2,t.position=r,this.commitState(),this.addItem({item:t,ports:n.reduce((function(e,t){return(0,le.Z)((0,le.Z)({},e),{},(0,De.Z)({},t.id,t))}),{})}),this.setItemBoundingBox(t.id),this.setSelectionState({id:t.id,value:!0})}function Tr(e){var t,n=this,o=null===(t=e.properties)||void 0===t?void 0:t.startValue;if(o){var i=o.value;e.portIds.forEach((function(e){return n.setPortValue({id:e,value:i})}))}}function Fr(e){var t=this,n=this.items[e];if(n){n.type===he.Freeport&&this.disconnectFreeport(e),this.simulation.removeNode(n);var o=(0,z.Z)(n.portIds);o.forEach((function(e){return t.removePort(e)})),delete this.items[e]}}function Lr(e,t){var n=this,o=this.items[e],i=o.properties.inputCount.value;if(i>t)this.items[e].portIds.filter((function(e){return n.ports[e].type===ie.Input})).slice(t).forEach((function(e){return n.removePort(e)}));else for(var r=i;r<t;r++){var a=(0,fe.Z)();this.addPort(e,{id:a,name:"",connectedPortIds:[],type:ie.Input,elementId:e,virtualElementId:e,orientation:ge.Left,isFreeport:!1,isMonitored:!1,hue:0,position:{x:0,y:0},rotation:0,value:0})}}function Wr(e,t){var n=this.items[e];for(var o in t){var i=t[o];if(n.properties[o].value!==i.value){switch(this.commitState(),o){case"inputCount":this.setInputCount(e,i.value);break;case"interval":this.simulation.setClockInterval(n.portIds.slice(-1)[0],i.value);break}this.items[e].properties[o].value=i.value}}}function Vr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.panDelta({x:e.x-this.canvas.left,y:e.y-this.canvas.top},t)}function Ar(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.animatePan=n;var o=(0,le.Z)({},this.canvas),i=function n(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=function(e){return 1-(1-e)*(1-e)},a=r(i/100),u=e.x*a,s=e.y*a;t.canvas.left=o.left+u,t.canvas.right=o.right+u,t.canvas.top=o.top+s,t.canvas.bottom=o.bottom+s,i<100&&t.animatePan?requestAnimationFrame(n.bind(t,i+5)):t.animatePan=!1};n?requestAnimationFrame(i.bind(this,0)):(this.canvas.left+=e.x,this.canvas.right+=e.x,this.canvas.top+=e.y,this.canvas.bottom+=e.y)}function Rr(){var e=Ct.getBoundingBoxMidpoint(this.canvas),t={x:this.viewport.width/2-e.x,y:this.viewport.height/2-e.y};this.panTo(t)}function Ur(e,t,n){var o=Object.values(e).reduce((function(e,o){var i=e.connectionIds,r=e.freeportIds;if(n===o.connectionChainId){var a=t[o.source],u=t[o.target];i.add(o.id),null!==a&&void 0!==a&&a.isFreeport&&r.add(a.elementId),null!==u&&void 0!==u&&u.isFreeport&&r.add(u.elementId)}return{connectionIds:i,freeportIds:r}}),{connectionIds:new Set,freeportIds:new Set}),i=o.connectionIds,r=o.freeportIds;return{connectionIds:Array.from(i),freeportIds:Array.from(r)}}function qr(e,t){var n=this,o=Object.values(this.simulation.nodes).find((function(t){var o=t.name;return n.items[e].portIds.includes(o)}));this.ports[t.id]=t,this.items[e].portIds.push(t.id),o?this.simulation.addPort(t.id,o):this.simulation.addNode(this.items[e],this.ports)}function Hr(e){var t,n=this;if(this.items[null===(t=this.ports[e])||void 0===t?void 0:t.elementId]){Object.values(this.connections).filter((function(t){var n=t.source,o=t.target;return n===e||o===e})).forEach((function(e){var t=Ur(Object.values(n.connections),n.ports,e.connectionChainId),o=t.connectionIds,i=t.freeportIds;o.forEach((function(e){return n.disconnect(n.connections[e])})),i.forEach((function(e){n.items[e].portIds.forEach((function(e){delete n.ports[e],n.simulation.removePort(e)})),delete n.items[e]}))})),this.simulation.removePort(e);var o=this.ports[e].elementId,i=this.items[o].portIds.indexOf(e);-1!==i&&this.items[o].portIds.splice(i,1),delete this.ports[e]}}function $r(e){this.activePortId!==e&&(e?this.setConnectablePortIds({portId:e}):this.connectablePortIds=[],this.activePortId=e,this.selectedPortIndex=-1)}function Gr(e){var t=e.portId,n=e.isDragging,o=this.ports[t];if(!o.isFreeport){var i=Object.values(this.connections).reduce((function(e,t){return e.concat([t.source,t.target])}),[]);n&&i.splice(-2);var r=o.type===ie.Output?function(e){return e.type===ie.Input&&!e.isFreeport&&!i.includes(e.id)&&e.elementId!==o.elementId}:function(e){return e.type===ie.Output&&!e.isFreeport&&!i.includes(o.id)&&e.elementId!==o.elementId};this.connectablePortIds=Object.values(this.ports).filter(r).map((function(e){var t=e.id;return t}))}}function Yr(e){var t=e.id,n=e.value;this.simulation.setPortValue(t,n),this.isDebugging&&(this.isCircuitEvaluated=!this.simulation.canContinue)}function Kr(e){this.ports[e].isMonitored?this.unmonitorPort(e):this.monitorPort(e)}function Xr(e){var t=this.ports[e];t.hue=t.hue||~~(360*Math.random()),t.isMonitored=!0,this.simulation.monitorPort(e,t.value,t.hue),this.isOscilloscopeOpen=!0}function Jr(e){var t=this.ports[e];t.isMonitored=!1,this.simulation.unmonitorPort(e),this.isOscilloscopeOpen=Object.keys(this.oscillogram).length>0}function Qr(){var e=this,t=_r(),n=t.grid,o=n.gridSize.value,i=Object.values(this.items).map((function(e){var t=e.boundingBox;return t})),r=Ct.getGroupBoundingBox(i),a=Ct.getCenteredScreenPoint(this.canvas,r,o),u=a.x,s=a.y,c=u-r.left,l=s-r.top;Object.values(this.items).forEach((function(t){e.setItemPosition({id:t.id,position:{x:t.position.x+c,y:t.position.y+l}})}))}function ea(e,t){var n=this.ports[t];n.position=zr(this.canvas,this.viewport,e,this.zoom)}function ta(e){var t=this,n=e.id,o=e.position,i=this.items[n],r={x:o.x-i.position.x,y:o.y-i.position.y};this.items[n].position=o,this.setItemBoundingBox(n),i.portIds.forEach((function(e){var n=t.ports[e];t.ports[e].position={x:n.position.x+r.x,y:n.position.y+r.y}}))}function na(e,t,n){var o=_r(),i=o.snapping,r=o.grid,a=zr(this.canvas,this.viewport,t,this.zoom),u=a.x,s=a.y,c=this.items[e],l=c.width,d=c.height,p=c.rotation,f=Ct.getBoundingBox({x:u,y:s},p,l,d),m=function(){return n||(i.snapToGrid.value?rt.Grid:i.snapToAlign.value?rt.Outer:rt.None)}(),h=function(){switch(m){case rt.Grid:return r.gridSize.value;case rt.Outer:case rt.Radial:return i.snapTolerance.value;default:return 0}}(),v=Ct.getSnapOffset(this.snapBoundaries,f,n||m,h);this.setSelectionPosition({id:e,position:{x:u+v.x,y:s+v.y}})}function oa(e){var t=this.selectedItemIds[0];if(t){var n=this.items[t],o={x:n.position.x+e.x,y:n.position.y+e.y};this.commitState(),this.setSelectionPosition({id:t,position:o})}}function ia(e){var t=this,n=e.id,o=e.position,i=this.items[n],r={x:o.x-i.position.x,y:o.y-i.position.y},a=new Set;if(this.setSelectionState({id:n,value:!0}),i.type===he.Freeport)return this.setItemPosition({id:n,position:o});this.selectedItemIds.forEach((function(e){var n=t.items[e],o={x:n.position.x+r.x,y:n.position.y+r.y};n.groupId&&a.add(n.groupId),t.setItemPosition({id:e,position:o})})),a.forEach(this.setGroupBoundingBox)}function ra(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e+t%4+4)%4}function aa(e,t,n){var o=e.right-e.left,i=e.bottom-e.top,r=e.left+o/2,a=e.top+i/2,u=t.position.x,s=t.position.y,c=u+t.width/2,l=s+t.height/2,d=Math.hypot(r-c,a-l),p=Math.atan2(l-a,c-r),f=90*n*(Math.PI/180)+p,m=d*Math.cos(f)+r,h=d*Math.sin(f)+a;return{x:m-t.width/2,y:h-t.height/2}}var ua={rotate:ra,getGroupedItemRotatedPosition:aa};function sa(e){var t=this;this.commitState();var n=Object.values(this.items).filter((function(e){var t=e.isSelected;return t})),o=n.map((function(e){var t=e.boundingBox;return t})),i=Ct.getGroupBoundingBox(o),r=new Set;n.forEach((function(n){var o=ua.rotate(n.rotation+e);n.groupId&&r.add(n.groupId),t.items[n.id].rotation=o,t.items[n.id].portIds.forEach((function(e){t.ports[e].rotation=o})),t.setItemPosition({id:n.id,position:ua.getGroupedItemRotatedPosition(i,n,e)})})),r.forEach((function(e){t.setGroupBoundingBox(e)}))}function ca(e){this.setSelectionState({id:e,value:!1})}function la(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t||this.deselectAll(),this.setSelectionState({id:e,value:!0})}function da(){for(var e in this.clearStatelessInfo(),this.connections)this.connections[e].isSelected=!0,this.selectedConnectionIds.push(e);for(var t in this.items)this.items[t].isSelected=!0,this.selectedItemIds.push(t)}function pa(){for(var e in this.clearStatelessInfo(),this.connections)this.connections[e].isSelected=!1,this.selectedConnectionIds=[];for(var t in this.items)this.items[t].isSelected=!1,this.selectedItemIds.push(t),this.selectedItemIds=[]}function fa(e){var t=this;if(Ct.isOneOrTwoDimensional(e)){var n=Object.keys(this.items).filter((function(n){return Ct.hasIntersection(e,t.items[n].boundingBox)})),o=Object.keys(this.connections).filter((function(n){var o=t.connections[n],i=t.ports[o.source],r=t.ports[o.target];return Ct.isLineIntersectingRectangle(i.position,r.position,e)}));n.concat(o).forEach((function(e){t.updateSelectionList({id:e,isSelected:!0})})),this.selectItemConnections(n)}}function ma(e){var t=this,n=e.reduce((function(e,n){return e.concat(t.items[n].portIds)}),[]);for(var o in this.connections){var i=this.connections[o];n.includes(i.source)&&n.includes(i.target)&&this.updateSelectionList({id:o,isSelected:!0})}}function ha(e){var t=this,n=e.id,o=e.isSelected,i=function(e,n){var i=t[n].findIndex((function(t){return t===e}));o&&-1===i&&t[n].push(e),o||-1===i||t[n].splice(i,1)};if(this.items[n])this.items[n].isSelected=o,i(n,"selectedItemIds");else if(this.connections[n]){var r=this.connections[n].connectionChainId,a=Ur(Object.values(this.connections),this.ports,r),u=a.connectionIds,s=a.freeportIds;u.forEach((function(e){t.connections[e].isSelected=o,i(e,"selectedConnectionIds")})),s.forEach((function(e){t.items[e].isSelected=o,i(e,"selectedItemIds")}))}}function va(e){var t=this,n=e.id,o=e.value,i=this.items[n]||this.connections[n],r=o;if(i&&i.isSelected!==r)if(i.groupId){var a=this.groups[i.groupId],u=a.itemIds,s=a.connectionIds;u.concat(s).forEach((function(e){t.updateSelectionList({id:e,isSelected:r})})),this.updateSelectionList({id:i.groupId,isSelected:r})}else this.updateSelectionList({id:n,isSelected:r})}function ga(e){var t=e?this.baseItems[0]:this.baseItems.slice(-1)[0];t&&(this.deselectAll(),this.setSelectionState({id:t.id,value:!0}))}function ba(){this.hasSelection&&(this.commitState(),this.clearBaseItems(this.selectedItemIds,this.selectedConnectionIds,this.selectedGroupIds.filter((function(e){return null!==e}))),this.deselectAll())}function ya(){this.simulation.oscillator.isPaused?this.simulation.oscillator.start():this.simulation.oscillator.stop(),this.isOscilloscopeRecording=!this.simulation.oscillator.isPaused}function wa(e){var t=this;for(var n in e)if(this.ports[n]){var o=this.ports[n],i=this.items[o.elementId];i&&o.value!==e[n]&&(this.debugger.hasUpdated=!0),o.value=e[n]}this.isCircuitEvaluated=!this.simulation.canContinue,clearTimeout(this.debugger.timeout),this.debugger.timeout=window.setTimeout((function(){!t.debugger.hasUpdated&&t.simulation.canContinue&&t.isDebugging&&(t.debugger.hasUpdated=!1,t.simulation.advanceDebuggerStep())}))}function xa(e){window.api.showMessageBox({message:"An infinite loop was detected! Entering debugger mode.",type:"error"}),this.isDebugging=!0,this.simulation.startDebugging()}function Ia(){var e=this,t=Object.values(this.items),n=Object.values(this.connections);Object.values(this.ports).forEach((function(e){e.value=0})),this.simulation.stop(),this.simulation=new ur(t,n,this.ports),this.simulation.onChange(this.onSimulationUpdate),this.simulation.onError(this.onError),this.simulation.oscillator.on("change",(function(t){e.oscillogram=t})),Object.values(this.items).forEach((function(t){var n=t.properties,o=t.portIds;null!==n&&void 0!==n&&n.startValue&&o.forEach((function(t){return e.setPortValue({id:t,value:n.startValue.value})}))})),this.simulation.start(),this.isDebugging&&(this.simulation.startDebugging(),this.isCircuitEvaluated=!this.simulation.canContinue)}function Za(){this.debugger.hasUpdated=!1,this.simulation.advanceDebuggerStep(),this.isCircuitEvaluated=!this.simulation.canContinue}function Ca(){this.isDebugging?this.simulation.stopDebugging():this.simulation.startDebugging(),this.isDebugging=!this.isDebugging}function Sa(){this.isOscilloscopeOpen?this.closeOscilloscope():this.openOscilloscope()}function _a(){var e=this;Object.values(this.ports).forEach((function(t){t.isMonitored&&e.simulation.monitorPort(t.id,t.value,t.hue)})),this.isOscilloscopeOpen=!0}function Da(e){this.isOscilloscopeOpen&&(Object.keys(this.ports).forEach(this.simulation.unmonitorPort),this.simulation.oscillator.clear(),this.isOscilloscopeOpen=!1,e&&(this.oscilloscopeHeight=e))}function Oa(){this.simulation.oscillator.clear()}var Pa=.1;function ka(){var e=this,t=Object.values(this.items).map((function(e){return e.boundingBox})),n=Ct.getGroupBoundingBox(t),o=n.right-n.left,i=n.bottom-n.top,r=this.canvas.right-this.canvas.left,a=this.canvas.bottom-this.canvas.top;(o>r||i>a)&&(this.canvas={left:0,top:0,right:2*o,bottom:2*i},this.centerAll(),this.panToCenter()),setTimeout((function(){e.setZoom({zoom:Math.min(e.viewport.width/o,e.viewport.height/i,1)})}))}function Ma(e){this.viewport=e,this.canvas.right=screen.width/Pa,this.canvas.bottom=screen.height/Pa,!this.hasLoaded&&e.width>0&&e.height>0&&(this.hasLoaded=!0,this.updateCanvasSize(),this.centerAll(),this.panToCenter())}function Ba(e){var t=e.rect,n=e.id,o=this.items[n],i=t.width/this.zoomLevel,r=t.height/this.zoomLevel,a=o.position.x+o.width/2,u=o.position.y+o.height/2,s=a-i/2,c=u-r/2;this.items[n].position={x:s,y:c},this.items[n].width=i,this.items[n].height=r,this.setItemBoundingBox(n),this.items[n].groupId&&this.setGroupBoundingBox(this.items[n].groupId)}function Ea(e){if(this.items[e]){var t=this.items[e],n=t.position,o=t.rotation,i=t.width,r=t.height;this.items[e].boundingBox=Ct.getBoundingBox(n,o,i,r)}}function za(e){var t=this;if(this.groups[e]){var n=this.groups[e].itemIds.map((function(e){return t.items[e].boundingBox}));this.groups[e].boundingBox=Ct.getGroupBoundingBox(n)}}function Na(e){var t=this;this.snapBoundaries=function(){if(t.connectablePortIds.length)return t.connectablePortIds.filter((function(t){return t!==e})).map((function(e){return Ct.getPointBoundary(t.ports[e].position)}));var n=t.items[e];if(n&&!n.groupId){if(n.type!==he.Freeport)return Object.values(t.items).filter((function(t){return t.id!==e&&t.type!==he.Freeport})).map((function(e){return e.boundingBox}));if(n.portIds.length>1)return Object.values(t.connections).reduce((function(e,o){return n.portIds.includes(o.source)?e.concat(Ct.getLinearBoundaries(t.ports[o.target].position)):n.portIds.includes(o.target)?e.concat(Ct.getLinearBoundaries(t.ports[o.source].position)):e}),[])}return[]}()}function ja(){var e=this.undoStack.slice(-1).pop();e&&(this.redoStack.push(JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})),this.applyState(e),this.undoStack.pop(),this.isDirty=!0)}function Ta(){var e=this.redoStack.slice(-1).pop();e&&(this.undoStack.push(JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})),this.applyState(e),this.redoStack.pop(),this.isDirty=!0)}function Fa(){this.cacheState(),this.commitCachedState()}function La(){this.cachedState=JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})}function Wa(){this.cachedState&&(this.undoStack.push(this.cachedState.toString()),this.cachedState=null,this.redoStack=[],this.isDirty=!0)}function Va(e){var t=this,n=JSON.parse(e),o=n.items,i=n.connections,r=n.ports,a=n.groups;function u(e,t){var n=Object.keys(e),o=Object.keys(t);return n.filter((function(e){return!o.includes(e)}))}var s=u(this.items,o),c=u(this.connections,i),l=u(o,this.items),d=u(i,this.connections);this.clearBaseItems(s,c,[]),this.ports=r,this.items=o,this.groups=a,l.forEach((function(e){t.addItem({item:o[e],ports:r})})),d.forEach((function(e){return t.connect(i[e])})),this.stepThroughCircuit()}function Aa(e,t){return e.zIndex>t.zIndex?1:e.zIndex<t.zIndex?-1:0}function Ra(){this.commitState(),this.incrementZIndex(-1)}function Ua(){this.commitState(),this.incrementZIndex(1)}function qa(){this.commitState(),this.setZIndex(1)}function Ha(){this.commitState(),this.setZIndex(this.zIndex)}function $a(e){var t=Object.values(this.items),n=Object.values(this.connections),o=t.concat(n).sort(Aa),i=o.filter((function(e){var t=e.isSelected;return t})).map((function(e){var t=e.id;return t}));e>0&&i.reverse();var r=[];i.forEach((function(t){var n,i=o.findIndex((function(e){return e.id===t})),a=i+e;if(a<0||a>=o.length)r.push(o[i].id);else if(!r.includes(null===(n=o[a])||void 0===n?void 0:n.id)){var u=o[i];o.splice(i,1),o.splice(a,0,u)}})),o.forEach((function(e,t){e.zIndex=t+1})),this.zIndex=Object.keys(o).length}function Ga(e){for(var t=Object.values(this.items),n=Object.values(this.connections),o=t.concat(n).sort(Aa),i=o.filter((function(e){var t=e.isSelected;return t})),r=0;r<o.length;r++)o[r].isSelected&&(o.splice(r,1),r--);o.splice.apply(o,[e-1,0].concat((0,z.Z)(i))),o.forEach((function(e,t){e.zIndex=t+1})),this.zIndex=Object.keys(o).length}var Ya=.1,Ka=2,Xa=.1;function Ja(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.setZoom({zoom:this.zoomLevel+Xa*e})}function Qa(e){var t=e.zoom,n=e.point;t<Ya&&(t=Ya),t>Ka&&(t=Ka),t=Math.round(100*t)/100,n||(n=Ct.getBoundingBoxMidpoint(this.viewport),n.x+=this.viewport.left,n.y+=this.viewport.top);var o=zr(this.canvas,this.viewport,n,this.zoomLevel),i={x:o.x*t,y:o.y*t},r={x:n.x-this.viewport.x,y:n.y-this.viewport.y};this.panTo({x:Math.round(Math.min(r.x-i.x,0)),y:Math.round(Math.min(r.y-i.y,0))}),this.zoomLevel=t}var eu=function(e){return(0,w.Q_)({id:e,state:sr,getters:{baseItems:function(e){return Object.values(e.connections).concat(Object.values(e.items)).sort(Aa)},zoom:function(e){return e.zoomLevel},hasSelection:function(e){return e.selectedItemIds.length>0||e.selectedConnectionIds.length>0},hasSelectedItems:function(e){return e.selectedItemIds.length>0},selectedGroupIds:function(e){var t=new Set;return e.selectedItemIds.forEach((function(n){var o;return t.add(null===(o=e.items[n])||void 0===o?void 0:o.groupId)})),Array.from(t)},canGroup:function(){return this.selectedGroupIds.length>1||null===[].slice.call(this.selectedGroupIds)[0]},canUngroup:function(){return!![].slice.call(this.selectedGroupIds).find((function(e){return!!e}))},canUndo:function(e){return e.undoStack.length>0},canRedo:function(e){return e.redoStack.length>0}},actions:(0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)((0,le.Z)({},o),i),r),a),u),s),c),l),d),p),f),m),v),h),g),b),y)})};n(3123);function tu(e){var t;return(null===(t=e.split("\\").pop())||void 0===t?void 0:t.split("/").pop())||""}var nu=(0,w.Q_)({id:"root",state:function(){return{documents:{},clipboard:null,activeDocumentId:null,canExit:!1,isFullscreen:!1,isBuilderOpen:!1,isToolboxOpen:!1,isSettingsOpen:!1,isDocumentSelectOpen:!1}},getters:{hasOpenDocuments:function(e){return Object.keys(e.documents).length>0},activeDocument:function(e){return e.activeDocumentId?e.documents[e.activeDocumentId]:null},isDialogOpen:function(e){return e.isBuilderOpen}},actions:{launchIntegratedCircuitBuilder:function(){var e=this;return(0,D.Z)((0,_.Z)().mark((function t(){var n,o,i,r;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Me(),o=e.activeDocument,!o){t.next=18;break}return e.isBuilderOpen=!0,t.prev=4,t.next=7,n.launchBuilder(o.store().$state);case 7:i=o.store(),r=ke.mapIntegratedCircuitIds(n.model),i.insertItemAtPosition({item:r,ports:[]}),i.setItemBoundingBox(r.id),i.setSelectionState({id:r.id,value:!0}),t.next=17;break;case 14:t.prev=14,t.t0=t["catch"](4),window.api.showMessageBox({message:"That's okay."});case 17:e.isBuilderOpen=!1;case 18:case"end":return t.stop()}}),t,null,[[4,14]])})))()},openIntegratedCircuit:function(e){e.integratedCircuit&&this.openDocument("",e.integratedCircuit.serializedState,e.id,e.name)},saveImage:function(e){var t=this;return(0,D.Z)((0,_.Z)().mark((function n(){var o,i,r;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.activeDocument){n.next=2;break}return n.abrupt("return");case 2:if(n.prev=2,o=t.activeDocument.displayName.replace(/\.[^/.]+$/,""),i="".concat(o,".png"),r=window.api.showSaveFileDialog([{name:"PNG Image",extensions:[".png"]}],i),r){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,_e.writeBlob(r,e);case 10:n.next=16;break;case 12:n.prev=12,n.t0=n["catch"](2),console.log("ERROR: ",n.t0),window.api.showMessageBox({message:"An error occurred while trying to save the image.",title:"Error",type:"error"});case 16:case"end":return n.stop()}}),n,null,[[2,12]])})))()},newDocument:function(){var e=(0,fe.Z)(),t=eu(e),n=t();n.resetCircuit(),this.documents[e]={fileName:"Untitled Circuit",displayName:"Untitled Circuit",store:t},this.activateDocument(e)},closeAll:function(){var e=this;return(0,D.Z)((0,_.Z)().mark((function t(){var n;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.activeDocumentId){t.next=9;break}return t.next=3,e.closeDocument(e.activeDocumentId);case 3:return n=t.sent,t.next=6,new Promise((function(e){return setTimeout(e)}));case 6:if(!n){t.next=8;break}return t.abrupt("return",e.closeAll());case 8:return t.abrupt("return",!1);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t)})))()},printActiveDocument:function(){this.activeDocument&&(this.activeDocument.store().isPrinting=!0)},closeDocument:function(e){var t=this;return(0,D.Z)((0,_.Z)().mark((function n(){var o,i,r,a,u;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=t.documents[e],i=o.store(),r=!0,t.activateDocument(e),!i.isDirty){n.next=12;break}if(a=window.api.showMessageBox({message:"Save changes to ".concat(o.fileName,"?"),title:"Confirm",buttons:["Yes","No","Cancel"]}),0!==a){n.next=10;break}return n.next=9,t.saveActiveDocument();case 9:r=n.sent;case 10:if(2!==a){n.next=12;break}return n.abrupt("return",!1);case 12:return t.activeDocumentId=null,i.simulation.stop(),i.$reset(),i.$dispose(),delete t.documents[e],u=Object.keys(t.documents).pop(),u&&t.activateDocument(u),n.abrupt("return",r);case 20:case"end":return n.stop()}}),n)})))()},saveActiveDocument:function(){var e=arguments,t=this;return(0,D.Z)((0,_.Z)().mark((function n(){var o,i,r,a,u;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(o=e.length>0&&void 0!==e[0]&&e[0],n.prev=1,t.activeDocument){n.next=4;break}return n.abrupt("return",!0);case 4:if(t.activeDocument.filePath&&!o){n.next=10;break}if(i=t.activeDocument.fileName||"".concat(t.activeDocument.fileName,".alfx"),r=window.api.showSaveFileDialog([{name:"Aristotle Logic Circuit (*.alfx)",extensions:["alfx"]}],i),r){n.next=9;break}return n.abrupt("return",!0);case 9:r&&(a=tu(r),t.activeDocument.filePath=r,t.activeDocument.fileName=a,t.activeDocument.displayName=a);case 10:if(t.activeDocument.filePath){n.next=12;break}return n.abrupt("return",!0);case 12:return u=t.activeDocument.store(),_e.save(t.activeDocument.filePath,{items:u.items,connections:u.connections,groups:u.groups,ports:u.ports}),u.isDirty=!1,n.abrupt("return",!0);case 18:return n.prev=18,n.t0=n["catch"](1),window.api.showMessageBox({message:"An error occurred while trying to save the file.",title:"Error",type:"error"}),n.abrupt("return",!1);case 22:case"end":return n.stop()}}),n,null,[[1,18]])})))()},selectDocument:function(){var e=this;return(0,D.Z)((0,_.Z)().mark((function t(){var n,o;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=window.api.showOpenFileDialog([{name:"Aristotle Logic Circuit (*.alfx)",extensions:["alfx"]},{name:"Aristotle Integrated Circuit (*.aicx)",extensions:["aicx"]}]),o=0;case 2:if(!(o<n.length)){t.next=8;break}return t.next=5,e.openDocumentFromPath(n[o]);case 5:o++,t.next=2;break;case 8:case"end":return t.stop()}}),t)})))()},openDocumentFromPath:function(e){var t=this;return(0,D.Z)((0,_.Z)().mark((function n(){var o;return(0,_.Z)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_e.open(e);case 3:o=n.sent,o&&t.openDocument(e,o,(0,fe.Z)()),n.next=11;break;case 7:n.prev=7,n.t0=n["catch"](0),console.log(n.t0),window.api.showMessageBox({message:"Could not open ".concat(e,". The file is not a valid Aristotle circuit."),title:"Error",type:"error"});case 11:case"end":return n.stop()}}),n,null,[[0,7]])})))()},openDocument:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(this.documents[n])return this.activateDocument(n);var i=eu(n),r=i(),a=tu(e);r.loadDocument(t),this.documents[n]={fileName:a,filePath:/^.*.aicx$/i.test(e)?void 0:e,displayName:o||a,store:i},this.activateDocument(n)},switchDocument:function(e){var t=this,n=Object.keys(this.documents),o=n.findIndex((function(e){return t.activeDocumentId===e})),i=o+e;0!==n.length&&(-1===o||i>=n.length?i=0:i<0&&(i=n.length-1),this.activateDocument(n[i]))},pauseActivity:function(){var e;null===(e=this.activeDocument)||void 0===e||e.store().simulation.stop()},resumeActivity:function(){var e;null===(e=this.activeDocument)||void 0===e||e.store().simulation.start()},activateDocument:function(e){this.pauseActivity(),this.activeDocumentId=e,this.resumeActivity()},openTestDocuments:function(){this.openDocument("flip-flop.alfx",JSON.stringify(_i),(0,fe.Z)(),"flip-flop.alfx"),Me().loadLibrary()},navigateDocumentList:function(e){var t=this,n=Object.keys(this.documents),o=n.findIndex((function(e){return e===t.activeDocumentId})),i=o+e;i<0&&(i=n.length-1),i>=n.length&&(i=0),this.activateDocument(n[i])},toggleFullscreen:function(){this.isFullscreen=!this.isFullscreen,window.api.setFullscreen(this.isFullscreen)},toggleToolbox:function(){this.isToolboxOpen=!this.isToolboxOpen}}}),ou=(0,I.aZ)({name:"Item",components:{CircuitComponent:ri,Draggable:zt,PortItem:Si,Properties:gi},props:{zIndex:{type:Number,default:1},isSelected:{type:Boolean,default:!1},id:{type:String,required:!0},flash:{type:Boolean,default:!1},store:{type:Function,required:!0}},setup:function(e,t){t.emit;var n=e.store(),o=(0,I.Fl)((function(){return n.items[e.id]})),i=(0,I.Fl)((function(){return n.viewport})),r=(0,P.iH)(),a=(0,P.iH)(0);(0,I.YP)((function(){var e;return null===(e=o.value)||void 0===e?void 0:e.rotation}),(function(){return a.value++})),(0,I.YP)((function(){var e,t;return null===(e=o.value)||void 0===e||null===(t=e.properties.inputCount)||void 0===t?void 0:t.value}),(function(){return a.value++}));var u=(0,I.Fl)((function(){return n.items[e.id].portIds.map((function(e){return n.ports[e]}))})),s=(0,I.Fl)((function(){return e.isSelected&&1===n.selectedItemIds.length&&o.value.type!==he.Freeport}));function c(){var e;null===(e=r.value)||void 0===e||e.$el.focus()}function l(){var e;(null===(e=o.value)||void 0===e?void 0:e.subtype)===ye.CustomCircuit&&nu().openIntegratedCircuit(o.value)}function d(){n.cacheState(),n.setSnapBoundaries(e.id)}function p(t,i){n.dragItem(e.id,{x:t.x-i.x-o.value.width/2*n.zoomLevel,y:t.y-i.y-o.value.height/2*n.zoomLevel})}function f(e){var t;document.activeElement===(null===(t=r.value)||void 0===t?void 0:t.$el)?r.value.$el.blur():e.preventDefault()}function m(e){n.activePortId===e&&n.setActivePortId(null)}function h(t){n.setItemSize({id:e.id,rect:t})}function v(){e.isSelected||n.selectItem(e.id),window.api.showContextMenu(en(e.store))}return{item:o,itemRef:r,store:n,ports:u,viewport:i,isPropertiesEnabled:s,portUpdates:a,focus:c,onDrag:p,onDragStart:d,onEscapeKey:f,onResize:h,onPortBlur:m,onContextMenu:v,revealCustomCircuit:l,ItemSubtype:ye,ItemType:he}}});const iu=(0,V.Z)(ou,[["render",rn]]);var ru=iu;function au(e,t,n,o,i,r){var a=(0,I.up)("selector"),u=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(u,{onMousewheel:e.onMouseWheel,onMousedown:(0,x.iM)(e.onMouseDown,["right"]),onTouchstart:e.onTouchStart,onTouchmove:e.onTouchMove,onTouchend:e.onTouchEnd,onResize:t[0]||(t[0]=function(t){return e.$emit("resize",t)}),class:"editor"},{default:(0,I.w5)((function(){return[(0,I._)("div",{style:(0,Z.j5)(e.style),class:"editor__grid"},[(0,I.Wm)(a,{zoom:e.zoom,onSelectionStart:e.onSelectionStart,onSelectionEnd:e.onSelectionEnd,ref:"selector"},null,8,["zoom","onSelectionStart","onSelectionEnd"]),(0,I.WI)(e.$slots,"default")],4)]})),_:3},8,["onMousewheel","onMousedown","onTouchstart","onTouchmove","onTouchend"])}function uu(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{onMousedown:t[0]||(t[0]=(0,x.iM)((function(){return e.onMouseDown&&e.onMouseDown.apply(e,arguments)}),["left","self"])),class:"selector",ref:"selector"},[e.hasSelection?((0,I.wg)(),(0,I.iD)("div",{key:0,style:(0,Z.j5)(e.style),class:"selector__selection"},null,4)):(0,I.kq)("",!0)],544)}var su=(0,I.aZ)({name:"Selector",emits:{selectionStart:function(e){return!0},selectionEnd:function(e){return!0}},props:{zoom:{type:Number,default:1}},setup:function(e,t){var n=t.emit,o=(0,P.iH)({x:0,y:0}),i=(0,P.iH)({x:0,y:0}),r=(0,P.iH)(null),a=(0,P.iH)(!1),u=function(){return{left:Math.min(o.value.x,i.value.x),top:Math.min(o.value.y,i.value.y),width:Math.abs(o.value.x-i.value.x),height:Math.abs(o.value.y-i.value.y)}},s=(0,I.Fl)((function(){var e=u();return{left:"".concat(e.left,"px"),top:"".concat(e.top,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}}));function c(t){if(!r.value)return{x:0,y:0};var n=r.value.getBoundingClientRect(),o=n.top,i=n.left,a=(t.x-i)/e.zoom,u=(t.y-o)/e.zoom;return{x:a,y:u}}function l(){var e=u(),t=e.left,o=e.top,i=e.width,r=e.height;n("selectionEnd",{left:t,top:o,bottom:r+o,right:t+i})}function d(e){var t=c(e);a.value=!0,o.value=t,i.value=t,n("selectionStart",e)}function p(e){a.value&&(i.value=c(e))}function f(){a.value&&(l(),a.value=!1,o.value.x=0,o.value.y=0,i.value.x=0,i.value.y=0)}return(0,I.bv)((function(){window.addEventListener("mousemove",p),window.addEventListener("mouseup",f)})),(0,I.Jd)((function(){window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f)})),{selector:r,hasSelection:a,style:s,onMouseDown:d}}});const cu=(0,V.Z)(su,[["render",uu]]);var lu=cu,du=(0,I.aZ)({name:"Editor",emits:{resize:function(e){return!0},pan:function(e,t){return!0},selection:function(e){return!0},deselect:function(){return!0},zoom:function(e){return!0},contextmenu:function(e){return!0}},components:{Selector:lu,Resizable:Mt},props:{zoom:{type:Number,default:1},gridSize:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},offset:{type:Object,default:function(){return{x:0,y:0}}},animatePan:{type:Boolean,default:!1}},setup:function(e,t){var n=t.emit,o={x:0,y:0},i={x:0,y:0},r={y:0,x:0},a=0,u=0,s=!1,c=0,l=1,d=(0,P.iH)(null),p=(0,I.Fl)((function(){return{backgroundSize:"".concat(e.gridSize,"px ").concat(e.gridSize,"px"),transform:"scale(".concat(e.zoom,")"),left:"".concat(e.offset.x,"px"),top:"".concat(e.offset.y,"px"),width:"".concat(e.width,"px"),height:"".concat(e.height,"px")}}));function f(e){var t=e.touches,n=t[0].clientX-t[1].clientX,o=t[0].clientY-t[1].clientY;return Math.hypot(n,o)}function m(t,n){s=!0,o={x:t-e.offset.x,y:n-e.offset.y},r={x:t,y:n},i={x:t,y:n},a=0,u=0}function h(e,t){if(s){var r=i.x-e,c=i.y-t;n("pan",{x:Math.min(e-o.x,0),y:Math.min(t-o.y,0)}),a=Math.hypot(r,c),u=Math.atan2(c,r),i={x:e,y:t}}}function v(){var t=2,o=a*Math.cos(u)*t,i=a*Math.sin(u)*t;n("pan",{x:Math.min(e.offset.x-o,0),y:Math.min(e.offset.y-i,0)},!0)}function g(e){m(e.x,e.y),e.preventDefault(),e.stopPropagation()}function b(e){h(e.x,e.y)}function y(e){s&&(s=!1,2===e.button&&Ct.isInNeighborhood(e,r,5)?n("contextmenu",e):v())}function w(t){var n=t.touches[0],o=n.clientX,i=n.clientY;t.targetTouches.length>1?(c=f(t),l=e.zoom):m(o,i),t.preventDefault(),t.stopPropagation()}function x(e){var t=e.touches[0],o=t.clientX,i=t.clientY;if(e.preventDefault(),e.stopPropagation(),e.targetTouches.length>1&&e.changedTouches.length>1){var r=f(e),a=Math.max(Math.min(l*(r/c),4),.1),u={x:(o+e.touches[1].clientX)/2,y:(i+e.touches[1].clientY)/2};n("zoom",{zoom:a,point:u})}else 0===c&&h(o,i)}function Z(e){var t;e.target===(null===(t=d.value)||void 0===t?void 0:t.$el)&&n("deselect"),s&&v(),s=!1,c=0}function C(t){var o=t.deltaY,i=t.x,r=t.y,a=t.shiftKey;if(a){var u=o<0?1:-1,s=e.zoom+u/10;n("zoom",{zoom:s,point:{x:i,y:r}})}}function S(e){e.shiftKey||n("deselect")}function _(e){n("selection",e)}return(0,I.bv)((function(){window.addEventListener("mousemove",b),window.addEventListener("mouseup",y)})),(0,I.Jd)((function(){window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",y)})),{selector:d,style:p,onTouchStart:w,onTouchMove:x,onTouchEnd:Z,onMouseDown:g,onMouseMove:b,onMouseWheel:C,onSelectionStart:S,onSelectionEnd:_}}});const pu=(0,V.Z)(du,[["render",au]]);var fu=pu;function mu(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["group",{"group--is-selected":e.isSelected}]),tabindex:-1,style:(0,Z.j5)({position:"absolute",left:"".concat(e.boundingBox.left,"px"),top:"".concat(e.boundingBox.top,"px"),width:"".concat(e.boundingBox.right-e.boundingBox.left,"px"),height:"".concat(e.boundingBox.bottom-e.boundingBox.top,"px"),zIndex:e.zIndex})},null,6)}var hu=(0,I.aZ)({name:"Group",props:{boundingBox:{type:Object,required:!0},id:{type:String,required:!0},isSelected:{type:Boolean,default:!1},zIndex:{type:Number,default:0},zoom:{type:Number,default:1}}});const vu=(0,V.Z)(hu,[["render",mu]]);var gu=vu,bu=n(9306),yu=n.n(bu);function wu(e,t,n,o){for(var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"printer-friendly",r=t.cloneNode(!0),a=n.right-n.left+2*o,u=n.bottom-n.top+2*o,s=0;s<r.children.length;s++){var c=r.children[s],l=parseInt(c.style.left.replace("px",""),10)+o,d=parseInt(c.style.top.replace("px",""),10)+o;c.style.left="".concat(l-n.left,"px"),c.style.top="".concat(d-n.top,"px")}return r.style["zoom"]=e.toString(),r.style.width="".concat(a,"px"),r.style.height="".concat(u,"px"),r.style.position="relative",r.style.top="0",r.style.left="0",r.style.background="none",i&&r.classList.add(i),{printArea:r,width:a,height:u}}function xu(e,t){var n=document.createElement("iframe");n.name="print",n.style.width="1px",n.style.height="1px",n.style.opacity="0",n.style.position="absolute",n.style.top="0px",n.style.left="0px",document.body.appendChild(n);var o=n.contentWindow;if(o){var i=document.createElement("style");i.appendChild(document.createTextNode("\n      @page {\n        size: ".concat(t.map((function(e){return"".concat(e,"in")})).join(" "),";\n        margin: 0in;\n      }\n    "))),o.document.head.append(i),o.document.body.appendChild(e)}return n}function Iu(e,t){return Zu.apply(this,arguments)}function Zu(){return Zu=(0,D.Z)((0,_.Z)().mark((function e(t,n){var o;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return document.body.appendChild(t),e.next=3,yu()[n](t);case 3:return o=e.sent,t.remove(),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),Zu.apply(this,arguments)}function Cu(e){return Su.apply(this,arguments)}function Su(){return Su=(0,D.Z)((0,_.Z)().mark((function e(t){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){setTimeout((function(){if(!t)return e();t.addEventListener("afterprint",(function(){return e()})),t.print()}))})));case 1:case"end":return e.stop()}}),e)}))),Su.apply(this,arguments)}function _u(e,t,n){return Du.apply(this,arguments)}function Du(){return Du=(0,D.Z)((0,_.Z)().mark((function e(t,n,o){var i,r,a,u,s,c,l,d,p,f,m,h;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=wu(1/t,n,o,20),r=i.printArea,a=i.width,u=i.height,e.next=3,Ou.createImage(r,"toPng");case 3:return s=e.sent,c=[8.5,11],l=96*Math.min.apply(Math,c),d=96*Math.max.apply(Math,c),p=new Image,f=1,p.src=s,(a>l||a>d||u>l||u>d)&&(m=a>u,f=m?d/a:d/u,m&&c.reverse()),p.style.width="".concat(Math.floor(a*f),"px"),p.style.height="".concat(Math.floor(u*f),"px"),h=Ou.createPrintFrame(p,c),e.next=16,Ou.printWindow(null===h||void 0===h?void 0:h.contentWindow);case 16:null===h||void 0===h||h.remove();case 17:case"end":return e.stop()}}),e)}))),Du.apply(this,arguments)}var Ou={createPrintArea:wu,createPrintFrame:xu,createImage:Iu,printImage:_u,printWindow:Cu},Pu=Ou,ku=(0,I.aZ)({name:"Document",components:{Group:gu,Editor:fu,Connection:on,Item:ru},props:{store:{type:Function,required:!0}},setup:function(e){var t=e.store(),n=nu(),o=(0,P.iH)(),i=(0,P.iH)(0),r=(0,w.Jk)(_r()),a=r.colors,u=r.grid,s=1,c={};function l(e){if(o.value){var n=Object.values(t.items).map((function(e){var t=e.boundingBox;return t})),i=Ct.getGroupBoundingBox(n),r=o.value.$el.querySelector(".editor__grid");e(r,i)}}function d(){return p.apply(this,arguments)}function p(){return p=(0,D.Z)((0,_.Z)().mark((function e(){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:l(function(){var e=(0,D.Z)((0,_.Z)().mark((function e(n,o){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Pu.printImage(t.zoom,n,o);case 2:t.isPrinting=!1;case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function f(){return m.apply(this,arguments)}function m(){return m=(0,D.Z)((0,_.Z)().mark((function e(){return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:l(function(){var e=(0,D.Z)((0,_.Z)().mark((function e(o,i){var r,a,u;return(0,_.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=Pu.createPrintArea(1/t.zoom,o,i,20,""),a=r.printArea,e.next=3,Pu.createImage(a,"toBlob");case 3:return u=e.sent,e.next=6,n.saveImage(u);case 6:t.isCreatingImage=!1;case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),m.apply(this,arguments)}function h(e){return function(n){n.target instanceof HTMLInputElement||(t[e](),n.preventDefault())}}function v(e){if(!(e.target instanceof HTMLInputElement))switch(e.key){case"Escape":return t.deselectAll();case"a":return e.ctrlKey&&t.selectAll();default:return y(e)}}function g(e){c[e.key]=!1,s=1}function b(t){window.api.showContextMenu(en(e.store)),t.preventDefault(),t.stopPropagation()}function y(e){var n=function(){switch(e.key){case"ArrowLeft":return{x:-1,y:0};case"ArrowUp":return{x:0,y:-1};case"ArrowRight":return{x:1,y:0};case"ArrowDown":return{x:0,y:1}}}();if(n){var o=Math.min(s,10);t.moveSelectionPosition({x:n.x*o,y:n.y*o}),s*=1.05}}function x(){c={}}return(0,I.m0)((function(){t.isPrinting&&d(),t.isCreatingImage&&f()})),(0,I.bv)((function(){document.addEventListener("keydown",v),document.addEventListener("keyup",g),document.addEventListener("cut",h("cut")),document.addEventListener("copy",h("copy")),document.addEventListener("paste",h("paste")),window.addEventListener("blur",x)})),(0,I.Jd)((function(){document.removeEventListener("keydown",v),document.removeEventListener("keyup",g),document.addEventListener("cut",h("cut")),document.addEventListener("copy",h("copy")),document.addEventListener("paste",h("paste")),window.removeEventListener("blur",x)})),{store:t,editor:o,updates:i,colors:a,grid:u,storeDefinition:e.store,onKeyDown:v,onKeyUp:g,onContextMenu:b,clearKeys:x}}});const Mu=(0,V.Z)(ku,[["render",tt]]);var Bu=Mu;function Eu(e,t,n,o,i,r){var a=(0,I.up)("mobile-button"),u=(0,I.up)("property-form"),s=(0,I.up)("mobile-collapsible-panel");return(0,I.wg)(),(0,I.iD)(I.HY,null,[(0,I.Wm)(a,{icon:e.faFile,label:"New Circuit"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faCodeBranch,label:"Load Circuit"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faMicrochip,label:"Import integrated circuit"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faImage,label:"Export image"},null,8,["icon"]),(0,I.Wm)(s,{title:"Colors",icon:e.faPalette},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{modelValue:e.colors,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.colors=t}),id:"section1"},null,8,["modelValue"])]})),_:1},8,["icon"]),(0,I.Wm)(s,{title:"Grid",icon:e.faTableCells},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{modelValue:e.grid,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.grid=t}),id:"section1"},null,8,["modelValue"])]})),_:1},8,["icon"]),(0,I.Wm)(s,{title:"Snapping",icon:e.faMagnet},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{modelValue:e.snapping,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.snapping=t}),id:"section1"},null,8,["modelValue"])]})),_:1},8,["icon"]),(0,I.Wm)(s,{title:"Simulation",icon:e.faGears},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{modelValue:e.simulation,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.simulation=t}),id:"section1"},null,8,["modelValue"])]})),_:1},8,["icon"]),(0,I.Wm)(s,{title:"Experience",icon:e.faWandMagicSparkles},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{modelValue:e.experience,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.experience=t}),id:"section1"},null,8,["modelValue"])]})),_:1},8,["icon"])],64)}var zu={class:"mobile-button"},Nu={class:"mobile-button__label"};function ju(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",zu,[(0,I.Wm)(a,{icon:e.icon,class:"mobile-button__icon"},null,8,["icon"]),(0,I._)("div",Nu,(0,Z.zw)(e.label),1),e.chevron?((0,I.wg)(),(0,I.j4)(a,{key:0,icon:e.faChevronDown,class:(0,Z.C_)([{"mobile-button__icon--open":e.isOpen},"mobile-button__icon--chevron"])},null,8,["icon","class"])):(0,I.kq)("",!0)])}var Tu=(0,I.aZ)({name:"MobileButton",components:{Icon:Ue},props:{label:{type:String,default:""},icon:{type:Object,required:!0},chevron:{type:Boolean,default:!1},isOpen:{type:Boolean,default:!1}},setup:function(){return{faChevronDown:O.ptq}}});const Fu=(0,V.Z)(Tu,[["render",ju]]);var Lu=Fu,Wu={class:"mobile-collapsible-panel"},Vu={ref:"content"};function Au(e,t,n,o,i,r){var a=(0,I.up)("mobile-button");return(0,I.wg)(),(0,I.iD)("div",Wu,[(0,I.Wm)(a,{label:e.title,icon:e.icon,"is-open":e.isOpen,onClick:e.toggle,chevron:""},null,8,["label","icon","is-open","onClick"]),(0,I._)("div",{class:"mobile-collapsible-panel__content",style:(0,Z.j5)({height:e.height})},[(0,I._)("div",Vu,[(0,I._)("div",{class:(0,Z.C_)(["mobile-collapsible-panel__inner",{"mobile-collapsible-panel__inner--open":e.isOpen}])},[(0,I.WI)(e.$slots,"default")],2)],512)],4)])}var Ru=(0,I.aZ)({name:"MobileCollapsiblePanel",components:{MobileButton:Lu},props:{title:{type:String,default:""},icon:{type:Object,required:!0}},setup:function(){var e=(0,P.iH)("0"),t=(0,P.iH)(),n=(0,P.iH)(!1);function o(){var o;e.value=n.value?(null===(o=t.value)||void 0===o?void 0:o.clientHeight)+"px":"0px"}function i(){n.value=!n.value,o()}return(0,I.bv)((function(){return o()})),{faChevronDown:O.ptq,isOpen:n,height:e,content:t,toggle:i}}});const Uu=(0,V.Z)(Ru,[["render",Au]]);var qu=Uu,Hu=(n(2526),n(1817),{class:"property-form"}),$u=["for"],Gu=["onUpdate:modelValue","id","disabled"],Yu=["value"],Ku={key:1,class:"property-form__switch"},Xu=["onUpdate:modelValue","min","max","type","id","disabled"],Ju={key:3,class:"property-form__description"};function Qu(e,t,n,o,i,r){var a=(0,I.up)("property-switch");return(0,I.wg)(),(0,I.iD)("div",Hu,[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.model,(function(n,o){return(0,I.wg)(),(0,I.iD)("div",{key:o,class:"property-form__entry"},[(0,I._)("label",{for:"".concat(e.id,"_").concat(o),class:(0,Z.C_)([{"property-form__label--disabled":n.disabled},"property-form__label"])},(0,Z.zw)(n.label),11,$u),n.options?(0,I.wy)(((0,I.wg)(),(0,I.iD)("select",{key:0,"onUpdate:modelValue":function(e){return n.value=e},id:"".concat(e.id,"_").concat(o),disabled:n.disabled,class:"property-form__input",onChange:t[0]||(t[0]=function(){return e.onChange&&e.onChange.apply(e,arguments)})},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(n.options,(function(e,t){return(0,I.wg)(),(0,I.iD)("option",{key:t,value:e},(0,Z.zw)(t),9,Yu)})),128))],40,Gu)),[[x.bM,n.value]]):"boolean"===n.type?((0,I.wg)(),(0,I.iD)("div",Ku,[(0,I.Wm)(a,{modelValue:n.value,"onUpdate:modelValue":[function(e){return n.value=e},function(t){return e.onSwitch(o)}],modelModifiers:{boolean:!0},id:"".concat(e.id,"_").concat(o),disabled:n.disabled},null,8,["modelValue","onUpdate:modelValue","id","disabled"])])):(0,I.wy)(((0,I.wg)(),(0,I.iD)("input",{key:2,"onUpdate:modelValue":function(e){return n.value=e},min:n.min,max:n.max,type:n.type,id:"".concat(e.id,"_").concat(o),disabled:n.disabled,class:"property-form__input",onChange:t[1]||(t[1]=function(){return e.onChange&&e.onChange.apply(e,arguments)})},null,40,Xu)),[[x.YZ,n.value]]),n.description?((0,I.wg)(),(0,I.iD)("small",Ju,(0,Z.zw)(n.description),1)):(0,I.kq)("",!0)])})),128))])}var es=["id","disabled"];function ts(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("label",{class:(0,Z.C_)(["property-switch",{"property-switch--on":e.model,"property-switch--disabled":e.disabled}])},[(0,I.wy)((0,I._)("input",{"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.model=t}),id:e.id,disabled:e.disabled,type:"checkbox",class:"property-switch__input",onInput:t[1]||(t[1]=function(t){return e.$emit("update:modelValue",!e.model)})},null,40,es),[[x.e8,e.model]]),(0,I._)("div",{class:(0,Z.C_)(["property-switch__trigger",{"property-switch__trigger--on":e.model}])},null,2)],2)}var ns=(0,I.aZ)({name:"PropertyForm",props:{modelValue:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},id:{type:String,default:""}},emits:{"update:modelValue":function(e){return!0}},setup:function(e,t){t.emit;var n=(0,P.iH)(e.modelValue);return(0,I.YP)((function(){return e.modelValue}),(function(){n.value=e.modelValue})),{model:n}}});const os=(0,V.Z)(ns,[["render",ts]]);var is=os,rs=!0,as=rs,us=(0,I.aZ)({name:"PropertyForm",components:{Icon:Ue,PropertySwitch:is},props:{modelValue:{type:Object,default:function(){return{}}},id:{type:String,default:""}},setup:function(e,t){var n=t.emit,o=function(e){return Object.keys(e).filter((function(t){return as?!e[t].desktopOnly:!e[t].mobileOnly})).reduce((function(t,n){return(0,le.Z)((0,le.Z)({},t),{},(0,De.Z)({},n,pe()(e[n])))}),{})},i=(0,P.iH)(o(e.modelValue));function r(e){var t,n=i.value[e];null===(t=n.excludes)||void 0===t||t.forEach((function(e){n.value&&"boolean"===i.value[e].type&&(i.value[e].value=!1)})),a()}function a(){n("update:modelValue",i.value)}return(0,I.YP)((function(){return e.modelValue}),(function(e){i.value=o(e)}),{deep:!0}),{model:i,close:close,onSwitch:r,onChange:a}}});const ss=(0,V.Z)(us,[["render",Qu]]);var cs=ss,ls=(0,I.aZ)({components:{MobileButton:Lu,MobileCollapsiblePanel:qu,PropertyForm:cs},name:"MobilePreferences",setup:function(){var e=_r(),t=(0,w.Jk)(e),n=t.colors,o=t.grid,i=t.snapping,r=t.simulation,a=t.experience,u=e.updateSettings;return{faFile:O.gMD,faCodeBranch:O.mh3,faGears:O.Obi,faImage:O.VmB,faMagnet:O.mlU,faMicrochip:O.zvy,faPalette:O.q2v,faTableCells:O.DaQ,faWandMagicSparkles:O.Z30,colors:n,grid:o,snapping:i,simulation:r,experience:a,updateSettings:u}}});const ds=(0,V.Z)(ls,[["render",Eu]]);var ps=ds,fs={key:0};function ms(e,t,n,o,i,r){var a=(0,I.up)("oscilloscope-title-bar"),u=(0,I.up)("oscilloscope-timeline"),s=(0,I.up)("oscilloscope-viewer");return e.isOscilloscopeOpen?((0,I.wg)(),(0,I.j4)(s,{key:0,modelValue:e.oscilloscopeHeight,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.oscilloscopeHeight=t}),"collapse-height":40,onCollapse:e.closeOscilloscope},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{clearable:e.hasWaves,"is-recording":e.isOscilloscopeRecording,onClear:e.clearOscilloscope,onToggle:e.toggleOscillatorRecording},null,8,["clearable","is-recording","onClear","onToggle"]),e.hasWaves?((0,I.wg)(),(0,I.j4)(u,{key:1,oscillogram:e.oscillogram},null,8,["oscillogram"])):((0,I.wg)(),(0,I.iD)("div",fs," no waves to observe "))]})),_:1},8,["modelValue","onCollapse"])):(0,I.kq)("",!0)}var hs={class:"oscilloscope-timeline"},vs={class:"oscilloscope-timeline__list",ref:"list"},gs=["width","viewBox"],bs=["points","stroke"];function ys(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",hs,[(0,I._)("div",vs,[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.oscillogram,(function(e,t){return(0,I.wg)(),(0,I.iD)("div",{key:t,style:(0,Z.j5)({color:"hsla(".concat(e.hue,", var(--lightness), var(--saturation), 0.8)")}),class:"oscilloscope-timeline__label"},(0,Z.zw)(t),5)})),128))],512),(0,I._)("div",{class:"oscilloscope-timeline__display",ref:"timeline",onWheel:t[0]||(t[0]=function(){return e.onWheel&&e.onWheel.apply(e,arguments)})},[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.oscillogram,(function(t,n){return(0,I.wg)(),(0,I.iD)("div",{style:(0,Z.j5)({width:"".concat(e.totalWidth,"px")}),key:n,class:"oscilloscope-timeline__item"},[(0,I._)("div",{style:(0,Z.j5)({width:"".concat(t.width,"px")}),class:"oscilloscope-timeline__svg"},[((0,I.wg)(),(0,I.iD)("svg",{width:t.width,viewBox:"0 0 ".concat(t.width," 1"),preserveAspectRatio:"none"},[(0,I._)("polyline",{points:t.points,stroke:"hsla(".concat(t.hue,", var(--lightness), var(--saturation), 0.8)"),"stroke-width":"2",fill:"none","vector-effect":"non-scaling-stroke"},null,8,bs)],8,gs))],4)],4)})),128))],544)])}var ws=(0,I.aZ)({name:"OscilloscopeTimeline",props:{oscillogram:{type:Object,required:!0}},computed:{totalWidth:function(){return Object.values(this.oscillogram).reduce((function(e,t){var n=t.width;return Math.max(n,e)}),0)}},mounted:function(){var e=this.$refs.timeline,t=this.$refs.list;this.scrollToNextInterval(),t.addEventListener("scroll",this.onTimelineScroll),e.addEventListener("scroll",this.onTimelineScroll)},beforeUnmount:function(){var e=this.$refs.timeline,t=this.$refs.list;t.removeEventListener("scroll",this.onTimelineScroll),e.removeEventListener("scroll",this.onTimelineScroll)},methods:{onWheel:function(e){var t=this.$refs.timeline;t.scrollTop+=e.deltaY/10,e.preventDefault()},scrollToNextInterval:function(){var e=this.$refs.timeline;e.scrollLeft=e.scrollWidth},onTimelineScroll:function(){var e=this.$refs.list,t=this.$refs.timeline;t&&(e.scrollTop=t.scrollTop)}},watch:{oscillogram:{handler:function(){this.scrollToNextInterval()},deep:!0}}});const xs=(0,V.Z)(ws,[["render",ys]]);var Is=xs,Zs={class:"oscilloscope-title-bar"},Cs=(0,I._)("div",{class:"oscilloscope-title-bar__title"},"Oscilloscope",-1),Ss={class:"oscilloscope-title-bar__actions"},_s=["disabled"];function Ds(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",Zs,[Cs,(0,I._)("div",Ss,[(0,I._)("button",{class:"oscilloscope-title-bar__button",title:"Close",onClick:t[0]||(t[0]=function(t){return e.$emit("close")})},[(0,I.Wm)(a,{icon:e.faClose},null,8,["icon"])]),(0,I._)("button",{class:"oscilloscope-title-bar__button",title:"Clear oscilloscope",disabled:!e.clearable,onClick:t[1]||(t[1]=function(t){return e.$emit("clear")})},[(0,I.Wm)(a,{icon:e.faBan},null,8,["icon"])],8,_s),(0,I._)("button",{class:"oscilloscope-title-bar__button",title:"Close",onClick:t[2]||(t[2]=function(t){return e.$emit("toggle")})},[(0,I.Wm)(a,{icon:e.isRecording?e.faPause:e.faPlay},null,8,["icon"])])])])}var Os=(0,I.aZ)({name:"OscilloscopeTitleBar",components:{Icon:Ue},props:{clearable:{type:Boolean,default:!0},isRecording:{type:Boolean,default:!0}},setup:function(){return{faBan:O.gPx,faClose:O.YIN,faPause:O.XQY,faPlay:O.zc}}});const Ps=(0,V.Z)(Os,[["render",Ds]]);var ks=Ps;function Ms(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{ref:"viewer",class:"oscilloscope-viewer",style:(0,Z.j5)({height:"".concat(e.height,"px")})},[(0,I._)("div",{class:"oscilloscope-viewer__touch-resizer",onTouchstart:t[1]||(t[1]=function(){return e.onTouchStart&&e.onTouchStart.apply(e,arguments)}),onTouchmove:t[2]||(t[2]=function(){return e.onTouchMove&&e.onTouchMove.apply(e,arguments)}),onTouchcancel:t[3]||(t[3]=function(){return e.onMouseUp&&e.onMouseUp.apply(e,arguments)}),onTouchend:t[4]||(t[4]=function(){return e.onMouseUp&&e.onMouseUp.apply(e,arguments)})},[(0,I._)("div",{class:"oscilloscope-viewer__mouse-resizer",onMousedown:t[0]||(t[0]=function(){return e.onMouseDown&&e.onMouseDown.apply(e,arguments)})},null,32)],32),(0,I.WI)(e.$slots,"default")],4)}var Bs=(0,I.aZ)({name:"OscilloscopeViewer",props:{collapseHeight:{type:Number,default:20},modelValue:{type:Number,required:!0}},setup:function(e,t){var n=t.emit,o=(0,P.iH)(e.modelValue),i=(0,P.iH)(),r=0,a=0,u=!1;function s(e){r=o.value,a=e.clientY,u=!0}function c(e){s(e.touches[0])}function l(t){var s;if(u&&i.value){var c=null===(s=i.value.parentElement)||void 0===s?void 0:s.getBoundingClientRect();o.value+=Math.min(a-t.clientY,(null===c||void 0===c?void 0:c.height)||1/0),a=t.clientY,o.value<=e.collapseHeight?n("collapse",r):n("update:modelValue",o.value)}}function d(e){l(e.touches[0])}function p(){u=!1}return(0,I.bv)((function(){window.addEventListener("mousemove",l),window.addEventListener("mouseup",p)})),(0,I.Ah)((function(){window.removeEventListener("mousemove",l),window.removeEventListener("mouseup",p)})),{onMouseDown:s,onMouseUp:p,onTouchStart:c,onTouchMove:d,height:o,viewer:i}}});const Es=(0,V.Z)(Bs,[["render",Ms]]);var zs=Es,Ns=(0,I.aZ)({name:"Oscilloscope",components:{OscilloscopeTimeline:Is,OscilloscopeTitleBar:ks,OscilloscopeViewer:zs},props:{store:{type:Function,required:!0}},setup:function(e){var t=e.store(),n=(0,w.Jk)(t),o=n.oscilloscopeHeight,i=n.isOscilloscopeOpen,r=n.isOscilloscopeRecording,a=n.oscillogram,u=t.clearOscilloscope,s=t.closeOscilloscope,c=t.toggleOscillatorRecording,l=(0,I.Fl)((function(){return Object.keys(t.oscillogram).length>0}));return{hasWaves:l,oscillogram:a,oscilloscopeHeight:o,isOscilloscopeOpen:i,isOscilloscopeRecording:r,clearOscilloscope:u,closeOscilloscope:s,toggleOscillatorRecording:c}}});const js=(0,V.Z)(Ns,[["render",ms]]);var Ts=js,Fs={key:0},Ls={key:1},Ws={key:2};function Vs(e,t,n,o,i,r){var a=(0,I.up)("icon"),u=(0,I.up)("status-bar-button"),s=(0,I.up)("status-bar-zoom"),c=(0,I.up)("status-bar-viewer");return(0,I.wg)(),(0,I.j4)(c,null,{left:(0,I.w5)((function(){return[e.isPrinting?((0,I.wg)(),(0,I.iD)("span",Fs,"Printing...")):e.isCreatingImage?((0,I.wg)(),(0,I.iD)("span",Ls,"Rendering image...")):((0,I.wg)(),(0,I.iD)("span",Ws,"Ready"))]})),right:(0,I.w5)((function(){return[(0,I.Wm)(u,{title:"Zoom out",disabled:e.store.zoomLevel<=.1,onClick:t[0]||(t[0]=function(t){return e.store.incrementZoom(-1)})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{icon:e.faMinus},null,8,["icon"])]})),_:1},8,["disabled"]),(0,I.Wm)(s,{type:"range",class:"status-bar__range",min:0,step:10,max:200,zoom:e.store.zoomLevel,onZoom:t[1]||(t[1]=function(t){return e.store.setZoom({zoom:t})})},null,8,["zoom"]),(0,I.Wm)(u,{title:"Zoom in",disabled:e.store.zoomLevel>=2,onClick:t[2]||(t[2]=function(t){return e.store.incrementZoom(1)})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{icon:e.faPlus},null,8,["icon"])]})),_:1},8,["disabled"]),(0,I.Wm)(u,{width:"3em",onClick:t[3]||(t[3]=function(t){return e.store.setZoom({zoom:1})})},{default:(0,I.w5)((function(){return[(0,I.Uk)((0,Z.zw)(e.zoomPercent)+"% ",1)]})),_:1}),(0,I.Wm)(u,{title:"Toggle fullscreen",onClick:t[4]||(t[4]=function(t){return e.$emit("fullscreen")})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{icon:e.isFullscreen?e.faCompress:e.faExpand},null,8,["icon"])]})),_:1})]})),_:1})}var As=["disabled","title"];function Rs(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("button",{class:"status-bar-button",disabled:e.disabled,title:e.title,style:(0,Z.j5)({width:e.width})},[(0,I.WI)(e.$slots,"default")],12,As)}var Us=(0,I.aZ)({name:"StatusBarButton",props:{disabled:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:String,default:"2em"}}});const qs=(0,V.Z)(Us,[["render",Rs]]);var Hs=qs,$s={class:"status-bar-viewer"},Gs={class:"status-bar-viewer__left"},Ys={class:"status-bar-viewer__right"};function Ks(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",$s,[(0,I._)("div",Gs,[(0,I.WI)(e.$slots,"left")]),(0,I._)("div",Ys,[(0,I.WI)(e.$slots,"right")])])}var Xs=(0,I.aZ)({name:"StatusBarViewer"});const Js=(0,V.Z)(Xs,[["render",Ks]]);var Qs=Js,ec=["step","min","max","value"];function tc(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("input",{type:"range",class:"status-bar-zoom",step:e.step,min:e.min,max:e.max,value:e.value,onInput:t[0]||(t[0]=function(){return e.onInput&&e.onInput.apply(e,arguments)})},null,40,ec)}var nc=(0,I.aZ)({name:"StatusBarZoom",components:{Icon:Ue},props:{zoom:{type:Number,required:!0},min:{type:Number,default:0},max:{type:Number,default:200},step:{type:Number,default:10}},setup:function(e,t){var n=t.emit,o=(0,I.Fl)((function(){return Math.round(100*e.zoom)}));function i(e){var t=e.target,o=parseFloat(t.value);n("zoom",o/100)}return{onInput:i,value:o}}});const oc=(0,V.Z)(nc,[["render",tc]]);var ic=oc,rc=(0,I.aZ)({name:"StatusBar",components:{Icon:Ue,StatusBarButton:Hs,StatusBarViewer:Qs,StatusBarZoom:ic},props:{store:{type:Function,required:!0},isFullscreen:{type:Boolean,default:!1}},setup:function(e){var t=e.store(),n=(0,I.Fl)((function(){return t.isPrinting})),o=(0,I.Fl)((function(){return t.isCreatingImage})),i=(0,I.Fl)((function(){return Math.round(100*t.zoomLevel)}));return{store:t,isPrinting:n,isCreatingImage:o,zoomPercent:i,faMinus:O.Kl4,faPlus:O.r8p,faExpand:O.TL5,faCompress:O.Qj4}}});const ac=(0,V.Z)(rc,[["render",Vs]]);var uc=ac,sc={class:"toolbar"},cc={class:"toolbar__fixed"},lc={class:"toolbar__left"},dc={class:"toolbar__right"};function pc(e,t,n,o,i,r){var a=(0,I.up)("toolbar-button"),u=(0,I.up)("toolbar-separator"),s=(0,I.up)("scroll-fade");return(0,I.wg)(),(0,I.iD)("div",sc,[(0,I._)("div",cc,[(0,I.Wm)(a,{icon:e.faScrewdriverWrench,text:"Toolbox","is-toolbox":"",onClick:e.rootStore.toggleToolbox,active:e.rootStore.isToolboxOpen},null,8,["icon","onClick","active"]),(0,I.Wm)(u)]),(0,I.Wm)(s,{class:"toolbar__scrollable"},{default:(0,I.w5)((function(){return[(0,I._)("div",lc,[(0,I.Wm)(a,{icon:e.faFolderOpen,text:"Open"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faFile,text:"New"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faSave,text:"Save"},null,8,["icon"]),(0,I.Wm)(u),(0,I.Wm)(a,{onClick:e.documentStore.undo,disabled:!e.documentStore.canUndo,icon:e.faReply,text:"Undo"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(a,{onClick:e.documentStore.redo,disabled:!e.documentStore.canRedo,icon:e.faShare,text:"Redo"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(u),(0,I.Wm)(a,{onClick:t[0]||(t[0]=function(t){return e.documentStore.rotate(1)}),disabled:!e.documentStore.hasSelectedItems,icon:e.faRotateForward,text:"Rotate"},null,8,["disabled","icon"]),(0,I.Wm)(u),(0,I.Wm)(a,{onClick:e.documentStore.group,disabled:!e.documentStore.canGroup,icon:e.faObjectGroup,text:"Group"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(a,{onClick:e.documentStore.ungroup,disabled:!e.documentStore.canUngroup,icon:e.faObjectUngroup,text:"Ungroup"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(u),(0,I.Wm)(a,{icon:e.faScissors,text:"Cut"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faCopy,text:"Copy"},null,8,["icon"]),(0,I.Wm)(a,{icon:e.faPaste,text:"Paste"},null,8,["icon"]),(0,I.Wm)(a,{onClick:e.documentStore.deleteSelection,disabled:!e.documentStore.hasSelection,icon:e.faBan,text:"Delete"},null,8,["onClick","disabled","icon"]),(0,I.Wm)(u),(0,I.Wm)(a,{onClick:e.rootStore.launchIntegratedCircuitBuilder,icon:e.faMicrochip,text:"Export"},null,8,["onClick","icon"])]),(0,I._)("div",dc,[(0,I.Wm)(a,{icon:e.faBug,active:e.documentStore.isDebugging,onClick:e.documentStore.toggleDebugger,text:"Debug"},null,8,["icon","active","onClick"]),(0,I.Wm)(u),(0,I.Wm)(a,{icon:e.faArrowsRotate,onClick:e.documentStore.resetCircuit,text:"Reset"},null,8,["icon","onClick"]),(0,I.Wm)(a,{icon:e.faForwardStep,disabled:!e.documentStore.isDebugging||e.documentStore.isCircuitEvaluated,onClick:e.documentStore.stepThroughCircuit,text:"Next"},null,8,["icon","disabled","onClick"]),(0,I.Wm)(u),(0,I.Wm)(a,{icon:e.faWaveSquare,disabled:e.documentStore.isDebugging,active:!e.documentStore.isDebugging&&e.documentStore.isOscilloscopeOpen,onClick:e.documentStore.toggleOscilloscope,text:"Analyze"},null,8,["icon","disabled","active","onClick"])])]})),_:1})])}var fc=n(6024),mc={class:"toolbar-button__text"};function hc(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("button",{tabindex:0,class:(0,Z.C_)([{"toolbar-button--active":e.active&&!e.isToolbox,"toolbar-button--toolbox":e.active&&e.isToolbox,"toolbar-button--disabled":e.disabled},"toolbar-button"]),role:"button",onClick:t[0]||(t[0]=function(){return e.onClick&&e.onClick.apply(e,arguments)})},[e.icon?((0,I.wg)(),(0,I.j4)(a,{key:0,icon:e.icon,class:"toolbar-button__icon"},null,8,["icon"])):((0,I.wg)(),(0,I.j4)(a,{key:1,icon:e.faUser,class:"toolbar-button__icon"},null,8,["icon"])),(0,I._)("div",mc,(0,Z.zw)(e.text),1)],2)}var vc=(0,I.aZ)({name:"ToolbarButton",components:{Icon:Ue},data:function(){return{faUser:O.ILF}},emits:{click:function(e){return!0}},props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},isToolbox:{type:Boolean,default:!1},icon:{type:Object,default:null},text:{type:String,default:""}},setup:function(e,t){var n=t.emit;function o(t){t.stopPropagation(),t.preventDefault(),e.disabled||n("click",t)}return{onClick:o}}});const gc=(0,V.Z)(vc,[["render",hc]]);var bc=gc,yc={class:"toolbar-separator"};function wc(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",yc)}var xc=(0,I.aZ)({name:"ToolbarSeparator"});const Ic=(0,V.Z)(xc,[["render",wc]]);var Zc=Ic;function Cc(e,t,n,o,i,r){var a=(0,I.up)("resizable");return(0,I.wg)(),(0,I.j4)(a,{ref:"scroll",class:(0,Z.C_)(["scroll-fade",{"scrollbar-fade--show-scrollbar":!e.hideScrollbar}]),style:(0,Z.j5)("--mask-image-content: linear-gradient(to right, ".concat(e.gradientStyle,")")),onScroll:e.onChange,onResize:e.onChange},{default:(0,I.w5)((function(){return[(0,I.WI)(e.$slots,"default")]})),_:3},8,["class","style","onScroll","onResize"])}var Sc=(0,I.aZ)({name:"ScrollFade",components:{Resizable:Mt},props:{hideScrollbar:{type:Boolean,default:!1}},setup:function(){var e="transparent, black var(--mask-width)",t="black calc(100% - var(--mask-width)), transparent",n=(0,P.iH)(),o=(0,P.iH)("");function i(n){var i=n.scrollWidth,r=n.scrollLeft,a=n.clientWidth;if(i>a){var u=[];return r>0&&u.push(e),r+a<i&&u.push(t),o.value=u.join(", "),u.join(", ")}return"transparent transparent"}function r(){n.value&&(o.value=i(n.value.$el))}return{onChange:r,gradientStyle:o,scroll:n}}});const _c=(0,V.Z)(Sc,[["render",Cc]]);var Dc=_c,Oc=(0,I.aZ)({name:"Toolbar",components:{ToolbarButton:bc,ToolbarSeparator:Zc,ScrollFade:Dc},data:function(){return{faScrewdriverWrench:O.eDR,faFolderOpen:fc.cC_,faFile:fc.gMD,faSave:fc.r6l,faScissors:O.EQg,faCopy:fc.kZ_,faPaste:fc.O4,faObjectGroup:fc.tU8,faObjectUngroup:fc.B7S,faRotateBackward:O.ptP,faRotateForward:O.fbl,faReply:O.Lh7,faShare:O.zBy,faMicrochip:O.zvy,faBan:O.gPx,faArrowsRotate:O.T80,faBug:O.QLU,faForwardStep:O.Jwg,faWaveSquare:O.fQK}},props:{store:{type:Function,required:!0}},setup:function(e){var t=nu(),n=e.store(),o=(0,I.Fl)((function(){return n.simulation.circuit.isComplete()}));return{rootStore:t,documentStore:n,isComplete:o}}});const Pc=(0,V.Z)(Oc,[["render",pc]]);var kc=Pc;function Mc(e,t,n,o,i,r){var a=(0,I.up)("toolbox-item"),u=(0,I.up)("toolbox-layout");return(0,I.wg)(),(0,I.j4)(u,{"is-open":e.isOpen},(0,I.Nv)({_:2},[(0,I.Ko)(e.factories,(function(t,n){return{name:n,fn:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(t,(function(t,n){return(0,I.wg)(),(0,I.j4)(a,{factory:t,key:n,label:n,zoom:e.zoom,onDrop:e.onDrop},null,8,["factory","label","zoom","onDrop"])})),128))]}))}}))]),1032,["is-open"])}var Bc={class:"toolbox-item__parent"},Ec={class:"toolbox-item__label"};function zc(e,t,n,o,i,r){var a=(0,I.up)("circuit-component"),u=(0,I.up)("resizable"),s=(0,I.up)("draggable");return(0,I.wg)(),(0,I.j4)(s,{class:"toolbox-item",tabindex:0,onTouchhold:e.onDragStart,onDrag:e.onDrag,onDragEnd:e.onDragEnd,onClick:t[2]||(t[2]=function(t){return e.$emit("drop",e.factory)}),"allow-touch-drag":e.isDragging},{default:(0,I.w5)((function(){return[(0,I._)("div",Bc,[(0,I.Wm)(u,{class:"toolbox-item__preview",ref:"preview",onResize:t[1]||(t[1]=function(t){return e.onSizeChanged(t,"preview")})},{default:(0,I.w5)((function(){return[(0,I.Wm)(u,{class:"toolbox-item__inner",ref:"selectable",style:(0,Z.j5)({zoom:e.zoom}),onResize:t[0]||(t[0]=function(t){return e.onSizeChanged(t,"selectable")})},{default:(0,I.w5)((function(){return[(0,I.Wm)(a,{type:e.item.type,subtype:e.item.subtype,ports:e.ports,properties:e.item.properties},null,8,["type","subtype","ports","properties"])]})),_:1},8,["style"])]})),_:1},512)]),(0,I._)("div",Ec,(0,Z.zw)(e.item.name||e.item.subtype),1)]})),_:1},8,["onTouchhold","onDrag","onDragEnd","allow-touch-drag"])}var Nc=(0,I.aZ)({name:"ToolboxItem",components:{CircuitComponent:ri,Draggable:zt,Resizable:Mt},emits:{drop:function(e,t){return!0}},props:{factory:{type:Function,required:!0},zoom:{type:Number,default:1}},setup:function(e,t){var n=t.emit,o=(0,P.iH)(),i=(0,P.iH)(!1),r=(0,P.iH)(1),a=e.factory(),u=a.item,s=a.ports,c={selectable:new DOMRect,preview:new DOMRect},l=null;function d(e,t){c[t]=e;var n=c.selectable,o=c.preview,i=Math.max(n.width/o.width,n.height/o.height);r.value=Math.min(1/i,1)}function p(){var t,n=c.selectable;l=null===(t=o.value)||void 0===t?void 0:t.$el.cloneNode(!0),l.style.position="absolute",l.style["zoom"]="".concat(e.zoom),l.style.width="".concat(n.width,"px"),l.style.height="".concat(n.height,"px"),i.value=!0,navigator.vibrate(20)}function f(t){var n=t.x,o=t.y;if(!l)return p();document.body.contains(l)||document.body.appendChild(l);var i=l.getBoundingClientRect(),r=i.width,a=i.height;l.style.left="".concat((n-r/2*e.zoom)/e.zoom,"px"),l.style.top="".concat((o-a/2*e.zoom)/e.zoom,"px")}function m(t){l&&(l.remove(),l=null,i.value=!1,n("drop",e.factory,t))}return{onDragStart:p,onDrag:f,onDragEnd:m,onSizeChanged:d,item:u,ports:s,zoom:r,selectable:o,isDragging:i}}});const jc=(0,V.Z)(Nc,[["render",zc]]);var Tc=jc,Fc=["onClick"];function Lc(e,t,n,o,i,r){var a=(0,I.up)("scroll-fade");return(0,I.wg)(),(0,I.iD)("div",{ref:"toolbox",class:(0,Z.C_)(["toolbox-layout",{"toolbox-layout--open":e.isOpen}]),style:(0,Z.j5)({height:"".concat(e.height,"px")})},[(0,I.Wm)(a,{class:"toolbox-layout__categories","hide-scrollbar":!0},{default:(0,I.w5)((function(){return[((0,I.wg)(!0),(0,I.iD)(I.HY,null,(0,I.Ko)(e.categories,(function(t){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["toolbox-layout__badge",{"toolbox-layout__badge--active":t===e.selected}]),key:t,onClick:function(n){return e.select(t)}},(0,Z.zw)(t),11,Fc)})),128))]})),_:1}),(0,I.Wm)(a,{class:"toolbox-layout__items"},{default:(0,I.w5)((function(){return[(0,I.WI)(e.$slots,e.selected)]})),_:3})],6)}var Wc=(0,I.aZ)({name:"Toolbox",components:{ScrollFade:Dc},props:{isOpen:{type:Boolean,default:!1}},setup:function(e,t){var n=t.slots,o=(0,P.iH)(null),i=(0,P.iH)(null),r=(0,I.Fl)((function(){return Object.keys(n)})),a=(0,I.Fl)((function(){var t;return e.isOpen?null===(t=i.value)||void 0===t?void 0:t.scrollHeight:0}));function u(e){o.value=e}return u(r.value[0]),{categories:r,selected:o,select:u,height:a,toolbox:i}}});const Vc=(0,V.Z)(Wc,[["render",Lc]]);var Ac,Rc,Uc,qc,Hc=Vc,$c=function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=(0,fe.Z)(),r=[Sr(i,(0,fe.Z)(),ge.Right,ie.Output,"Output Port")],a=be(i,he.InputNode,e,t,n,r);return a.properties=(0,le.Z)((0,le.Z)((0,le.Z)({},a.properties),o),{},{startValue:{label:"Start value",value:-1,type:"number",options:{True:1,"Hi-Z":0,False:-1}}}),{item:a,ports:r}},Gc=$c,Yc=function(){return Gc(ye.Clock,60,60,{interval:{label:"Interval",value:1e3,type:"number",min:100,step:100}})},Kc=Yc;n(3290);function Xc(){var e=[],t=Array(4).fill("").reduce((function(t,n,o){var i=(0,fe.Z)(),r=(0,fe.Z)(),a=Sr(r,i,ge.Left,ie.Output,"Input Port ".concat(o+1)),u=be(r,he.InputNode,ye.Switch,0,0,[a]);return e.push(a),{connections:{},groups:{},items:(0,le.Z)((0,le.Z)({},t.items),{},(0,De.Z)({},r,u)),ports:(0,le.Z)((0,le.Z)({},t.ports),{},(0,De.Z)({},i,a))}}),{connections:{},ports:{},items:{},groups:{}}),n=we(t,"Digit Display",40,40,ye.DigitDisplay);return{item:n,ports:e}}function Jc(){var e=(0,fe.Z)(),t=[Sr(e,(0,fe.Z)(),ge.Left,ie.Input,"Input Port")],n=be(e,he.OutputNode,ye.Lightbulb,40,40,t);return{item:n,ports:t}}function Qc(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=(0,fe.Z)(),r=Array(o).fill("").map((function(e,t){return Sr(i,(0,fe.Z)(),0,1,"Input Port ".concat(t))})).concat(Sr(i,(0,fe.Z)(),2,0,"Output Port")),a=be(i,he.LogicGate,e,t,n,r);return a.properties=(0,le.Z)((0,le.Z)({},a.properties),{},{inputCount:{label:"Input count",value:o,type:"number",min:o},showInOscilloscope:{label:"Show in oscilloscope",value:!1,type:"boolean"}}),{item:a,ports:r}}var el=(qc={},(0,De.Z)(qc,he.InputNode,(Ac={},(0,De.Z)(Ac,ye.Switch,Gc.bind(void 0,ye.Switch,60,60)),(0,De.Z)(Ac,ye.Clock,Kc),Ac)),(0,De.Z)(qc,he.OutputNode,(Rc={},(0,De.Z)(Rc,ye.Lightbulb,Jc),(0,De.Z)(Rc,ye.DigitDisplay,Xc),Rc)),(0,De.Z)(qc,he.LogicGate,(Uc={},(0,De.Z)(Uc,ye.And,Qc.bind(void 0,ye.And,140,50)),(0,De.Z)(Uc,ye.Nand,Qc.bind(void 0,ye.Nand,140,50)),(0,De.Z)(Uc,ye.Xnor,Qc.bind(void 0,ye.Xnor,140,50)),(0,De.Z)(Uc,ye.Nor,Qc.bind(void 0,ye.Nor,140,50)),(0,De.Z)(Uc,ye.Or,Qc.bind(void 0,ye.Or,140,50)),(0,De.Z)(Uc,ye.Not,Qc.bind(void 0,ye.Not,140,50,1)),Uc)),qc),tl=(0,I.aZ)({name:"Toolbox",components:{ScrollFade:Dc,ToolboxItem:Tc,ToolboxLayout:Hc},props:{store:{type:Function,required:!0},isOpen:{type:Boolean,default:!1}},setup:function(e){var t=e.store(),n=Me(),o=(0,I.Fl)((function(){return t.zoom})),i=(0,I.Fl)((function(){return n.factories}));function r(e,n){t.insertItemAtPosition(e(),n)}return{factories:(0,le.Z)((0,le.Z)({},el),{},(0,De.Z)({},he.IntegratedCircuit,i.value)),zoom:o,onDrop:r}}});const nl=(0,V.Z)(tl,[["render",Mc]]);var ol=nl,il={class:"main-view__top"},rl={class:"main-view__middle"},al={class:"main-view__bottom"};function ul(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["main-view",{"main-view--blurred":e.isBlurred}])},[(0,I._)("div",il,[(0,I.WI)(e.$slots,"top")]),(0,I._)("div",rl,[(0,I.WI)(e.$slots,"middle")]),(0,I._)("div",al,[(0,I.WI)(e.$slots,"bottom")])],2)}var sl=(0,I.aZ)({name:"MainView",props:{isBlurred:{type:Boolean,default:!1}}});const cl=(0,V.Z)(sl,[["render",ul]]);var ll=cl;function dl(e,t,n,o,i,r){var a=(0,I.up)("mobile-popout-menu-item");return(0,I.wg)(),(0,I.j4)(a,{label:"".concat(e.label).concat(e.dirty?"*":""),icon:e.faMicrochip,active:e.active,onClick:t[0]||(t[0]=function(t){return e.$emit("activate")}),onClose:t[1]||(t[1]=function(t){return e.$emit("close")})},null,8,["label","icon","active"])}var pl={class:"mobile-popout-menu-item"},fl={class:"mobile-popout-menu-item__label"};function ml(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",pl,[(0,I.Wm)(a,{icon:e.icon,class:"mobile-popout-menu-item__icon"},null,8,["icon"]),(0,I._)("div",fl,(0,Z.zw)(e.label),1),e.closable?((0,I.wg)(),(0,I.j4)(a,{key:0,icon:e.faClose,class:"mobile-popout-menu-item__icon",onClick:t[0]||(t[0]=function(t){return e.$emit("close")})},null,8,["icon"])):(0,I.kq)("",!0)])}var hl=(0,I.aZ)({components:{Icon:Ue},name:"MobileFileName",emits:{close:function(){return!0}},props:{label:{type:String,required:!0},icon:{type:Object,required:!0},closable:{type:Boolean,default:!0}},setup:function(){return{faClose:O.YIN}}});const vl=(0,V.Z)(hl,[["render",ml]]);var gl=vl,bl=(0,I.aZ)({components:{MobilePopoutMenuItem:gl},name:"MobileDocumentTabItem",emits:{activate:function(){return!0},close:function(){return!0}},props:{label:{type:String,required:!0},dirty:{type:Boolean,default:!1},active:{type:Boolean,default:!1}},setup:function(){return{faMicrochip:O.zvy}}});const yl=(0,V.Z)(bl,[["render",dl]]);var wl=yl,xl={class:"mobile-header"},Il={class:"mobile-header__heading"};function Zl(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",xl,[(0,I._)("div",{class:"mobile-header__button",onClick:t[0]||(t[0]=function(t){return e.$emit("open")})},[(0,I.Wm)(a,{icon:e.faBars},null,8,["icon"])]),(0,I._)("div",Il,[(0,I._)("span",{class:"mobile-header__document-name",onClick:t[1]||(t[1]=function(t){return e.$emit("select")})},(0,Z.zw)(e.documentName),1),e.documentCount>1?((0,I.wg)(),(0,I.iD)("span",{key:0,class:"mobile-header__badge",onClick:t[2]||(t[2]=function(t){return e.$emit("select")})},(0,Z.zw)(e.documentCount),1)):(0,I.kq)("",!0)])])}var Cl=(0,I.aZ)({components:{Icon:Ue},name:"MobileHeader",emits:{select:function(){return!0},open:function(){return!0}},props:{documentName:{type:String,required:!0},documentCount:{type:Number,default:1}},setup:function(){return{faBars:O.xiG,faPlusSquare:fc.CPW}}});const Sl=(0,V.Z)(Cl,[["render",Zl]]);var _l=Sl,Dl={key:0,class:"mobile-popout-menu"},Ol={class:"mobile-popout-menu__content"};function Pl(e,t,n,o,i,r){return(0,I.wg)(),(0,I.j4)(x.uT,{name:"mobile-popout-menu"},{default:(0,I.w5)((function(){return[e.modelValue?((0,I.wg)(),(0,I.iD)("div",Dl,[(0,I._)("div",{class:"mobile-popout-menu__overlay",onClick:t[0]||(t[0]=(0,x.iM)((function(t){return e.$emit("update:modelValue",!1)}),["self"]))},[(0,I._)("div",Ol,[(0,I.WI)(e.$slots,"default")])])])):(0,I.kq)("",!0)]})),_:3})}var kl=(0,I.aZ)({name:"MobilePopoutMenu",props:{modelValue:{type:Boolean,required:!0}}});const Ml=(0,V.Z)(kl,[["render",Pl]]);var Bl=Ml,El={key:0,class:"mobile-pullout"},zl={class:"mobile-pullout__content"};function Nl(e,t,n,o,i,r){return(0,I.wg)(),(0,I.j4)(x.uT,{name:"mobile-pullout"},{default:(0,I.w5)((function(){return[e.modelValue?((0,I.wg)(),(0,I.iD)("div",El,[(0,I._)("div",{class:"mobile-pullout__overlay",onClick:t[0]||(t[0]=function(t){return e.$emit("update:modelValue",!1)})}),(0,I._)("div",zl,[(0,I.WI)(e.$slots,"default")])])):(0,I.kq)("",!0)]})),_:3})}var jl=(0,I.aZ)({name:"MobilePullout",props:{modelValue:{type:Boolean,required:!0}}});const Tl=(0,V.Z)(jl,[["render",Nl]]);var Fl=Tl,Ll={class:"mobile-pullout-heading"},Wl=(0,I._)("img",{src:"logo.svg",class:"mobile-pullout-heading__logo"},null,-1),Vl={class:"mobile-pullout-heading__brand"},Al=(0,I._)("div",{class:"mobile-pullout-heading__title"}," Aristotle ",-1),Rl={class:"mobile-pullout-heading__subtitle"};function Ul(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",Ll,[Wl,(0,I._)("div",Vl,[Al,(0,I._)("div",Rl," v"+(0,Z.zw)(e.version),1)]),(0,I.Wm)(a,{icon:e.faClose,class:"mobile-pullout-heading__close",onClick:t[0]||(t[0]=function(t){return e.$emit("close")})},null,8,["icon"])])}var ql=(0,I.aZ)({name:"MobilePulloutHeading",components:{Icon:Ue},props:{version:{type:String,default:"1.0.0"}},emits:{close:function(){return!0}},setup:function(){return{faClose:O.YIN}}});const Hl=(0,V.Z)(ql,[["render",Ul]]);var $l=Hl,Gl={class:"tab-item__icon"},Yl={class:"tab-item__label"};function Kl(e,t,n,o,i,r){var a=(0,I.up)("icon");return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)([{"tab-item--active":e.active,"tab-item--dirty":e.dirty},"tab-item"]),onMousedown:t[1]||(t[1]=function(t){return e.$emit("activate")}),onTouchstart:t[2]||(t[2]=function(t){return e.$emit("activate")})},[(0,I._)("div",Gl,[(0,I.Wm)(a,{icon:e.faCodeBranch},null,8,["icon"])]),(0,I._)("div",Yl,(0,Z.zw)(e.label)+(0,Z.zw)(e.dirty?"*":""),1),(0,I._)("div",{class:"tab-item__icon tab-item__icon--close",onClick:t[0]||(t[0]=(0,x.iM)((function(t){return e.$emit("close")}),["stop"]))},[(0,I.Wm)(a,{icon:e.faClose},null,8,["icon"])])],34)}var Xl=(0,I.aZ)({name:"TabItem",components:{Icon:Ue},props:{active:{type:Boolean,default:!1},label:{type:String,required:!0},dirty:{type:Boolean,default:!1}},setup:function(){return{faClose:O.YIN,faCodeBranch:O.mh3}}});const Jl=(0,V.Z)(Xl,[["render",Kl]]);var Ql=Jl,ed={class:"tab-host"},td={class:"tab-host__list"};function nd(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",ed,[(0,I._)("div",td,[(0,I.WI)(e.$slots,"tabs")]),(0,I.WI)(e.$slots,"default")])}var od=(0,I.aZ)({name:"TabHost"});const id=(0,V.Z)(od,[["render",nd]]);var rd=id;function ad(e,t,n,o,i,r){return(0,I.wg)(),(0,I.iD)("div",{class:(0,Z.C_)(["theme",{"theme--dark":e.dark}])},[(0,I.WI)(e.$slots,"default")],2)}var ud=(0,I.aZ)({name:"Theme",props:{dark:{type:Boolean,default:!1}}});const sd=(0,V.Z)(ud,[["render",ad]]);var cd=sd;function ld(){var e,t=nu(),n=null!==t.activeDocumentId,o=Object.keys(t.documents),i=null===(e=t.activeDocument)||void 0===e?void 0:e.store(),r=[{label:"&New Circuit",accelerator:"CommandOrControl+N",click:t.newDocument},{type:"separator"},{label:"&Open Circuit",accelerator:"CommandOrControl+O",click:t.selectDocument},{label:"Open &Integrated Circuit",accelerator:"CommandOrControl+Shift+O",click:t.selectDocument},{type:"separator"},{label:"Save",enabled:n,accelerator:"CommandOrControl+S",click:function(){return t.saveActiveDocument()}},{label:"Save As...",enabled:n,accelerator:"CommandOrControl+Shift+S",click:function(){return t.saveActiveDocument(!0)}},{label:"Save All",enabled:n,accelerator:"CommandOrControl+Shift+A",click:function(){return console.log("root store save all")}},{type:"separator"},{label:"Print",enabled:n,accelerator:"CommandOrControl+P",click:function(){return null===i||void 0===i?void 0:i.print()}},{type:"separator"},{label:"Export...",enabled:n,submenu:[{label:"Integrated Circuit",accelerator:"CommandOrControl+Shift+E",click:function(){return console.log("export IC")}},{label:"PNG Image",accelerator:"CommandOrControl+Shift+I",click:function(){return null===i||void 0===i?void 0:i.createImage()}}]},{type:"separator"},{label:"Preferences",submenu:[{label:"Global Preferences",accelerator:"CommandOrControl+,",click:function(){return console.log("global prefs")}},{label:"Document Preferences",accelerator:"CommandOrControl+Shift+,",click:function(){return console.log("doc prefs")}}]}];if(Object.keys(t.documents).length>1){for(var a=[{label:"Previous File",accelerator:"Ctrl+Shift+Tab",click:function(){return t.switchDocument(-1)}},{label:"Next File",accelerator:"Ctrl+Tab",click:function(){return t.switchDocument(1)}},{type:"separator"}],u=function(e){a.push({type:"checkbox",label:t.documents[o[e]].displayName,checked:t.activeDocumentId===o[e],click:function(){return t.activateDocument(o[e])}})},s=0;s<o.length;s++)u(s);r.push({type:"separator"}),r.push({label:"Switch to...",submenu:a})}return r.push({type:"separator"}),r.push({label:"Close Document",accelerator:"CmdOrCtrl+W",enabled:n,click:function(){return t.closeDocument(t.activeDocumentId)}}),r.push({type:"separator"}),r.push({label:"Exit",accelerator:"CmdOrCtrl+Q",click:function(){return window.close()}}),r}function dd(e){for(var t=e(),n=[],o=!1,i=function(e){var i=25*e/100,r=t.zoomLevel===i;o=o||r,n.push({type:"checkbox",checked:r,label:"".concat(100*i,"%"),accelerator:1===i?"CommandOrControl+0":void 0,click:function(){return t.setZoom({zoom:i})}})},r=1;r<=8;r++)i(r);o||n.unshift({type:"checkbox",checked:!0,label:"Custom"});var a=[{label:"&Zoom In",accelerator:"CommandOrControl+=",enabled:t.zoomLevel<2,click:function(){return t.incrementZoom(1)}},{label:"&Zoom Out",accelerator:"CommandOrControl+-",enabled:t.zoomLevel>.1,click:function(){return t.incrementZoom(-1)}},{label:"&Zoom...",submenu:n},{type:"separator"},{label:"&Pan to Center",accelerator:"CommandOrControl+;",click:t.panToCenter},{type:"separator"}];return a.concat(Qt(e))}function pd(){var e=nu();if(e.isDialogOpen)return[{label:"File",submenu:[{label:"Exit"}]}];var t=[{label:"File",submenu:ld()}];return e.activeDocument&&(t.push({label:"Edit",submenu:Jt(e.activeDocument.store)}),t.push({label:"View",submenu:dd(e.activeDocument.store).concat([{type:"separator"},{type:"checkbox",click:e.toggleFullscreen,checked:e.isFullscreen,accelerator:"F11",label:"Fullscreen"}])})),t}var fd=(0,I.aZ)({name:"App",components:{BuilderView:et,Document:Bu,Oscilloscope:Ts,MainView:ll,MobileDocumentTabItem:wl,MobileHeader:_l,MobilePopoutMenu:Bl,MobilePopoutMenuItem:gl,MobilePreferences:ps,MobilePullout:Fl,MobilePulloutHeading:$l,StatusBar:uc,TabItem:Ql,TabHost:rd,Theme:cd,Toolbar:kc,Toolbox:ol},setup:function(){var e=nu(),t=(0,w.Jk)(_r()),n=t.experience,o=(0,w.Jk)(e),i=o.activeDocument,r=o.activeDocumentId,a=o.documents,u=o.hasOpenDocuments,s=o.isFullscreen,c=o.isDialogOpen,l=o.isBuilderOpen,d=o.isToolboxOpen,p=o.isSettingsOpen,f=o.isDocumentSelectOpen,m=(0,P.iH)(!1);function h(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer&&(e.dataTransfer.dropEffect="copy"),m.value=!0}function v(e){return g.apply(this,arguments)}function g(){return g=(0,D.Z)((0,_.Z)().mark((function t(n){var o,i,r;return(0,_.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n.stopPropagation(),n.preventDefault(),i=null===(o=n.dataTransfer)||void 0===o?void 0:o.files,!i){t.next=11;break}r=0;case 5:if(!(r<i.length)){t.next=11;break}return t.next=8,e.openDocumentFromPath(i[r].path);case 8:r++,t.next=5;break;case 11:m.value=!1;case 12:case"end":return t.stop()}}),t)}))),g.apply(this,arguments)}function b(){m.value=!1}function y(e){e.ctrlKey&&"R"===e.key.toUpperCase()&&window.location.reload()}function x(){}return u.value||e.openTestDocuments(),(0,I.m0)((function(){return window.api.setApplicationMenu(pd())})),(0,I.m0)((function(){document.title=e.activeDocument?"".concat(e.activeDocument.displayName," - Aristotle"):"Aristotle"})),window.api.onBeforeClose(e.closeAll),window.api.onOpenFile(e.openDocumentFromPath),(0,I.bv)((function(){document.addEventListener("keydown",y),document.addEventListener("dragover",h),document.addEventListener("dragleave",b),document.addEventListener("drop",v)})),(0,I.Jd)((function(){document.removeEventListener("keydown",y),document.removeEventListener("dragover",h),document.removeEventListener("dragleave",b),document.removeEventListener("drop",v)})),{faFile:O.gMD,activeDocument:i,activeDocumentId:r,documents:a,experience:n,hasOpenDocuments:u,isDropping:m,isFullscreen:s,isDialogOpen:c,isBuilderOpen:l,isToolboxOpen:d,isSettingsOpen:p,isDocumentSelectOpen:f,onContextMenu:x,toggleFullscreen:e.toggleFullscreen,activateDocument:e.activateDocument,closeDocument:e.closeDocument,switchDocument:e.switchDocument,openIntegratedCircuit:e.openIntegratedCircuit}},data:function(){return{horizontal:!1,lastPosition:0,toolboxWidth:20,oscilloscopeHeight:80,isMobile:as}}});const md=(0,V.Z)(fd,[["render",S]]);var hd=md;window.api||(window.api={showContextMenu:function(){},setApplicationMenu:function(){},showOpenFileDialog:function(){return[]},showSaveFileDialog:function(){return""},showMessageBox:function(){return 0},beep:function(){},quit:function(){},copy:function(){},paste:function(){return""},onBeforeClose:function(){},onOpenFile:function(){},openFile:function(){return""},saveFile:function(){},setFullscreen:function(){},getFilePaths:function(){return[]}}),(0,x.ri)(hd).use((0,w.WB)()).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={id:o,loaded:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(l=0;l<e.length;l++){o=e[l][0],i=e[l][1],r=e[l][2];for(var u=!0,s=0;s<o.length;s++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(u=!1,r<a&&(a=r));if(u){e.splice(l--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var l=e.length;l>0&&e[l-1][2]>r;l--)e[l]=e[l-1];e[l]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={826:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],u=o[1],s=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in u)n.o(u,i)&&(n.m[i]=u[i]);if(s)var l=s(n)}for(t&&t(o);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(l)},o=self["webpackChunkaristotle"]=self["webpackChunkaristotle"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(2725)}));o=n.O(o)})();
//# sourceMappingURL=index-legacy.70fe23eb.js.map