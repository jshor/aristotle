(function(e){function t(t){for(var n,c,s=t[0],a=t[1],u=t[2],d=0,p=[];d<s.length;d++)c=s[d],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&p.push(i[c][0]),i[c]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);l&&l(t);while(p.length)p.shift()();return r.push.apply(r,u||[]),o()}function o(){for(var e,t=0;t<r.length;t++){for(var o=r[t],n=!0,s=1;s<o.length;s++){var a=o[s];0!==i[a]&&(n=!1)}n&&(r.splice(t--,1),e=c(c.s=o[0]))}return e}var n={},i={app:0},r=[];function c(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,c),o.l=!0,o.exports}c.m=e,c.c=n,c.d=function(e,t,o){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(c.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(o,n,function(t){return e[t]}.bind(null,n));return o},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/alpha/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],a=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=a;r.push([0,"chunk-vendors"]),o()})({0:function(e,t,o){e.exports=o("cd49")},"01d4":function(e,t,o){},"01f3":function(e,t,o){"use strict";o("ca68")},"08cf":function(e,t,o){},"09bf":function(e,t,o){"use strict";o("23b1")},"12ef":function(e,t,o){},1837:function(e,t,o){"use strict";o("2ed1")},"22ab":function(e,t,o){"use strict";o("f86a")},"23b1":function(e,t,o){},2866:function(e,t,o){},"2a6d":function(e,t,o){"use strict";o("4079")},"2ed1":function(e,t,o){},"2ff2":function(e){e.exports=JSON.parse('{"groups":{},"connections":{"switch1_nor1_conn":{"id":"switch1_nor1_conn","connectionChainId":"switch1_nor1_conn","source":"switchOutputPort1","target":"nor1InputPort1","isSelected":false,"groupId":null,"zIndex":7},"switch2_nor2_conn":{"id":"switch2_nor2_conn","connectionChainId":"switch2_nor2_conn","source":"switchOutputPort2","target":"nor2InputPort1","isSelected":false,"groupId":null,"zIndex":8},"nor1_nor2_conn":{"id":"nor1_nor2_conn","connectionChainId":"nor1_nor2_conn","source":"nor1OutputPort1","target":"nor2InputPort2","isSelected":false,"groupId":null,"zIndex":9},"nor2_nor1_conn":{"id":"nor2_nor1_conn","connectionChainId":"nor2_nor1_conn","source":"nor2OutputPort1","target":"nor1InputPort2","isSelected":false,"groupId":null,"zIndex":10},"nor1_lightbulb1_conn":{"id":"nor1_lightbulb1_conn","connectionChainId":"nor1_lightbulb1_conn","source":"nor1OutputPort1","target":"lightbulbInputPort1","isSelected":false,"groupId":null,"zIndex":11},"nor2_lightbulb2_conn":{"id":"nor2_lightbulb2_conn","connectionChainId":"nor2_lightbulb2_conn","source":"nor2OutputPort1","target":"lightbulbInputPort2","isSelected":false,"groupId":null,"zIndex":12}},"ports":{"nor1InputPort1":{"id":"nor1InputPort1","elementId":"nor1","name":"Input Port 1","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor1InputPort2":{"id":"nor1InputPort2","elementId":"nor1","name":"Input Port 2","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor1OutputPort1":{"id":"nor1OutputPort1","elementId":"nor1","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"nor2InputPort1":{"id":"nor2InputPort1","elementId":"nor2","name":"Input Port 1","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor2InputPort2":{"id":"nor2InputPort2","elementId":"nor2","name":"Input Port 2","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"nor2OutputPort1":{"id":"nor2OutputPort1","elementId":"nor2","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"switchOutputPort1":{"id":"switchOutputPort1","elementId":"switch1","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"switchOutputPort2":{"id":"switchOutputPort2","elementId":"switch2","name":"Output Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":0,"rotation":0,"orientation":2,"value":0,"isFreeport":false},"lightbulbInputPort1":{"id":"lightbulbInputPort1","elementId":"lightbulb1","name":"Input Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false},"lightbulbInputPort2":{"id":"lightbulbInputPort2","elementId":"lightbulb2","name":"Input Port","connectedPortIds":[],"position":{"x":0,"y":0},"type":1,"rotation":0,"orientation":0,"value":0,"isFreeport":false}},"items":{"nor1":{"id":"nor1","type":"LogicGate","subtype":"Nor","portIds":["nor1InputPort1","nor1InputPort2","nor1OutputPort1"],"position":{"x":300,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"inputCount":{"label":"Input count","value":2,"type":"number","min":2},"showInOscilloscope":{"label":"Show in oscilloscope","value":true,"type":"boolean"}},"groupId":null,"zIndex":1,"width":100,"height":150},"nor2":{"id":"nor2","type":"LogicGate","subtype":"Nor","portIds":["nor2InputPort2","nor2InputPort1","nor2OutputPort1"],"position":{"x":300,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"inputCount":{"label":"Input count","value":2,"type":"number","min":2},"showInOscilloscope":{"label":"Show in oscilloscope","value":true,"type":"boolean"}},"groupId":null,"zIndex":2,"width":120,"height":51},"switch1":{"id":"switch1","type":"InputNode","subtype":"Clock","portIds":["switchOutputPort1"],"position":{"x":100,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"startValue":{"label":"Start value","value":-1,"type":"number","options":{"True":1,"Hi-Z":0,"False":-1}},"showInOscilloscope":{"label":"Show in oscilloscope","value":true,"type":"boolean"}},"groupId":null,"zIndex":3,"width":40,"height":40},"switch2":{"id":"switch2","type":"InputNode","subtype":"Switch","portIds":["switchOutputPort2"],"position":{"x":100,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"startValue":{"label":"Start value","value":1,"type":"number","options":{"True":1,"Hi-Z":0,"False":-1}},"showInOscilloscope":{"label":"Show in oscilloscope","value":true,"type":"boolean"}},"groupId":null,"zIndex":4,"width":40,"height":40},"lightbulb1":{"id":"lightbulb1","type":"OutputNode","subtype":"Lightbulb","portIds":["lightbulbInputPort1"],"position":{"x":700,"y":300},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"showInOscilloscope":{"label":"Show in oscilloscope","value":true,"type":"boolean"}},"groupId":null,"zIndex":5,"width":40,"height":40},"lightbulb2":{"id":"lightbulb2","type":"OutputNode","subtype":"Lightbulb","portIds":["lightbulbInputPort2"],"position":{"x":700,"y":500},"boundingBox":{"left":0,"top":0,"right":0,"bottom":0},"rotation":0,"isSelected":false,"properties":{"name":{"label":"Name","value":"","type":"text"},"showInOscilloscope":{"label":"Show in oscilloscope","value":true,"type":"boolean"}},"groupId":null,"zIndex":6,"width":40,"height":40}}}')},"33f2":function(e,t,o){"use strict";o("01d4")},4079:function(e,t,o){},"44b9":function(e,t,o){},"4bfd":function(e,t,o){"use strict";o("44b9")},"52da":function(e,t,o){},"54f0":function(e,t,o){},"66d8":function(e,t,o){},"69e6":function(e,t,o){},"6ab2":function(e,t,o){},7155:function(e,t,o){"use strict";o("ed41")},"78ec":function(e,t,o){"use strict";o("52da")},"7b95":function(e,t,o){"use strict";o("e0ca")},"80b1":function(e,t,o){},"83e9":function(e,t,o){"use strict";o("9a23")},9001:function(e,t,o){"use strict";o("ab0b")},"943a":function(e,t,o){"use strict";o("12ef")},"9a23":function(e,t,o){},"9ba4":function(e,t,o){},"9f2c":function(e,t,o){},a0f4:function(e,t,o){"use strict";o("80b1")},a540:function(e,t,o){"use strict";o("69e6")},ab0b:function(e,t,o){},acf4:function(e,t,o){"use strict";o("d00e")},bbf5:function(e,t,o){},bdf0:function(e,t,o){"use strict";o("08cf")},c280:function(e,t,o){},c36a:function(e,t,o){"use strict";o("9ba4")},c9ce:function(e,t,o){"use strict";o("bbf5")},ca68:function(e,t,o){},caf7:function(e,t,o){"use strict";o("c280")},cd49:function(e,t,o){"use strict";o.r(t);o("9531"),o("26d3"),o("2007"),o("41ab");var n=o("e187"),i=o("4430"),r=(o("ef1f"),o("0d9f"),{key:0,class:"app"}),c={class:"app__toolbar"},s={class:"app__bottom",ref:"bottom"},a={key:1};function u(e,t,o,n,u,l){var d=Object(i["resolveComponent"])("toolbar"),p=Object(i["resolveComponent"])("toolbox"),f=Object(i["resolveComponent"])("tab-item"),h=Object(i["resolveComponent"])("document"),m=Object(i["resolveComponent"])("tab-host"),b=Object(i["resolveComponent"])("oscilloscope"),v=Object(i["resolveComponent"])("resizable-panes");return e.hasOpenDocuments?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",r,[Object(i["createElementVNode"])("div",c,[e.activeDocumentId&&e.activeDocument?(Object(i["openBlock"])(),Object(i["createBlock"])(d,{key:e.activeDocumentId,store:e.activeDocument.store},null,8,["store"])):Object(i["createCommentVNode"])("",!0)]),Object(i["createElementVNode"])("div",s,[Object(i["createVNode"])(v,{modelValue:e.toolboxWidth,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.toolboxWidth=t})},{first:Object(i["withCtx"])((function(){return[e.activeDocument?(Object(i["openBlock"])(),Object(i["createBlock"])(p,{key:0,store:e.activeDocument.store},null,8,["store"])):Object(i["createCommentVNode"])("",!0)]})),second:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(v,{modelValue:e.documentHeight,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.documentHeight=t}),"is-vertical":!0},{first:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(m,null,{tabs:Object(i["withCtx"])((function(){return[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.documents,(function(t,o){return Object(i["openBlock"])(),Object(i["createBlock"])(f,{key:o,label:t.displayName,active:e.activeDocumentId===o,dirty:t.store().isDirty,onActivate:function(t){return e.activateDocument(o.toString())},onClose:function(t){return e.closeDocument(o.toString())}},null,8,["label","active","dirty","onActivate","onClose"])})),128))]})),default:Object(i["withCtx"])((function(){return[e.activeDocumentId&&e.activeDocument?(Object(i["openBlock"])(),Object(i["createBlock"])(h,{key:e.activeDocumentId,store:e.activeDocument.store,onSwitch:e.switchDocument,onOpenIntegratedCircuit:e.openIntegratedCircuit},null,8,["store","onSwitch","onOpenIntegratedCircuit"])):Object(i["createCommentVNode"])("",!0)]})),_:1})]})),second:Object(i["withCtx"])((function(){return[e.activeDocumentId&&e.activeDocument?(Object(i["openBlock"])(),Object(i["createBlock"])(b,{key:e.activeDocumentId,store:e.activeDocument.store},null,8,["store"])):Object(i["createCommentVNode"])("",!0)]})),_:1},8,["modelValue"])]})),_:1},8,["modelValue"])],512)])):(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",a," no documents open "))}o("868d");function l(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("item"),a=Object(i["resolveComponent"])("connection"),u=Object(i["resolveComponent"])("group"),l=Object(i["resolveComponent"])("editor");return Object(i["openBlock"])(),Object(i["createBlock"])(l,{ref:"editor",zoom:e.store.zoomLevel,"grid-size":e.gridSize,tabindex:0,offset:{x:e.store.canvas.left,y:e.store.canvas.top},width:e.store.canvas.right-e.store.canvas.left,height:e.store.canvas.bottom-e.store.canvas.top,onPan:e.store.panTo,onDeselect:e.store.deselectAll,onSelection:e.store.createSelection,onZoom:e.store.setZoom,onOnContextMenu:e.onContextMenu,onMousedown:e.store.deselectAll},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",{tabindex:0,onFocus:t[0]||(t[0]=function(t){return e.store.recycleSelection(!1)})},null,32),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.store.baseItems,(function(t,o){return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[t.type?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{store:e.storeDefinition,id:t.id,key:t.id,"port-ids":t.portIds,type:t.type,subtype:t.subtype,name:t.name,position:t.position,rotation:t.rotation,"group-id":t.groupId,"bounding-box":t.boundingBox,properties:t.properties,"is-selected":t.isSelected,flash:e.store.isDebugging&&e.store.isCircuitEvaluated,"z-index":t.zIndex+1e3,onSelect:function(o){return e.selectItem(t.id)},onDeselect:function(o){return e.deselectItem(t.id)},onContextmenu:e.onContextMenu,onOpenIntegratedCircuit:function(o){return e.$emit("openIntegratedCircuit",t)}},null,8,["store","id","port-ids","type","subtype","name","position","rotation","group-id","bounding-box","properties","is-selected","flash","z-index","onSelect","onDeselect","onContextmenu","onOpenIntegratedCircuit"])):(Object(i["openBlock"])(),Object(i["createBlock"])(a,{store:e.storeDefinition,id:t.id,key:o,"source-id":t.source,"target-id":t.target,"group-id":t.groupId,"connection-chain-id":t.connectionChainId,"is-selected":t.isSelected,"is-preview":e.store.connectionPreviewId===t.id,flash:e.store.isDebugging&&e.store.isCircuitEvaluated,"z-index":t.zIndex,onSelect:function(o){return e.selectItem(t.id)},onDeselect:function(o){return e.deselectItem(t.id)},onContextmenu:e.onContextMenu},null,8,["store","id","source-id","target-id","group-id","connection-chain-id","is-selected","is-preview","flash","z-index","onSelect","onDeselect","onContextmenu"]))],64)})),256)),Object(i["createElementVNode"])("div",{tabindex:0,onFocus:t[1]||(t[1]=function(t){return e.store.recycleSelection(!0)})},null,32),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.store.groups,(function(t){return Object(i["openBlock"])(),Object(i["createBlock"])(u,{key:t.id,id:t.id,"bounding-box":t.boundingBox,"is-selected":t.isSelected,"z-index":e.store.zIndex,zoom:e.store.zoom},null,8,["id","bounding-box","is-selected","z-index","zoom"])})),128))]})),_:1},8,["zoom","grid-size","offset","width","height","onPan","onDeselect","onSelection","onZoom","onOnContextMenu","onMousedown"])}var d=o("cf28"),p=o("0b38"),f=o("ce37"),h=o("2da1");function m(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("selector");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{onMousewheel:t[0]||(t[0]=function(){return e.mousewheel&&e.mousewheel.apply(e,arguments)}),onMousedown:t[1]||(t[1]=Object(i["withModifiers"])((function(){return e.startPanning&&e.startPanning.apply(e,arguments)}),["right"])),class:"editor"},[Object(i["createElementVNode"])("div",{style:Object(i["normalizeStyle"])(e.style),class:"editor__grid"},[Object(i["createVNode"])(s,{zoom:e.zoom,onSelectionStart:e.selectionStart,onSelectionEnd:e.selectionEnd},null,8,["zoom","onSelectionStart","onSelectionEnd"]),Object(i["renderSlot"])(e.$slots,"default")],4)],32)}o("e94e"),o("d86f");function b(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{onMousedown:t[0]||(t[0]=Object(i["withModifiers"])((function(){return e.mousedown&&e.mousedown.apply(e,arguments)}),["left","self"])),class:"selector"},[e.selection?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,style:Object(i["normalizeStyle"])(e.style),class:"selector__selection"},null,4)):Object(i["createCommentVNode"])("",!0)],32)}var v=Object(i["defineComponent"])({name:"Selector",props:{zoom:{type:Number,default:1}},data:function(){return{selection:!1,start:{x:0,y:0},end:{x:0,y:0}}},computed:{style:function(){var e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),o=Math.abs(this.start.x-this.end.x),n=Math.abs(this.start.y-this.end.y);return{left:"".concat(e,"px"),top:"".concat(t,"px"),width:"".concat(o,"px"),height:"".concat(n,"px")}}},mounted:function(){window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)},destroy:function(){window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)},methods:{getPosition:function(e){var t=this.$el.getBoundingClientRect(),o=t.top,n=t.left,i=(e.x-n)/this.zoom,r=(e.y-o)/this.zoom;return{x:i,y:r}},mousedown:function(e){var t=this.getPosition(e);this.selection=!0,this.start=t,this.end=t,this.$emit("selectionStart",e)},mousemove:function(e){this.selection&&(this.end=this.getPosition(e))},mouseup:function(){this.selection&&(this.createSelection(),this.selection=!1,this.start.x=0,this.start.y=0,this.end.x=0,this.end.y=0)},createSelection:function(){var e=Math.min(this.start.x,this.end.x),t=Math.min(this.start.y,this.end.y),o=Math.abs(this.start.x-this.end.x),n=Math.abs(this.start.y-this.end.y);this.$emit("selectionEnd",{left:e,top:t,bottom:n+t,right:e+o})}}}),g=(o("a540"),o("ee5a")),O=o.n(g);const y=O()(v,[["render",b]]);var j=y,I=Object(i["defineComponent"])({name:"Editor",components:{Selector:j},props:{zoom:{type:Number,default:1},gridSize:{type:Number,default:0},width:{type:Number,default:0},height:{type:Number,default:0},offset:{type:Object,default:function(){return{x:0,y:0}}}},computed:{style:function(){return{backgroundSize:"".concat(this.gridSize,"px ").concat(this.gridSize,"px"),transform:"scale(".concat(this.zoom,")"),left:"".concat(this.offset.x,"px"),top:"".concat(this.offset.y,"px"),width:"".concat(this.width,"px"),height:"".concat(this.height,"px")}}},data:function(){return{panStartPosition:{x:0,y:0},originalMousePosition:{y:0,x:0},panning:!1,preventContextMenu:!1}},mounted:function(){window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)},destroy:function(){window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)},methods:{startPanning:function(e){this.panning=!0,this.panStartPosition={x:e.x-this.offset.x,y:e.y-this.offset.y},this.originalMousePosition={x:e.x,y:e.y},e.preventDefault(),e.stopPropagation()},mousemove:function(e){this.panning&&this.$emit("pan",{x:Math.min(e.x-this.panStartPosition.x,0),y:Math.min(e.y-this.panStartPosition.y,0)})},mouseup:function(e){if(2===e.button){var t=Math.abs(this.originalMousePosition.x-e.x),o=Math.abs(this.originalMousePosition.y-e.y);t+o<2&&this.$emit("onContextMenu",e)}this.panning=!1},mousewheel:function(e){if(e.shiftKey){var t=e.deltaY<0?1:-1,o=this.zoom+t/10;this.$emit("zoom",{zoom:o,point:e})}},selectionStart:function(e){e.shiftKey||this.$emit("deselect")},selectionEnd:function(e){this.$emit("selection",e)}}});o("fa39");const x=O()(I,[["render",m]]);var w=x;function C(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("draggable");return Object(i["openBlock"])(),Object(i["createBlock"])(s,{tabindex:-1,position:{x:e.boundingBox.left,y:e.boundingBox.top},style:Object(i["normalizeStyle"])({width:"".concat(e.boundingBox.right-e.boundingBox.left,"px"),height:"".concat(e.boundingBox.bottom-e.boundingBox.top,"px"),zIndex:e.zIndex}),zoom:e.zoom,"bounding-box":e.boundingBox},{default:Object(i["withCtx"])((function(){return[Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])([{"group--is-selected":e.isSelected},"group"])},null,2)]})),_:1},8,["position","style","zoom","bounding-box"])}function k(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{style:Object(i["normalizeStyle"])(e.style),onMousedown:t[0]||(t[0]=function(){return e.mousedown&&e.mousedown.apply(e,arguments)})},[Object(i["renderSlot"])(e.$slots,"default")],36)}o("fa8c");var S=Object(i["defineComponent"])({name:"Draggable",props:{position:{type:Object,default:function(){return{x:0,y:0}}},zoom:{type:Number,default:1},snapMode:{type:String,default:"outer"},snapBoundaries:{type:Array,default:function(){return[]}},boundingBox:{type:Object,default:function(){return{left:0,top:0,right:0,bottom:0}}},isDraggable:{type:Boolean,default:!0},forceDragging:{type:Boolean,default:!1},lockVisual:{type:Boolean,default:!1}},data:function(){return{mousePosition:{x:0,y:0},apparentPosition:{x:0,y:0},truePosition:{x:0,y:0},realPositionFromStore:{x:0,y:0},box:{left:0,top:0,right:0,bottom:0},isDragging:!1,hasEmittedDrag:!1,isRadialSnap:!1}},watch:{position:{handler:function(e){this.realPositionFromStore=e,this.isDragging||(this.truePosition=e)},immediate:!0},boundingBox:{handler:function(){this.isDragging||(this.apparentPosition=this.truePosition)}},forceDragging:{handler:function(e){if(e){var t=this.$el.getBoundingClientRect(),o=t.top,n=t.left;this.initDragging(n,o)}}}},computed:{style:function(){return this.lockVisual?{}:{position:"absolute",pointerEvents:"none",left:"".concat(this.apparentPosition.x||this.truePosition.x,"px"),top:"".concat(this.apparentPosition.y||this.truePosition.y,"px")}}},mounted:function(){document.addEventListener("mousemove",this.mousemove),document.addEventListener("mouseup",this.mouseup),document.addEventListener("keydown",this.keydown)},beforeUnmount:function(){document.removeEventListener("mousemove",this.mousemove),document.removeEventListener("mouseup",this.mouseup),document.removeEventListener("keydown",this.keydown)},methods:{initDragging:function(e,t){this.isDraggable&&(this.mousePosition={x:e,y:t},this.box={left:this.boundingBox.left,top:this.boundingBox.top,right:this.boundingBox.right,bottom:this.boundingBox.bottom},this.apparentPosition={x:this.truePosition.x,y:this.truePosition.y},this.isDragging=!0,this.hasEmittedDrag=!1)},getScaledDelta:function(e){return{x:(e.x-this.mousePosition.x)/this.zoom,y:(e.y-this.mousePosition.y)/this.zoom}},keydown:function(e){"Z"===e.key.toUpperCase()&&e.ctrlKey&&this.isDragging&&(this.isDragging=!1,this.truePosition=this.realPositionFromStore)},mousedown:function(e){e.preventDefault(),e.stopPropagation(),this.initDragging(e.clientX,e.clientY)},mousemove:function(e){var t=this;if(this.isDragging&&this.isDraggable){this.hasEmittedDrag||(this.hasEmittedDrag=!0,this.$emit("dragStart"));var o=this.getScaledDelta(e),n=15;this.box={left:this.box.left+o.x,top:this.box.top+o.y,right:this.box.right+o.x,bottom:this.box.bottom+o.y};var i=this.box,r=this.snapBoundaries,c={x:0,y:0},s=null;r.forEach((function(e){if("radius"===t.snapMode){var o=Math.sqrt(Math.pow(e.left-i.left,2)+Math.pow(e.top-i.top,2))<=n;if(o)return c.x=e.left-i.left,c.y=e.top-i.top,void(s={x:e.left,y:e.top})}var r=Math.abs(e.top-i.bottom)<=n,a=Math.abs(e.bottom-i.top)<=n,u=Math.abs(e.left-i.right)<=n,l=Math.abs(e.right-i.left)<=n;(i.left<=e.right&&i.left>=e.left||i.right>=e.left&&i.right<=e.right||i.left<=e.left&&i.right>=e.right)&&(r&&(c.y=e.top-i.bottom),a&&(c.y=e.bottom-i.top)),(i.top<=e.bottom&&i.top>=e.top||i.bottom>=e.top&&i.bottom<=e.bottom||i.top<=e.top&&i.bottom>=e.bottom)&&(u&&(c.x=e.left-i.right),l&&(c.x=e.right-i.left))})),this.mousePosition={x:e.clientX,y:e.clientY},this.apparentPosition={x:this.truePosition.x+o.x+c.x,y:this.truePosition.y+o.y+c.y},this.truePosition={x:this.truePosition.x+o.x,y:this.truePosition.y+o.y},s?this.$emit("drag",s):this.$emit("drag",{x:this.apparentPosition.x,y:this.apparentPosition.y})}},mouseup:function(e){this.isDraggable&&(this.isDragging=!1,this.truePosition=this.realPositionFromStore,this.$emit("dragEnd",{delta:this.getScaledDelta(e)}))}}});const B=O()(S,[["render",k]]);var P=B,E=Object(i["defineComponent"])({name:"Group",components:{Draggable:P},props:{boundingBox:{type:Object,required:!0},id:{type:String,required:!0},isSelected:{type:Boolean,default:!1},zIndex:{type:Number,default:0},zoom:{type:Number,default:1}}});o("e4ce");const N=O()(E,[["render",C]]);var D=N;function _(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("wire");return Object(i["openBlock"])(),Object(i["createBlock"])(s,{style:Object(i["normalizeStyle"])({zIndex:e.zIndex}),source:e.source,target:e.target,"top-left":e.topLeft,"bottom-right":e.bottomRight,"is-selected":e.isSelected,"aria-selected":e.isSelected,"is-preview":e.isPreview,flash:e.flash,label:"TODO",tabindex:0,onMousedown:e.onMouseDown,onFocus:e.onFocus,ref:"root","data-test":"wire"},null,8,["style","source","target","top-left","bottom-right","is-selected","aria-selected","is-preview","flash","onMousedown","onFocus"])}var V=o("ec26"),M=["width","height"],z=["transform","d"],T=["transform","d"],F=["transform","d"],L=["transform","d"];function R(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("svg",{class:Object(i["normalizeClass"])(["wire",{"wire--selected":e.isSelected,"wire--flash":e.flash,"wire--preview":e.isPreview}]),width:e.wire.width,height:e.wire.height,style:Object(i["normalizeStyle"])({top:"".concat(e.topLeft.y+e.wire.minY,"px"),left:"".concat(e.topLeft.x+e.wire.minX,"px")})},[Object(i["createElementVNode"])("title",null,Object(i["toDisplayString"])(e.label),1),Object(i["createElementVNode"])("path",{class:"wire__outline",fill:"none",transform:"translate(".concat(Math.abs(e.wire.minX),", ").concat(Math.abs(e.wire.minY),")"),d:e.wire.path},null,8,z),Object(i["createElementVNode"])("path",{class:Object(i["normalizeClass"])(["wire__display",{"wire__display--on":1===e.source.value,"wire__display--off":-1===e.source.value}]),fill:"none",transform:"translate(".concat(Math.abs(e.wire.minX),", ").concat(Math.abs(e.wire.minY),")"),d:e.wire.path},null,10,T),e.isAnimated?(Object(i["openBlock"])(),Object(i["createElementBlock"])("path",{key:0,class:"wire__animation",fill:"none",transform:"translate(".concat(Math.abs(e.wire.minX),", ").concat(Math.abs(e.wire.minY),")"),d:e.wire.path},null,8,F)):Object(i["createCommentVNode"])("",!0),Object(i["createElementVNode"])("path",{class:"wire__clickable",fill:"none",transform:"translate(".concat(Math.abs(e.wire.minX),", ").concat(Math.abs(e.wire.minY),")"),d:e.wire.path},null,8,L)],14,M)}var A=o("7c6c");o("11fd"),o("ef14"),o("cfce");function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e+t%4+4)%4}var U=15;function $(e,t){var o=e.position,n=t.position,i=X(o,n),r=i.start,c=i.end;if(r.x===c.x||r.y===c.y||c.x<=1&&r.x<=1||c.y<=1&&r.y<=1)return G(r,c);var s=W(e,o,n),a=W(t,o,n);return Z(s,a,r,c)}function G(e,t){return{path:"M ".concat(e.x,",").concat(e.y," L ").concat(t.x,",").concat(t.y),width:Math.abs(e.x-t.x)+U,height:Math.abs(e.y-t.y)+U,minX:-U/2,minY:-U/2}}function K(e,t,o){switch(e){case 0:return t.y>o.y?2:0;case 1:return t.x<o.x?3:1;case 2:return t.y>o.y?0:2;case 3:return t.x<o.x?1:3;default:return K(q(e),t,o)}}function W(e,t,o){var n=q(e.orientation+e.rotation-1);return e.isFreeport&&(n=K(n,t,o),e.rotation%4!==1&&e.rotation%4!==2||(n=q(n-2))),n}function X(e,t){return e.x<=t.x?e.y<=t.y?{start:{x:0,y:0},end:{x:Math.floor(t.x-e.x),y:Math.floor(t.y-e.y)}}:{start:{x:0,y:Math.floor(e.y-t.y)},end:{x:Math.floor(t.x-e.x),y:0}}:e.y<=t.y?{start:{x:Math.floor(e.x-t.x),y:0},end:{x:0,y:Math.floor(t.y-e.y)}}:{start:{x:Math.floor(e.x-t.x),y:Math.floor(e.y-t.y)},end:{x:0,y:0}}}function Z(e,t,o,n){var i=o.x,r=o.y,c=n.x,s=n.y,a=Math.max(Math.abs(i-c)/2,10),u=Math.max(Math.abs(r-s)/2,10),l=[i,i+a,i,i-a][e].toFixed(3),d=[r-u,r,r+u,r][e].toFixed(3),p=[c,c+a,c,c-a][t].toFixed(3),f=[s-u,s,s+u,s][t].toFixed(3),h=["M",i.toFixed(3),r.toFixed(3),"C",l,d,p,f,c.toFixed(3),s.toFixed(3)].join(" "),m=function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return t.map((function(e){return parseInt(e,10)}))},b=Math.min.apply(Math,Object(A["a"])(m(i,l,p,c)))-U/2,v=Math.max.apply(Math,Object(A["a"])(m(i,l,p,c)))+U/2,g=Math.min.apply(Math,Object(A["a"])(m(r,d,f,s)))-U/2,O=Math.max.apply(Math,Object(A["a"])(m(r,d,f,s)))+U/2,y=v-b+U,j=O-g+U;return{width:y,height:j,path:h,minX:b,minY:g}}var Y=Object(i["defineComponent"])({name:"Wire",props:{isAnimated:{type:Boolean,default:!1},source:{type:Object,required:!0},target:{type:Object,required:!0},topLeft:{type:Object,required:!0},bottomRight:{type:Object,required:!0},label:{type:String,default:""},isPreview:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1},flash:{type:Boolean,default:!1}},computed:{wire:function(){return $(this.source,this.target)}}});o("caf7");const H=O()(Y,[["render",R]]);var J=H,Q=Object(i["defineComponent"])({name:"Connection",components:{Wire:J},props:{sourceId:{type:String,required:!0},targetId:{type:String,required:!0},groupId:{type:String,default:null},connectionChainId:{type:String,default:null},isSelected:{type:Boolean,default:!1},isPreview:{type:Boolean,default:!1},id:{type:String,required:!0},zIndex:{type:Number,default:0},flash:{type:Boolean,default:!1},store:{type:Function,required:!0}},watch:{isSelected:function(e){e&&this.$el.focus()}},setup:function(e,t){var o=t.emit,n=e.store(),r=Object(i["ref"])(),c=Object(i["computed"])((function(){return n.ports[e.sourceId]})),s=Object(i["computed"])((function(){return n.ports[e.targetId]})),a=Object(i["computed"])((function(){var e=c.value.position,t=s.value.position,o=Math.min(e.x,t.x),n=Math.min(e.y,t.y);return{x:o,y:n}})),u=Object(i["computed"])((function(){var e=c.value.position,t=s.value.position,o=Math.max(e.x,t.x),n=Math.max(e.y,t.y);return{x:o,y:n}}));Object(i["onMounted"])((function(){window.addEventListener("mousemove",m),window.addEventListener("mouseup",b)})),Object(i["onBeforeUnmount"])((function(){window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",b)}));var l={itemId:"",inputPortId:"",outputPortId:"",connectionChainId:e.id,value:0,sourceId:"",targetId:"",position:{}},d={x:0,y:0},p=!1,f=!1;function h(t){null===e.groupId&&(p=!1,f=!0,d={x:t.clientX,y:t.clientY},o("select"))}function m(t){var o;if((d.x!==t.clientX||d.y!==t.clientY)&&f&&(d={x:t.clientX,y:t.clientY},!p&&null!==(o=r.value)&&void 0!==o&&o.$el)){var i=r.value.$el.getBoundingClientRect(),u=i.top,h=i.left,m={x:t.clientX-h,y:t.clientY-u},b={x:a.value.x+m.x,y:a.value.y+m.y};l={itemId:Object(V["a"])(),inputPortId:Object(V["a"])(),outputPortId:Object(V["a"])(),connectionChainId:e.connectionChainId,value:c.value.value,sourceId:c.value.id,targetId:s.value.id,position:b},n.createFreeport(l),n.setSnapBoundaries(l.itemId),p=!0}}function b(){f&&(f=!1,o("select"))}function v(){e.isSelected||o("select")}return{root:r,topLeft:a,bottomRight:u,onMouseDown:h,onFocus:v,source:c,target:s}}});const ee=O()(Q,[["render",_]]);var te=ee;function oe(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("properties"),a=Object(i["resolveComponent"])("freeport"),u=Object(i["resolveComponent"])("integrated-circuit"),l=Object(i["resolveComponent"])("input-switch"),d=Object(i["resolveComponent"])("lightbulb"),p=Object(i["resolveComponent"])("logic-gate"),f=Object(i["resolveComponent"])("port-item"),h=Object(i["resolveComponent"])("port-set"),m=Object(i["resolveComponent"])("selectable"),b=Object(i["resolveComponent"])("draggable");return Object(i["openBlock"])(),Object(i["createBlock"])(b,{position:e.position,zoom:e.store.zoomLevel,style:Object(i["normalizeStyle"])({transform:"rotate(".concat(90*e.rotation,"deg)"),outline:"none",zIndex:e.zIndex}),"snap-mode":e.type===e.ItemType.Freeport?"radius":"outer","snap-boundaries":e.store.snapBoundaries,"bounding-box":e.boundingBox,"force-dragging":e.forceDragging,"aria-label":e.name,title:e.name,tabindex:0,onDragStart:e.onDragStart,onDrag:e.onDrag,onDragEnd:e.onDragEnd,onFocus:e.onFocus,onBlur:e.onBlur,onKeydown:Object(i["withKeys"])(e.onEscapeKey,["esc"]),onMousedown:Object(i["withModifiers"])(e.focus,["stop"]),ref:"selectable","data-test":"selectable"},{default:Object(i["withCtx"])((function(){return[e.isPropertiesEnabled?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:0,tabindex:0,properties:e.properties,id:e.id,onUpdate:e.store.setProperties,onFocus:e.onPropertiesFocus,onBlur:e.onBlur,"aria-label":"Properties dialog","data-test":"properties"},null,8,["properties","id","onUpdate","onFocus","onBlur"])):Object(i["createCommentVNode"])("",!0),Object(i["createVNode"])(m,{"is-selected":e.isSelected,flash:e.flash},{default:Object(i["withCtx"])((function(){var o,n,r;return[e.type===e.ItemType.Freeport?(Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:0})):e.type===e.ItemType.IntegratedCircuit?(Object(i["openBlock"])(),Object(i["createBlock"])(u,{key:1,"port-list":e.portList,onDblclick:t[0]||(t[0]=function(t){return e.$emit("openIntegratedCircuit")})},null,8,["port-list"])):e.type===e.ItemType.InputNode?(Object(i["openBlock"])(),Object(i["createBlock"])(l,{key:2,value:null===(o=e.ports[0])||void 0===o?void 0:o.value,onToggle:t[1]||(t[1]=function(t){return e.store.setPortValue({id:e.ports[0].id,value:t})})},null,8,["value"])):e.type===e.ItemType.OutputNode?(Object(i["openBlock"])(),Object(i["createBlock"])(d,{key:3,value:null===(n=e.ports[0])||void 0===n?void 0:n.value,type:e.subtype},null,8,["value","type"])):(Object(i["openBlock"])(),Object(i["createBlock"])(p,{key:4,"input-count":null===(r=e.properties.inputCount)||void 0===r?void 0:r.value,type:e.subtype},null,8,["input-count","type"])),Object(i["createVNode"])(h,null,Object(i["createSlots"])({_:2},[Object(i["renderList"])(e.portList,(function(t,o){return{name:o,fn:Object(i["withCtx"])((function(){return[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t,(function(t){return Object(i["openBlock"])(),Object(i["createBlock"])(f,{tabindex:0,store:e.rawStore,id:t.id,key:t.id,type:t.type,"is-freeport":t.isFreeport,position:t.position,orientation:t.orientation+e.rotation,"connected-port-ids":t.connectedPortIds,rotation:e.rotation,onKeypress:Object(i["withKeys"])(e.onEscapeKey,["esc"]),onFocus:function(o){return e.onPortFocus(t.id)},onBlur:function(o){return e.onPortBlur(t.id,o)},onDeselect:e.focus,"data-test":"port-item"},null,8,["store","id","type","is-freeport","position","orientation","connected-port-ids","rotation","onKeypress","onFocus","onBlur","onDeselect"])})),128))]}))}}))]),1024)]})),_:1},8,["is-selected","flash"])]})),_:1},8,["position","zoom","style","snap-mode","snap-boundaries","bounding-box","force-dragging","aria-label","title","onDragStart","onDrag","onDragEnd","onFocus","onBlur","onKeydown","onMousedown"])}o("f8a5");var ne=Object(i["createElementVNode"])("div",{class:"logic-gate__wire"},null,-1),ie={key:0,class:"logic-gate__wires--multiwire"},re=Object(i["createElementVNode"])("div",{class:"logic-gate__wires-divider"},[Object(i["createElementVNode"])("div",{class:"logic-gate__wire"})],-1);function ce(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{style:Object(i["normalizeStyle"])({height:"".concat(25*e.inputCount,"px")}),class:"logic-gate"},[Object(i["createElementVNode"])("div",{style:Object(i["normalizeStyle"])({width:(e.inputCount,"100%")}),class:"logic-gate__wires"},[Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])([{"logic-gate__wires-divider--multiwire":e.inputCount>2},"logic-gate__wires-divider"])},[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.inputCount-1,(function(e){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:e,class:"logic-gate__wire"})})),128)),ne],2),e.inputCount>2?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",ie)):Object(i["createCommentVNode"])("",!0),re],4),(Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(e.component),{class:"logic-gate__component"}))],4)}var se={class:"and",width:"100",height:"50",viewBox:"0 -1 100 50"},ae=Object(i["createElementVNode"])("path",{transform:"translate(20, 0)",class:"and__element",d:"M 0 0 V 48 H 24 C 36 48 48 36 48 24 C 48 12 36 0 24 0 Z"},null,-1),ue={key:0,cx:"73",cy:"24",r:"5",class:"and__negation"};function le(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("svg",se,[ae,e.isNegated?(Object(i["openBlock"])(),Object(i["createElementBlock"])("circle",ue)):Object(i["createCommentVNode"])("",!0)])}var de=Object(i["defineComponent"])({name:"And",props:{isNegated:{type:Boolean,default:!1}}});o("01f3");const pe=O()(de,[["render",le]]);var fe=pe,he={width:"100",height:"50",viewBox:"0 -1 100 50",class:"or"},me=Object(i["createElementVNode"])("path",{transform:"translate(10, 0)",fill:"#fff",d:"M 0 0 C 12 12 12 36 0 48 H 0 H 24 C 48 48 60 36 72 24 C 60 12 48 0 24 0 Z",class:"or__element"},null,-1),be={key:0,fill:"none",d:"M 0 0 C 12 12 12 36 0 48",class:"or__tail"},ve={key:1,cx:"88",cy:"24",r:"5",class:"or__negation"};function ge(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("svg",he,[me,e.isXor?(Object(i["openBlock"])(),Object(i["createElementBlock"])("path",be)):Object(i["createCommentVNode"])("",!0),e.isNegated?(Object(i["openBlock"])(),Object(i["createElementBlock"])("circle",ve)):Object(i["createCommentVNode"])("",!0)])}var Oe=Object(i["defineComponent"])({name:"Or",props:{isNegated:{type:Boolean,default:!1},isXor:{type:Boolean,default:!1}}});o("22ab");const ye=O()(Oe,[["render",ge]]);var je=ye;function Ie(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("or");return Object(i["openBlock"])(),Object(i["createBlock"])(s,{"is-negated":!0})}var xe=Object(i["defineComponent"])({name:"Nor",components:{Or:je}});const we=O()(xe,[["render",Ie]]);var Ce=we;function ke(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("and");return Object(i["openBlock"])(),Object(i["createBlock"])(s,{"is-negated":!0})}var Se=Object(i["defineComponent"])({name:"Nand",components:{And:fe}});const Be=O()(Se,[["render",ke]]);var Pe=Be;function Ee(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("or");return Object(i["openBlock"])(),Object(i["createBlock"])(s,{"is-negated":!0,"is-xor":!0})}var Ne=Object(i["defineComponent"])({name:"Xnor",components:{Or:je}});const De=O()(Ne,[["render",Ee]]);var _e=De;function Ve(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("or");return Object(i["openBlock"])(),Object(i["createBlock"])(s,{"is-xor":!0})}var Me=Object(i["defineComponent"])({name:"Xor",components:{Or:je}});const ze=O()(Me,[["render",Ve]]);var Te,Fe=ze;(function(e){e["None"]="None",e["Switch"]="Switch",e["PushButton"]="PushButton",e["Clock"]="Clock",e["Lightbulb"]="Lightbulb",e["Buffer"]="Buffer",e["Not"]="Not",e["Tristate"]="Tristate",e["And"]="And",e["Or"]="Or",e["Nand"]="Nand",e["Nor"]="Nor",e["Xnor"]="Xnor",e["Xor"]="Xor"})(Te||(Te={}));var Le=Te,Re=Object(i["defineComponent"])({name:"LogicGate",props:{inputCount:{type:Number,default:2},type:{subtype:String,required:!0}},computed:{component:function(){switch(this.type){case Le.And:return fe;case Le.Nand:return Pe;case Le.Xnor:return _e;case Le.Xor:return Fe;case Le.Nor:return Ce;default:return je}}}});o("ef02");const Ae=O()(Re,[["render",ce]]);var qe=Ae,Ue={class:"input-switch"},$e={key:0},Ge={key:1},Ke={key:2};function We(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ue,[Object(i["createElementVNode"])("button",{type:"button",class:Object(i["normalizeClass"])(["input-switch__flipper",{"input-switch__flipper--on":1===e.model,"input-switch__flipper--off":-1===e.model,"input-switch__flipper--high-z":0===e.model}]),tabindex:0,onMousedown:t[0]||(t[0]=Object(i["withModifiers"])((function(){return e.click&&e.click.apply(e,arguments)}),["stop"]))},[1===e.model?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",$e,"ON")):-1===e.model?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Ge,"OFF")):(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",Ke,"?"))],34)])}var Xe=Object(i["defineComponent"])({name:"InputSwitch",props:{value:{type:Number,default:0}},data:function(){return{model:0}},watch:{value:{handler:function(e){this.model=e},immediate:!0}},methods:{click:function(e){return e.preventDefault(),e.stopPropagation(),this.model=1===this.model?-1:1,this.$emit("toggle",this.model),!1}}});o("e220");const Ze=O()(Xe,[["render",We]]);var Ye=Ze,He={class:"integrated-circuit"},Je={class:"integrated-circuit__wires"},Qe={class:"integrated-circuit__wires-divider"},et={class:"integrated-circuit__wires-divider"},tt=Object(i["createElementVNode"])("div",{class:"integrated-circuit__box"},[Object(i["createElementVNode"])("div",{class:"integrated-circuit__box-inner"}," R-S Flip-Flop ")],-1);function ot(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",He,[Object(i["createElementVNode"])("div",Je,[Object(i["createElementVNode"])("div",Qe,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.portList.left,(function(e){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:e.id,class:"integrated-circuit__wire"})})),128))]),Object(i["createElementVNode"])("div",et,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.portList.right,(function(e){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:e.id,class:"integrated-circuit__wire"})})),128))])]),tt])}var nt=Object(i["defineComponent"])({name:"IntegratedCircuit",props:{portList:{type:Object,required:!0}}});o("f96c");const it=O()(nt,[["render",ot]]);var rt=it;function ct(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(["lightbulb",{"lightbulb--on":1===e.value,"lightbulb--high-z":0===e.value}])},null,2)}var st=Object(i["defineComponent"])({name:"Lightbulb",props:{value:{type:Number,default:0}}});o("7155");const at=O()(st,[["render",ct]]);var ut=at,lt={class:"freeport"};function dt(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",lt)}var pt=Object(i["defineComponent"])({name:"Freeport"});o("78ec");const ft=O()(pt,[["render",dt]]);var ht=ft;function mt(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(["port-handle",{"port-handle--active":e.active}]),onMousedown:t[0]||(t[0]=function(){return e.mousedown&&e.mousedown.apply(e,arguments)}),onMouseup:t[1]||(t[1]=function(){return e.mouseup&&e.mouseup.apply(e,arguments)})},null,34)}var bt=Object(i["defineComponent"])({name:"PortHandle",props:{active:{type:Boolean,default:!1},type:{type:Number,default:0}},methods:{mousedown:function(e){this.$emit("mousedown",e)},mouseup:function(e){this.$emit("mouseup",e)}}});o("7b95");const vt=O()(bt,[["render",mt]]);var gt=vt,Ot={class:"port-set"},yt={class:"port-set__container port-set__container--left"},jt={class:"port-set__container port-set__container--top"},It={class:"port-set__container port-set__container--right"},xt={class:"port-set__container port-set__container--bottom"};function wt(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ot,[Object(i["createElementVNode"])("div",yt,[Object(i["renderSlot"])(e.$slots,"left")]),Object(i["createElementVNode"])("div",jt,[Object(i["renderSlot"])(e.$slots,"top")]),Object(i["createElementVNode"])("div",It,[Object(i["renderSlot"])(e.$slots,"right")]),Object(i["createElementVNode"])("div",xt,[Object(i["renderSlot"])(e.$slots,"bottom")])])}var Ct=Object(i["defineComponent"])({name:"PortSet"});o("acf4");const kt=O()(Ct,[["render",wt]]);var St=kt,Bt=["aria-hidden"],Pt={class:"properties__heading",role:"title"},Et=Object(i["createTextVNode"])(" Properties "),Nt=["for"],Dt=["onUpdate:modelValue","id"],_t=["value"],Vt=["onUpdate:modelValue","id"],Mt=["onUpdate:modelValue","min","max","type","id"];function zt(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{onKeydown:[t[1]||(t[1]=Object(i["withKeys"])((function(t){return e.isOpen=!0}),["space"])),t[2]||(t[2]=Object(i["withKeys"])((function(){return e.onKeyDown&&e.onKeyDown.apply(e,arguments)}),["esc"]))],onClick:t[3]||(t[3]=function(t){return e.isOpen=!0}),onContextmenu:t[4]||(t[4]=function(){return e.stopPropagation&&e.stopPropagation.apply(e,arguments)}),onMousedown:t[5]||(t[5]=function(){return e.stopPropagation&&e.stopPropagation.apply(e,arguments)}),onMouseup:t[6]||(t[6]=function(){return e.stopPropagation&&e.stopPropagation.apply(e,arguments)}),class:"properties"},[e.isOpen?(Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:0,class:"properties__dialog","aria-hidden":!e.isOpen},[Object(i["createElementVNode"])("div",Pt,[Et,Object(i["createElementVNode"])("span",{onClick:t[0]||(t[0]=function(t){return e.isOpen=!1}),class:"properties__close"}," Ã— ")]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.model,(function(t,o){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:o,class:"properties__entry"},[Object(i["createElementVNode"])("label",{for:"".concat(e.id,"_").concat(o)},Object(i["toDisplayString"])(t.label),9,Nt),t.options?Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("select",{key:0,"onUpdate:modelValue":function(e){return t.value=e},id:"".concat(e.id,"_").concat(o),class:"properties__input"},[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t.options,(function(e,t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("option",{key:t,value:e},Object(i["toDisplayString"])(t),9,_t)})),128))],8,Dt)),[[i["vModelSelect"],t.value]]):"boolean"===t.type?Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("input",{key:1,"onUpdate:modelValue":function(e){return t.value=e},id:"".concat(e.id,"_").concat(o),type:"checkbox",class:"properties__input"},null,8,Vt)),[[i["vModelCheckbox"],t.value]]):Object(i["withDirectives"])((Object(i["openBlock"])(),Object(i["createElementBlock"])("input",{key:2,"onUpdate:modelValue":function(e){return t.value=e},min:t.min,max:t.max,type:t.type,id:"".concat(e.id,"_").concat(o),class:"properties__input"},null,8,Mt)),[[i["vModelDynamic"],t.value]])])})),128))],8,Bt)):Object(i["createCommentVNode"])("",!0)],32)}var Tt=o("9ec3"),Ft=Object(i["defineComponent"])({name:"Properties",props:{properties:{type:Object,default:function(){return{}}},id:{type:String,default:""}},emits:["update"],data:function(){return{model:{},isOpen:!1}},watch:{properties:{handler:function(e){this.model=Object(Tt["cloneDeep"])(e)},deep:!0,immediate:!0},model:{handler:function(e){this.$emit("update",{id:this.id,properties:e})},deep:!0}},methods:{onKeyDown:function(e){this.isOpen=!1,e.preventDefault(),this.$el.focus()},stopPropagation:function(e){e.stopPropagation()}}});o("83e9");const Lt=O()(Ft,[["render",zt]]);var Rt=Lt;function At(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(["selectable",{"selectable--selected":e.isSelected,"selectable--flash":e.flash}])},[Object(i["renderSlot"])(e.$slots,"default")],2)}var qt=Object(i["defineComponent"])({name:"Selectable",props:{flash:{type:Boolean,default:!1},isSelected:{type:Boolean,default:!1}}});o("4bfd");const Ut=O()(qt,[["render",At]]);var $t=Ut;o("8d0d"),o("c78b");function Gt(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("port-handle"),a=Object(i["resolveComponent"])("draggable"),u=Object(i["resolveComponent"])("port-pivot");return Object(i["openBlock"])(),Object(i["createBlock"])(u,{rotation:e.rotation,onBlur:e.onBlur,onKeydown:[Object(i["withKeys"])(e.onEscapeKey,["esc"]),t[0]||(t[0]=Object(i["withKeys"])((function(t){return e.store.cycleConnectionPreviews(e.id)}),["space"])),Object(i["withKeys"])(e.store.commitPreviewedConnection,["enter"])],onContextmenu:t[1]||(t[1]=function(t){return e.store.setActivePortId(e.id)})},{default:Object(i["withCtx"])((function(){return[e.isFreeport?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:1,type:e.type,active:e.store.activePortId===e.id||e.store.connectablePortIds.includes(e.id)},null,8,["type","active"])):(Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:0,"snap-boundaries":e.store.snapBoundaries,zoom:e.store.zoomLevel,"bounding-box":{left:e.position.x,top:e.position.y,right:e.position.x,bottom:e.position.y},"lock-visual":!0,"snap-mode":"radius",onDragStart:e.dragStart,onDragEnd:e.dragEnd},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(s,{type:e.type,active:e.store.activePortId===e.id||e.store.connectablePortIds.includes(e.id)},null,8,["type","active"])]})),_:1},8,["snap-boundaries","zoom","bounding-box","onDragStart","onDragEnd"]))]})),_:1},8,["rotation","onBlur","onKeydown"])}function Kt(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"port-pivot",style:Object(i["normalizeStyle"])({transform:"rotate(-".concat(90*e.rotation,"deg)")}),onKeydown:t[0]||(t[0]=Object(i["withKeys"])((function(t){return e.$emit("connect")}),["space"]))},[Object(i["renderSlot"])(e.$slots,"default")],36)}var Wt=Object(i["defineComponent"])({name:"PortPivot",props:{rotation:{type:Number,default:0}}});o("bdf0");const Xt=O()(Wt,[["render",Kt]]);var Zt,Yt=Xt;(function(e){e[e["Output"]=0]="Output",e[e["Input"]=1]="Input"})(Zt||(Zt={}));var Ht=Zt,Jt=Object(i["defineComponent"])({name:"PortItem",components:{Draggable:P,PortHandle:gt,PortPivot:Yt},props:{id:{type:String,default:""},rotation:{type:Number,default:0},position:{type:Object,default:function(){return{x:0,y:0}}},isFreeport:{type:Boolean,default:!1},type:{type:Number,default:0},orientation:{type:Number,default:0},connectedPortIds:{type:Object,default:[]},store:{type:Function,required:!0}},setup:function(e,t){var o=t.emit,n=e.store(),i={},r=!1;function c(e){e.preventDefault(),e.stopPropagation(),o("deselect",e)}function s(){n.unsetConnectionPreview(),n.cachedState=null}function a(){r=!0,i={itemId:Object(V["a"])(),position:e.position},e.type===Ht.Input?(i.outputPortId=Object(V["a"])(),i.targetId=e.id,i.portType=0):(i.inputPortId=Object(V["a"])(),i.sourceId=e.id,i.portType=1),n.createFreeport(i),n.setConnectablePortIds({portId:e.id,isDragging:!0})}function u(){r&&(r=!1,e.type===Ht.Output?n.connectFreeport({portId:i.inputPortId,sourceId:e.id}):n.connectFreeport({portId:i.outputPortId,targetId:e.id}))}return{store:n,isDragging:r,onEscapeKey:c,onBlur:s,dragStart:a,dragEnd:u,PortType:Ht}}});const Qt=O()(Jt,[["render",Gt]]);var eo,to=Qt;(function(e){e["Buffer"]="Buffer",e["CircuitNode"]="CircuitNode",e["Freeport"]="Freeport",e["InputNode"]="InputNode",e["IntegratedCircuit"]="IntegratedCircuit",e["LogicGate"]="LogicGate",e["OutputNode"]="OutputNode"})(eo||(eo={}));var oo=eo,no=Object(i["defineComponent"])({name:"Item",components:{Draggable:P,LogicGate:qe,Freeport:ht,InputSwitch:Ye,IntegratedCircuit:rt,Lightbulb:ut,PortHandle:gt,PortSet:St,PortItem:to,Properties:Rt,Selectable:$t},props:{boundingBox:{type:Object,default:function(){return{left:0,top:0,right:0,bottom:0}}},rotation:{type:Number,default:0},zIndex:{type:Number,default:1},isSelected:{type:Boolean,default:!1},type:{type:String,required:!0},subtype:{type:String,required:!0},position:{type:Object,required:!0},name:{type:String,default:"Node"},portIds:{type:Array,default:function(){return[]}},properties:{type:Object,default:function(){return{}}},groupId:{type:String,default:null},id:{type:String,required:!0},flash:{type:Boolean,default:!1},store:{type:Function,required:!0}},setup:function(e,t){var o=t.emit,n=e.store(),r=Object(i["ref"])(),c=Object(i["ref"])(!1),s=!1,a=!1,u=Object(i["computed"])((function(){return e.portIds.map((function(e){return n.ports[e]}))})),l=Object(i["computed"])((function(){var e=["left","top","right","bottom"];return u.value.reduce((function(t,o){return Object(p["a"])(Object(p["a"])({},t),{},Object(f["a"])({},e[o.orientation],[].concat(Object(A["a"])(t[e[o.orientation]]),[o])))}),e.reduce((function(e,t){return Object(p["a"])(Object(p["a"])({},e),{},Object(f["a"])({},t,[]))}),{left:[],top:[],right:[],bottom:[]}))})),m=Object(i["computed"])((function(){return e.isSelected&&s&&Object.keys(e.properties).length>0}));function b(){var e;null===(e=r.value)||void 0===e||e.$el.focus(),s=!0}function v(){n.setSnapBoundaries(e.id)}function g(t){a||(a=!0,n.cacheState()),n.setSelectionPosition({id:e.id,position:t})}function O(){a&&(n.commitCachedState(),a=!1)}function y(e){var t,o;document.activeElement===(null===(t=r.value)||void 0===t?void 0:t.$el)?null===(o=r.value)||void 0===o||o.$el.blur():e.preventDefault()}function j(e){var t;null!==(t=r.value)&&void 0!==t&&t.$el.contains(e.relatedTarget)||(s=!1)}function I(){e.isSelected||o("select"),s=!0}function x(){n.setActivePortId(null),s=!0}function w(e){I(),n.setActivePortId(e)}function C(e,t){n.activePortId===e&&n.setActivePortId(null),j(t)}function k(t){var o=Object(d["a"])(t,1),i=o[0];n.setItemSize({id:e.id,rect:i.contentRect})}var S=new h["a"](k);return Object(i["onMounted"])((function(){r.value&&S.observe(r.value.$el),n.activeFreeportId===e.id&&(c.value=!0,n.activeFreeportId=null,a=!0),n.setProperties({id:e.id,properties:e.properties})})),{selectable:r,store:n,ports:u,rawStore:e.store,portList:l,forceDragging:c,isPropertiesEnabled:m,focus:b,onDragStart:v,onDrag:g,onDragEnd:O,onEscapeKey:y,onBlur:j,onFocus:I,onPropertiesFocus:x,onPortFocus:w,onPortBlur:C,onSizeChanged:k,ItemSubtype:Le,ItemType:oo}},watch:{isSelected:function(e){e&&this.$el.focus()}}});const io=O()(no,[["render",oe]]);var ro=io,co=o("42c2"),so=o("f5f2"),ao=o("30c6"),uo=(o("df26"),o("a0d5")),lo=o.n(uo),po=o("f528");function fo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=[{label:"&Undo",enabled:e.canUndo,accelerator:"CommandOrControl+Z",click:e.undo},{type:"separator"},{role:"cut",enabled:e.hasSelection,click:function(){return console.log("cut")}},{label:"Copy",enabled:e.hasSelection,accelerator:"CommandOrControl+C",click:e.copy},{label:"Paste",accelerator:"CommandOrControl+V",click:e.paste},{label:"Delete",accelerator:"Delete",enabled:e.hasSelection,click:e.deleteSelection},{type:"separator"},{role:"selectAll",click:e.selectAll}];return e.selectedItemIds.length>0&&(o.push({type:"separator"}),o.push({label:"&Rotate",submenu:[{label:"Rotate 90Â° &CW",click:function(){return e.rotate(1)}},{label:"Rotate 90Â° CC&W",click:function(){return e.rotate(-1)}}]})),e.hasSelection&&(o.push({type:"separator"}),o.push({label:"&Bring to Front",submenu:[{label:"&Bring to Front",click:function(){return e.setZIndex(e.zIndex)}},{label:"Bring &Forward",click:function(){return e.incrementZIndex(1)}}]}),o.push({label:"&Send to Back",submenu:[{label:"&Send to Back",click:function(){return e.setZIndex(e.zIndex)}},{label:"Send &Backward",click:function(){return e.incrementZIndex(-1)}}]})),e.canGroup&&o.push({label:"&Group",submenu:[{label:"&Group"},{label:"&Ungroup",enabled:e.canUngroup}]}),t.length>0&&(o.push({type:"separator"}),o=o.concat(t)),1===e.selectedItemIds.length&&(o.push({type:"separator"}),o.push({label:"&Item Properties"})),e.activePortId&&(o.push({type:"separator"}),o.push({type:"checkbox",label:"Show in &Oscilloscope",checked:!0})),o}function ho(e){var t=null!==e.activeDocumentId;return[{label:"&New Circuit",accelerator:"CommandOrControl+N",click:e.newDocument},{type:"separator"},{label:"&Open Circuit",accelerator:"CommandOrControl+O",click:e.selectDocument},{label:"Open &Integrated Circuit",accelerator:"CommandOrControl+Shift+O",click:e.selectDocument},{type:"separator"},{label:"Save",enabled:t,accelerator:"CommandOrControl+S",click:e.saveActiveDocument},{label:"Save As...",enabled:t,accelerator:"CommandOrControl+Shift+S",click:function(){return e.saveActiveDocument(!0)}},{label:"Save All",enabled:t,accelerator:"CommandOrControl+Shift+A",click:function(){return console.log("root store save all")}},{type:"separator"},{label:"Export",enabled:t,submenu:[{label:"Integrated Circuit",accelerator:"CommandOrControl+Shift+E",click:function(){return console.log("export IC")}}]},{type:"separator"},{label:"Preferences",submenu:[{label:"Global Preferences",accelerator:"CommandOrControl+,",click:function(){return console.log("global prefs")}},{label:"Document Preferences",accelerator:"CommandOrControl+Shift+,",click:function(){return console.log("doc prefs")}}]},{type:"separator"},{label:"Exit",click:function(){return window.close()}}]}function mo(e){var t=[{label:"File",submenu:ho(e)}];return e.activeDocument&&t.push({label:"Edit",submenu:fo(e.activeDocument.store())}),t}var bo=function(){function e(){Object(so["a"])(this,e)}return Object(ao["a"])(e,null,[{key:"copy",value:function(e){window.require&&(this.clipboard=e)}},{key:"paste",value:function(){if(window.require)return this.clipboard}},{key:"setApplicationMenu",value:function(e){if(window.require){var t=window.require("@electron/remote"),o=t.Menu,n=o.buildFromTemplate(mo(e));o.setApplicationMenu(n)}}},{key:"showContextMenu",value:function(e){if(window.require){var t=window.require("@electron/remote"),o=t.Menu,n=o.buildFromTemplate(e);n.popup()}}},{key:"beep",value:function(){if(window.require){var e=window.require("@electron/remote"),t=e.shell;t.beep()}}},{key:"openModal",value:function(){var e=Object(co["a"])(regeneratorRuntime.mark((function e(){var t,o,n,i,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]?r[0]:"https://aristotle.dev",window.require){e.next=3;break}return e.abrupt("return");case 3:o=window.require("@electron/remote"),n=o.getCurrentWindow(),i=new o.BrowserWindow({autoHideMenuBar:!0,minimizable:!1,maximizable:!1,modal:!0,show:!1,parent:n}),i.loadURL(t),i.webContents.on("did-finish-load",(function(){return i.show()})),i.setMenu(null);case 9:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"showOpenFileDialog",value:function(e){if(window.require){var t=window.require("@electron/remote"),o=t.dialog,n=t.app,i=lo.a.resolve(n.getPath("desktop"));return o.showOpenDialogSync({defaultPath:i,filters:e})||[]}}},{key:"showSaveFileDialog",value:function(e,t){if(window.require){var o=window.require("@electron/remote"),n=o.dialog,i=o.app,r=lo.a.resolve(i.getPath("desktop"),t);return n.showSaveDialogSync({defaultPath:r,filters:e})}}},{key:"showMessageBox",value:function(e){var t=e.message,o=e.type,n=void 0===o?"warning":o,i=e.buttons,r=void 0===i?["OK"]:i,c=e.title,s=void 0===c?"Aristotle":c;if(!window.require)return r.length-1;var a=window.require("@electron/remote");return a.dialog.showMessageBoxSync(a.getCurrentWindow(),{type:n,buttons:r,title:s,message:t})}},{key:"on",value:function(e,t){this.emitter.on(e,t)}},{key:"onBeforeUnload",value:function(){return!window.require||this.canCloseWindow}},{key:"assignQuitter",value:function(){var e=this;if(window.require){var t=window.require("@electron/remote");t.getCurrentWindow().on("close",(function(o){console.log("E: ",o),e.canCloseWindow?t.app.quit():e.emitter.emit("close")}))}}},{key:"quit",value:function(){this.canCloseWindow=!0,window.close()}}]),e}();bo.canCloseWindow=!1,bo.emitter=new po["TinyEmitter"],bo.clipboard=null,window.onbeforeunload=bo.onBeforeUnload;var vo=bo;function go(e){return[{label:"&Grid",submenu:[{label:"&Show grid"},{type:"separator"},{label:"Snap to &grid"},{label:"Snap to &elements"}]}]}function Oo(e){return fo(e,go(e).concat({type:"separator"}))}var yo=Object(i["defineComponent"])({name:"Document",components:{Group:D,Editor:w,Connection:te,Item:ro},props:{store:{type:Function,required:!0}},setup:function(e,t){var o=t.emit,n=e.store(),r=Object(i["ref"])(),c=1,s={};function a(e){switch(s[e.key]=!0,e.key){case"Escape":return n.deselectAll();case"v":case"V":if(s.Control)return n.paste(),void e.preventDefault();case"c":case"C":if(s.Control)return n.copy(),void e.preventDefault();case"a":case"A":if(s.Control)return n.selectAll(),void e.preventDefault();case"r":case"R":if(s.Control)return window.location.reload(),void e.preventDefault();default:return b(e)}}function u(e){s[e.key]=!1,c=1}function l(e){vo.showContextMenu(Oo(n)),e.preventDefault(),e.stopPropagation()}function m(e){var t=e.id,i=e.ports;o("openIntegratedCircuit",{items:Object(f["a"])({},t,n.items[t]),ports:i.reduce((function(e,t){return Object(p["a"])(Object(p["a"])({},e),{},Object(f["a"])({},t.id,t))}),{})})}function b(e){var t=function(){switch(e.key){case"ArrowLeft":return{x:-1,y:0};case"ArrowUp":return{x:0,y:-1};case"ArrowRight":return{x:1,y:0};case"ArrowDown":return{x:0,y:1}}}();if(t){var o=Math.min(c,10);n.moveSelectionPosition({x:t.x*o,y:t.y*o}),c*=1.05}}function v(){s={}}function g(e){s.Control||n.deselectAll(),n.setSelectionState({id:e,value:!0})}function O(e){s.Control||n.setSelectionState({id:e,value:!1})}function y(e){var t=Object(d["a"])(e,1),o=t[0];n.setViewerSize(o.target.getBoundingClientRect())}Object(i["onMounted"])((function(){document.addEventListener("keydown",a),document.addEventListener("keyup",u),window.addEventListener("blur",v)})),Object(i["onBeforeUnmount"])((function(){document.removeEventListener("keydown",a),document.removeEventListener("keyup",u),window.removeEventListener("blur",v)}));var j=new h["a"](y);return Object(i["onMounted"])((function(){r.value&&j.observe(r.value.$el)})),{store:n,editor:r,storeDefinition:e.store,onKeyDown:a,onKeyUp:u,onContextMenu:l,onOpenIntegratedCircuit:m,clearKeys:v,selectItem:g,deselectItem:O,gridSize:20}}});const jo=O()(yo,[["render",l]]);var Io=jo,xo={class:"toolbar"},wo={class:"toolbar__left"},Co=Object(i["createTextVNode"])("Undo"),ko=Object(i["createTextVNode"])("Redo"),So=Object(i["createTextVNode"])("Rotate 90Â° CCW"),Bo=Object(i["createTextVNode"])("Rotate 90Â° CW"),Po=Object(i["createTextVNode"])("Group"),Eo=Object(i["createTextVNode"])("Ungroup"),No=Object(i["createTextVNode"])("Delete selection"),Do=Object(i["createTextVNode"])("Build IC"),_o={class:"toolbar__right"};function Vo(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("toolbar-button"),a=Object(i["resolveComponent"])("toolbar-separator");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",xo,[Object(i["createElementVNode"])("div",wo,[Object(i["createVNode"])(s,{icon:e.faFolderOpen},null,8,["icon"]),Object(i["createVNode"])(s,{icon:e.faFile},null,8,["icon"]),Object(i["createVNode"])(s,{icon:e.faSave},null,8,["icon"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{onClick:e.store.undo,disabled:!e.store.canUndo,icon:e.faReply},{default:Object(i["withCtx"])((function(){return[Co]})),_:1},8,["onClick","disabled","icon"]),Object(i["createVNode"])(s,{onClick:e.store.redo,disabled:!e.store.canRedo,icon:e.faShare},{default:Object(i["withCtx"])((function(){return[ko]})),_:1},8,["onClick","disabled","icon"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{onClick:t[0]||(t[0]=function(t){return e.store.rotate(-1)}),disabled:!e.store.hasSelectedItems,icon:e.faRotateBackward},{default:Object(i["withCtx"])((function(){return[So]})),_:1},8,["disabled","icon"]),Object(i["createVNode"])(s,{onClick:t[1]||(t[1]=function(t){return e.store.rotate(1)}),disabled:!e.store.hasSelectedItems,icon:e.faRotateForward},{default:Object(i["withCtx"])((function(){return[Bo]})),_:1},8,["disabled","icon"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{onClick:e.store.group,disabled:!e.store.canGroup,icon:e.faObjectGroup},{default:Object(i["withCtx"])((function(){return[Po]})),_:1},8,["onClick","disabled","icon"]),Object(i["createVNode"])(s,{onClick:e.store.ungroup,disabled:!e.store.canUngroup,icon:e.faObjectUngroup},{default:Object(i["withCtx"])((function(){return[Eo]})),_:1},8,["onClick","disabled","icon"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{icon:e.faScissors},null,8,["icon"]),Object(i["createVNode"])(s,{icon:e.faCopy},null,8,["icon"]),Object(i["createVNode"])(s,{icon:e.faPaste},null,8,["icon"]),Object(i["createVNode"])(s,{onClick:e.store.deleteSelection,disabled:!e.store.hasSelection,icon:e.faBan},{default:Object(i["withCtx"])((function(){return[No]})),_:1},8,["onClick","disabled","icon"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{onClick:e.store.saveIntegratedCircuit,icon:e.faMicrochip},{default:Object(i["withCtx"])((function(){return[Do]})),_:1},8,["onClick","icon"])]),Object(i["createElementVNode"])("div",_o,[Object(i["createVNode"])(s,{icon:e.faBug,active:e.store.isDebugging,onClick:e.store.toggleDebugger},null,8,["icon","active","onClick"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{icon:e.faArrowsRotate,onClick:e.store.reset},null,8,["icon","onClick"]),Object(i["createVNode"])(s,{icon:e.faForwardStep,disabled:!e.store.isDebugging||e.store.isCircuitEvaluated,onClick:e.store.stepThroughCircuit},null,8,["icon","disabled","onClick"]),Object(i["createVNode"])(a),Object(i["createVNode"])(s,{icon:e.faWaveSquare,disabled:e.store.isDebugging,active:!e.store.isDebugging&&e.store.isOscilloscopeEnabled,onClick:e.store.toggleOscilloscope},null,8,["icon","disabled","active","onClick"])])])}var Mo=o("96ee"),zo=["disabled"];function To(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("icon");return Object(i["openBlock"])(),Object(i["createElementBlock"])("button",{tabindex:-1,disabled:e.disabled,class:Object(i["normalizeClass"])([{"toolbar-button--active":e.active},"toolbar-button"]),role:"button"},[e.icon?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:0,icon:e.icon,class:"toolbar-button__icon"},null,8,["icon"])):(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:1,icon:e.faUser,class:"toolbar-button__icon"},null,8,["icon"]))],10,zo)}var Fo=["viewBox"],Lo=["d"];function Ro(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("svg",{xmlns:"http://www.w3.org/2000/svg",class:"icon",viewBox:"0 0 ".concat(e.width," ").concat(e.height)},[Object(i["createElementVNode"])("path",{fill:"currentColor",d:e.svgPath},null,8,Lo)],8,Fo)}var Ao=Object(i["defineComponent"])({name:"Icon",props:{icon:{type:Object,required:!0}},setup:function(e){var t=Object(i["computed"])((function(){return e.icon.icon[0]})),o=Object(i["computed"])((function(){return e.icon.icon[1]})),n=Object(i["computed"])((function(){return e.icon.icon[4]}));return{width:t,height:o,svgPath:n}}});o("c36a");const qo=O()(Ao,[["render",Ro]]);var Uo=qo,$o=Object(i["defineComponent"])({name:"ToolbarButton",components:{Icon:Uo},data:function(){return{faUser:Mo["s"]}},props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:Object,default:null}}});o("f152");const Go=O()($o,[["render",To]]);var Ko=Go,Wo={class:"toolbar-separator"};function Xo(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Wo)}var Zo=Object(i["defineComponent"])({name:"ToolbarSeparator"});o("cfe0");const Yo=O()(Zo,[["render",Xo]]);var Ho=Yo,Jo=Object(i["defineComponent"])({name:"Toolbar",components:{ToolbarButton:Ko,ToolbarSeparator:Ho},data:function(){return{faFolderOpen:Mo["g"],faFile:Mo["f"],faSave:Mo["p"],faScissors:Mo["q"],faCopy:Mo["e"],faPaste:Mo["l"],faObjectGroup:Mo["j"],faObjectUngroup:Mo["k"],faRotateBackward:Mo["n"],faRotateForward:Mo["o"],faReply:Mo["m"],faShare:Mo["r"],faMicrochip:Mo["i"],faBan:Mo["b"],faArrowsRotate:Mo["a"],faBug:Mo["c"],faForwardStep:Mo["h"],faWaveSquare:Mo["t"]}},props:{store:{type:Function,required:!0}},setup:function(e){var t=e.store(),o=Object(i["computed"])((function(){return t.simulation.circuit.isComplete()}));return{store:t,isComplete:o}}});o("1837");const Qo=O()(Jo,[["render",Vo]]);var en=Qo,tn={class:"toolbox"};function on(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("input-switch"),a=Object(i["resolveComponent"])("toolbox-item"),u=Object(i["resolveComponent"])("lightbulb"),l=Object(i["resolveComponent"])("logic-gate");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",tn,[Object(i["createVNode"])(a,{"right-port-count":1,zoom:e.zoom,label:"Toggle Switch",onDrop:e.onDropSwitch},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(s,{value:-1})]})),_:1},8,["zoom","onDrop"]),Object(i["createVNode"])(a,{"right-port-count":1,zoom:e.zoom,label:"Clock",onDrop:e.onDropClock},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(s,{value:-1})]})),_:1},8,["zoom","onDrop"]),Object(i["createVNode"])(a,{"left-port-count":1,zoom:e.zoom,label:"Lightbulb",onDrop:e.onDropLightbulb},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(u,{value:-1})]})),_:1},8,["zoom","onDrop"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])([e.ItemSubtype.And,e.ItemSubtype.Nand,e.ItemSubtype.Xnor,e.ItemSubtype.Xor,e.ItemSubtype.Nor,e.ItemSubtype.Or],(function(t,o){return Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:o,"left-port-count":2,"right-port-count":1,zoom:e.zoom,label:t,onDrop:function(o){return e.onDropLogicGate(t,o)}},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(l,{"input-count":2,type:t},null,8,["type"])]})),_:2},1032,["zoom","label","onDrop"])})),128))])}var nn={class:"toolbox-entry"},rn={class:"toolbox-entry__preview",ref:"toolboxItem"},cn={class:"toolbox-item__label"};function sn(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("port-handle"),a=Object(i["resolveComponent"])("port-pivot"),u=Object(i["resolveComponent"])("port-set");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:"toolbox-item",tabindex:-1,onMousedown:t[0]||(t[0]=function(){return e.onMouseDown&&e.onMouseDown.apply(e,arguments)})},[Object(i["createElementVNode"])("div",nn,[Object(i["createElementVNode"])("div",rn,[Object(i["createElementVNode"])("div",{class:"toolbox-entry__inner",ref:"selectable",style:Object(i["normalizeStyle"])({zoom:e.zoom})},[Object(i["renderSlot"])(e.$slots,"default"),Object(i["createVNode"])(u,null,Object(i["createSlots"])({_:2},[Object(i["renderList"])(e.portCounts,(function(e,t){return{name:t,fn:Object(i["withCtx"])((function(){return[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e,(function(o){return Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:"".concat(t,"_").concat(e),type:1},{default:Object(i["withCtx"])((function(){return[Object(i["createVNode"])(s)]})),_:2},1024)})),128))]}))}}))]),1024)],4)],512)]),Object(i["createElementVNode"])("div",cn,Object(i["toDisplayString"])(e.label),1)],32)}var an=Object(i["defineComponent"])({name:"ToolboxItem",components:{PortHandle:gt,PortSet:St,PortPivot:Yt},props:{leftPortCount:{type:Number,default:0},topPortCount:{type:Number,default:0},rightPortCount:{type:Number,default:0},bottomPortCount:{type:Number,default:0},label:{type:String,required:!0},zoom:{type:Number,default:1}},setup:function(e,t){var o=t.emit,n=Object(i["ref"])(),r=Object(i["ref"])(),c=Object(i["ref"])(1),s={left:e.leftPortCount,top:e.topPortCount,right:e.rightPortCount,bottom:e.bottomPortCount},a=null,u={x:0,y:0};function l(){if(n.value&&r.value){var e=n.value.getBoundingClientRect(),t=r.value.getBoundingClientRect(),o=Math.max(e.width/t.width,e.height/t.height);c.value=Math.min(1/o,1)}}function d(t){if(n.value){var o=n.value.getBoundingClientRect();a=n.value.cloneNode(!0),a.style.position="absolute",a.style["zoom"]="".concat(e.zoom),a.style.width="".concat(o.width,"px"),a.style.height="".concat(o.height,"px"),u=t}}function p(t){if(a){var o=Math.abs(u.x-t.x),n=Math.abs(u.y-t.y);if(!(o+n<4)){document.body.contains(a)||document.body.appendChild(a);var i=a.getBoundingClientRect(),r=i.width,c=i.height;a.style.left="".concat((t.x-r/2*e.zoom)/e.zoom,"px"),a.style.top="".concat((t.y-c/2*e.zoom)/e.zoom,"px")}}}function f(){if(a){document.body.contains(a)||o("drop");var t=a.getBoundingClientRect(),n=t.x,i=t.y;a.remove(),a=null,o("drop",{x:n*e.zoom,y:i*e.zoom})}}var m=new h["a"](l);return Object(i["onMounted"])((function(){r.value&&m.observe(r.value),n.value&&m.observe(n.value),window.addEventListener("mousemove",p),window.addEventListener("mouseup",f)})),Object(i["onBeforeMount"])((function(){window.removeEventListener("mousemove",p),window.removeEventListener("mouseup",f)})),{portCounts:s,onMouseDown:d,zoom:c,selectable:n,toolboxItem:r}}});o("a0f4");const un=O()(an,[["render",sn]]);var ln,dn=un;function pn(e,t,o,n,i){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];return{id:e,name:"",type:t,subtype:o,portIds:r.map((function(e){var t=e.id;return t})),groupId:null,rotation:0,boundingBox:{top:0,left:0,right:n,bottom:i},position:{x:0,y:0},zIndex:0,width:n,height:i,isSelected:!1,properties:{}}}function fn(e,t,o,n,i){return{id:t,orientation:o,name:i,position:{x:0,y:0},type:n,rotation:0,elementId:e,value:0,isFreeport:!1,connectedPortIds:[]}}(function(e){e[e["Left"]=0]="Left",e[e["Top"]=1]="Top",e[e["Right"]=2]="Right",e[e["Bottom"]=3]="Bottom"})(ln||(ln={}));var hn=ln;function mn(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=Object(V["a"])(),r=[fn(i,Object(V["a"])(),hn.Right,Ht.Output,"Output Port")],c=pn(i,oo.InputNode,e,t,o,r);return c.properties=Object(p["a"])(Object(p["a"])({},n),{},{startValue:{label:"Start value",value:-1,type:"number",options:{True:1,"Hi-Z":0,False:-1}}}),{item:c,ports:r}}function bn(){return mn(Le.Clock,60,60,{interval:{label:"Interval",value:1e3,type:"number",min:100}})}function vn(){var e=Object(V["a"])(),t=[fn(e,Object(V["a"])(),hn.Left,Ht.Input,"Input Port")],o=pn(e,oo.OutputNode,Le.Lightbulb,40,40,t);return{item:o,ports:t}}function gn(e,t,o){var n=Object(V["a"])(),i=[fn(n,Object(V["a"])(),0,1,"Input Port 1"),fn(n,Object(V["a"])(),0,1,"Input Port 2"),fn(n,Object(V["a"])(),2,0,"Output Port")],r=pn(n,oo.LogicGate,e,t,o,i);return r.properties={inputCount:{label:"Input count",value:2,type:"number",min:2},showInOscilloscope:{label:"Show in oscilloscope",value:!1,type:"boolean"}},{item:r,ports:i}}var On=Object(i["defineComponent"])({name:"Toolbox",components:{InputSwitch:Ye,Lightbulb:ut,LogicGate:qe,ToolboxItem:dn},props:{store:{type:Function,required:!0}},setup:function(e){var t=e.store(),o=Object(i["computed"])((function(){return t.zoom}));function n(e){t.insertItem(vn(),e)}function r(e){t.insertItem(mn(Le.Switch,60,60),e)}function c(e){t.insertItem(bn(),e)}function s(e,o){var n=gn(e,140,50),i=n.item,r=n.ports;t.insertItem({item:i,ports:r},o)}return{ItemSubtype:Le,onDropLightbulb:n,onDropSwitch:r,onDropClock:c,onDropLogicGate:s,zoom:o}}});o("d06a");const yn=O()(On,[["render",on]]);var jn=yn,In={class:"resizable-panes__content"};function xn(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])(["resizable-panes",{"resizable-panes--vertical":e.isVertical}]),ref:"root"},[Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])(["resizable-panes__first",{"resizable-panes__first--vertical":e.isVertical}]),style:Object(i["normalizeStyle"])(e.firstStyle)},[Object(i["createElementVNode"])("div",In,[Object(i["renderSlot"])(e.$slots,"first")]),Object(i["createElementVNode"])("div",{class:Object(i["normalizeClass"])(["resizable-panes__divider",{"resizable-panes__divider--vertical":e.isVertical}]),onMousedown:t[0]||(t[0]=function(){return e.mousedown&&e.mousedown.apply(e,arguments)})},null,34)],6),Object(i["createElementVNode"])("div",{class:"resizable-panes__second",style:Object(i["normalizeStyle"])(e.secondStyle)},[Object(i["renderSlot"])(e.$slots,"second")],4)],2)}var wn=Object(i["defineComponent"])({name:"ResizablePanes",data:function(){return{isMouseDown:!1}},props:{isVertical:{type:Boolean,default:!1},modelValue:{type:Number,default:30}},computed:{firstStyle:function(){var e="".concat(this.modelValue,"%");return this.isVertical?{height:e,maxHeight:e}:{width:e,maxWidth:e}},secondStyle:function(){var e="".concat(100-this.modelValue,"%");return this.isVertical?{height:e,maxHeight:e}:{width:e,maxWidth:e}}},mounted:function(){window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)},methods:{mousedown:function(){this.isMouseDown=!0},mouseup:function(){this.isMouseDown=!1},mousemove:function(e){if(this.isMouseDown){var t=this.isVertical?e.y:e.x,o=this.$refs.root.getBoundingClientRect(),n=this.isVertical?o.y:o.x,i=this.isVertical?o.height:o.width,r=Math.max(Math.min((t-n)/i*100,100),0);this.$emit("update:modelValue",r)}}}});o("f4b9");const Cn=O()(wn,[["render",xn]]);var kn=Cn,Sn=(o("bdf7"),o("d331"),o("2ff2")),Bn=(o("b506"),o("d48b"),o("2ea2"),o("f3b8"),o("918c"),o("8423"),o("33ef"),o("2d6d"),o("9bd2"),o("841a"),o("11ed"),Object(ao["a"])((function e(t,o){Object(so["a"])(this,e),this.node=t,this.id=o}))),Pn=Bn,En={TRUE:1,FALSE:-1,UNKNOWN:0},Nn=En,Dn=o("f0ad"),_n=o("02a5"),Vn=Object(ao["a"])((function e(t){var o=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(so["a"])(this,e),this.inputValues={},this.outputs=[],this.isValueChanged=!0,this.forceContinue=!1,this.value=Nn.UNKNOWN,this.newValue=Nn.UNKNOWN,this.events=[],this.setValue=function(e){o.newValue=e,o.eval=function(){return e}},this.invokeEvent=function(e,t){o.events.forEach((function(o){o.eventType===e&&o.callback(t)}))},this.eval=function(){return o.value},this.valueCount=function(e){return Object.values(o.inputValues).filter((function(t){return t===e})).length},this.updateOutputs=function(e){o.outputs.forEach((function(t){var o=t.node,n=t.id;o.update(e,n)}))},this.update=function(e,t){o.inputValues[t]=e,o.newValue=o.eval()},this.propagate=function(){return o.value!==o.newValue?(o.isValueChanged=!0,o.value=o.newValue,o.updateOutputs(o.newValue),o.invokeEvent("change",o.newValue),o.outputs.map((function(e){var t=e.node;return t}))):[]},this.reset=function(){o.value=Nn.UNKNOWN,o.newValue=Nn.UNKNOWN,o.invokeEvent("change",o.newValue)},this.on=function(e,t){o.events.push({eventType:e,callback:t})},this.getProjectedValue=function(){return o.eval()||o.newValue||o.value},this.name=t,this.inputValues=n.reduce((function(e,t){return Object.assign(Object.assign({},e),Object(f["a"])({},t,Nn.UNKNOWN))}),{})})),Mn=Vn,zn=function(e){Object(Dn["a"])(o,e);var t=Object(_n["a"])(o);function o(){var e;return Object(so["a"])(this,o),e=t.apply(this,arguments),e.reset=function(){},e}return Object(ao["a"])(o)}(Mn),Tn=zn,Fn=function(e){Object(Dn["a"])(o,e);var t=Object(_n["a"])(o);function o(){var e;return Object(so["a"])(this,o),e=t.apply(this,arguments),e.update=function(t){e.newValue!==t&&(e.newValue=t,e.invokeEvent("change",t))},e}return Object(ao["a"])(o)}(Mn),Ln=Fn,Rn=Object(ao["a"])((function e(){var t=this;Object(so["a"])(this,e),this.queue=[],this.nodes=[],this.inputNodes=[],this.addNode=function(e){e instanceof Tn&&(t.inputNodes.push(e),t.enqueue(e)),t.nodes.push(e)},this.removeNode=function(e){if(e instanceof Tn){var o=t.inputNodes.findIndex((function(t){var o=t.name;return o===e.name}));-1!==o&&t.inputNodes.splice(o,1),t.reset()}var n=t.nodes.findIndex((function(t){var o=t.name;return o===e.name}));-1!==n&&(t.removeNodeOutputs(e),t.nodes.splice(n,1)),t.next()},this.addConnection=function(e,o,n){e.outputs.push(new Pn(o,n)),e.value=Nn.UNKNOWN,t.enqueue(e),t.next()},this.removeConnection=function(e,o){e.outputs.concat().forEach((function(n,i){var r=n.node,c=n.id;o===r&&(o.update(Nn.UNKNOWN,c),e.outputs.splice(i,1),t.enqueue(o))})),t.next()},this.removeNodeOutputs=function(e){for(var o=0;o<e.outputs.length;o++)t.removeConnection(e,e.outputs[o].node)},this.enqueue=function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];o.forEach((function(e){~t.queue.indexOf(e)||t.queue.push(e)}))},this.dequeue=function(e){var o=t.queue.indexOf(e);~o&&t.queue.splice(o,1)},this.reset=function(){t.nodes.forEach((function(e){return e.reset()}))},this.next=function(){var e=!1,o=[];while(t.queue.length>0){var n=t.queue.shift();o=o.concat(n.propagate()),t.dequeue(n),n.isValueChanged&&(e=!0,n.isValueChanged=!1),n.forceContinue&&(!0,t.enqueue.apply(t,Object(A["a"])(o)),o=[])}e&&t.enqueue.apply(t,Object(A["a"])(o))},this.isComplete=function(){var e=!0;return 0===t.queue.length||(t.queue.forEach((function(t){var o=t.getProjectedValue();o===t.value||t instanceof Ln||(e=!1)})),e&&(t.queue=[]),e)}})),An=Rn,qn=function(e){Object(Dn["a"])(o,e);var t=Object(_n["a"])(o);function o(){var e;return Object(so["a"])(this,o),e=t.apply(this,arguments),e.eval=function(){return e.valueCount(Nn.TRUE)?Nn.FALSE:e.valueCount(Nn.UNKNOWN)?Nn.UNKNOWN:Nn.TRUE},e}return Object(ao["a"])(o)}(Mn),Un=qn,$n=function(e){Object(Dn["a"])(o,e);var t=Object(_n["a"])(o);function o(){var e;return Object(so["a"])(this,o),e=t.apply(this,arguments),e.update=function(t){var o=Object.keys(e.inputValues).pop();e.inputValues[o]=t,e.newValue=e.eval()},e.eval=function(){return Object.values(e.inputValues).pop()},e}return Object(ao["a"])(o)}(Mn),Gn=$n,Kn=(o("f38f"),Object(ao["a"])((function e(t,o,n){var i=this;Object(so["a"])(this,e),this.width=0,this.lastY=0,this.segments=[],this.hue=~~(360*Math.random()),this.initialize=function(e){var t={x:1,y:1};1===e?(t.y=0,i.lastY=1):(t.y=1,i.lastY=0),i.width++,i.addSegment(t)},this.reset=function(){i.segments=[],i.width=0,i.initialize(1===i.lastY?0:1)},this.update=function(e){i.drawPulseConstant()},this.addSegment=function(e){var t=i.segments[i.segments.length-1];!t&&e.x>0?(i.segments.push({x:0,y:e.y}),i.width++):t&&t.x!==e.x&&t.y!==e.y&&(i.segments.pop(),i.width--),i.segments.push(e)},this.drawPulseChange=function(e){var t=i.segments[i.segments.length-1].x,o=e===Nn.TRUE?0:1;i.width++,i.addSegment({x:t,y:o})},this.drawPulseConstant=function(){var e=i.segments[i.segments.length-1],t=i.lastY!==e.y?e:i.segments.pop();t&&(i.width++,i.addSegment({x:t.x+1,y:t.y})),i.lastY=e.y},this.truncateSegments=function(e){if(!(e>i.width)){var t=i.width-e,o=!1;i.segments=i.segments.reverse().map((function(e){var n=e.x,i=e.y;return n-=t,n<=0&&!o&&(o=!0,n=0),{x:n,y:i}})).filter((function(e){var t=e.x;return t>=0})).reverse(),i.width=e}},this.id=t,this.name=o,this.initialize(n)}))),Wn=Object(ao["a"])((function e(t,o,n){var i=this;Object(so["a"])(this,e),this.id=Object(V["a"])(),this.signal=0,this.interval=0,this.emitter=new po["TinyEmitter"],this.on=function(e,t){i.emitter.on(e,t)},this.update=function(e){e>=i.lastUpdate+i.interval&&(i.signal=1===i.signal?-1:1,i.lastUpdate=e,i.emitter.emit("change",i.signal))},this.name=t,this.lastUpdate=0,this.signal=n,this.interval=o})),Xn=Object(ao["a"])((function e(){var t=this;Object(so["a"])(this,e),this.isPaused=!0,this.waves={},this.refreshRate=20,this.lastUpdateTime=Date.now(),this.timeMsElapsed=0,this.timeMsOffset=0,this.emitter=new po["TinyEmitter"],this.start=function(){if(t.isPaused){var e=t.lastUpdateTime%t.refreshRate;t.lastUpdateTime=Date.now()+e,t.isPaused=!1,t.tick()}},this.stop=function(){t.isPaused=!0},this.clear=function(){Object.values(t.waves).forEach((function(e){e instanceof Kn&&e.reset()}))},this.computeWaveGeometry=function(e){var t={},o=function(e){return e.map((function(e){var t=e.x,o=e.y;return"".concat(t,",").concat(o)}))};for(var n in e)if(e[n]instanceof Kn){var i=e[n],r=o(i.segments);t[n]={points:r.join(" "),width:i.segments.slice(-1)[0].x,hue:i.hue}}return t},this.on=function(e,o){t.emitter.on(e,o)},this.broadcast=function(){var e=1e3/t.refreshRate,o=2*window.screen.width/e;if(t.timeMsElapsed/1e3-t.timeMsOffset>=o){var n=Math.max(o/2,window.innerWidth/e);t.timeMsOffset+=n,Object.values(t.waves).forEach((function(t){t instanceof Kn&&t.truncateSegments(n*e)}))}t.emitter.emit("change",t.computeWaveGeometry(t.waves))},this.tick=function(){if(!t.isPaused){var e=Date.now(),o=1e4,n=!1;if(e>=t.lastUpdateTime+o)return t.stop(),void t.start();while(e>=t.lastUpdateTime+t.refreshRate){var i=Math.min(t.refreshRate,e-t.lastUpdateTime);n=!0,t.timeMsElapsed+=i,t.lastUpdateTime+=i,t.update()}n&&t.broadcast(),requestAnimationFrame(t.tick)}},this.update=function(){Object.values(t.waves).forEach((function(e){return e.update(t.timeMsElapsed)}))},this.add=function(e){t.waves.hasOwnProperty(e.id)||(t.waves[e.id]=e,0===t.timeMsElapsed&&t.broadcast())},this.remove=function(e){var o=e.id;delete t.waves[o],0===Object.keys(t.waves).length&&(t.stop(),t.clear())}}));function Zn(e,t,o){switch(e){case Le.And:return new Un(t,o);default:return new Un(t,o)}}function Yn(e,t){var o=e.id,n=e.type,i=e.subtype;switch(n){case oo.CircuitNode:return new Mn(o,t);case oo.InputNode:return new Tn(o,t);case oo.LogicGate:return Zn(i,o,t);case oo.Buffer:case oo.Freeport:return new Gn(o,t);default:return new Ln(o,t)}}var Hn={getLogicGateNode:Zn,getCircuitNode:Yn},Jn=Object(ao["a"])((function e(t,o,n){var i=this;Object(so["a"])(this,e),this.nodes={},this.waves={},this.clocks={},this.valueMap={},this.circuit=new An,this.integratedCircuits={},this.oscillator=new Xn,this.emitter=new po["TinyEmitter"],this.isPaused=!1,this.oscillogram={},this.integratedCircuitGroups={},this.addElements=function(e,t,o){e.forEach((function(e){return i.addNode(e,o)})),t.forEach((function(e){return i.addConnection(e.source,e.target)}))},this.on=function(e,t){i.emitter.on(e,t)},this.emit=function(){i.emitter.emit("change",i.valueMap,i.oscillogram)},this.pause=function(){i.oscillator.stop(),i.isPaused=!0},this.unpause=function(){i.isPaused=!1,i.oscillator.start(),i.emit()},this.step=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!i.isPaused){i.circuit.next();var t=i.circuit.queue.length>0;if(e>1e4)throw new Error("An infinite loop detected!");t&&i.step(++e),i.emit()}},this.canContinue=!1,this.nextState=null,this.isDebug=!1,this.nextValueMap={},this.startDebugging=function(){i.isDebug=!0,i.pause(),i.computeNextState()},this.stopDebugging=function(){i.isDebug=!1,i.nextState=null,i.unpause()},this.advance=function(){var e=Object.keys(i.nextValueMap);e.length>0?e.forEach((function(e){return i.updatePortValue(e,i.nextValueMap[e])})):i.nextState&&(i.valueMap=JSON.parse(i.nextState)),i.nextValueMap={},i.computeNextState(),i.emit()},this.computeNextState=function(){var e=JSON.stringify(i.valueMap);i.circuit.next();var t=JSON.stringify(i.valueMap);i.nextState=e!==t?t:null,i.canContinue=null!==i.nextState},this.setOutputValue=function(e,t){i.valueMap[e]=t,i.emit()},this.updatePortValue=function(e,t){var o;i.nodes[e].setValue(t),i.circuit.enqueue(i.nodes[e]),null===(o=i.waves[e])||void 0===o||o.drawPulseChange(t)},this.enqueuePortValueChange=function(e,t){i.nextValueMap[e]=t,i.canContinue=Object.keys(i.nextValueMap).reduce((function(e,t){return e||i.valueMap[t]!==i.nextValueMap[t]}),!1),i.emit()},this.setPortValue=function(e,t){if(i.isDebug)return i.enqueuePortValueChange(e,t);i.nodes[e]&&i.nodes[e].value!==t&&(i.updatePortValue(e,t),i.step())},this.addIntegratedCircuit=function(e,t){if(e.integratedCircuit){var o=e.integratedCircuit,n=o.items,r=o.connections,c=o.ports;Object.values(n).forEach((function(e){i.addNode(e,c,!0)})),Object.values(r).forEach((function(e){i.addConnection(e.source,e.target)}))}},this.addNode=function(e,t){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(0!==e.portIds.length){if(e.integratedCircuit)return i.addIntegratedCircuit(e,t);var n=e.portIds.filter((function(e){return t[e].type===Ht.Input})),r=e.portIds.filter((function(e){return t[e].type===Ht.Output})),c=Hn.getCircuitNode(e,n);c.forceContinue=o,e.portIds.forEach((function(e){return i.addPort(e,c)})),e.type===oo.InputNode&&e.subtype===Le.Clock&&i.addClock(r[0]),i.circuit.addNode(c),o||i.monitorNode(e,t)}},this.removeNode=function(e){var t=function e(t){return t.integratedCircuit?Object.values(t.integratedCircuit.items).reduce((function(t,o){return o.integratedCircuit?t.concat(e(o)).concat(o.portIds):t.concat(o.portIds)}),[]):[]};e.portIds.concat(t(e)).forEach((function(e){var t=i.nodes[e];t&&(i.circuit.removeNode(t),i.removePort(e))})),i.emit()},this.monitorNode=function(e,t){var o,n;if(null!==(o=e.properties)&&void 0!==o&&null!==(n=o.showInOscilloscope)&&void 0!==n&&n.value){var r=e.portIds.filter((function(e){return t[e].type===Ht.Input})),c=e.portIds.filter((function(e){return t[e].type===Ht.Output})),s=e.type==oo.OutputNode?r:c;s.forEach((function(e){i.monitorPort(e,i.nodes[e].value)}))}},this.addClock=function(e){i.clocks[e]=new Wn(e,1e3,1),i.clocks[e].on("change",(function(t){i.setPortValue(e,t)})),i.oscillator.add(i.clocks[e])},this.addSiblingPort=function(e,t){i.addPort(e,i.nodes[t])},this.addPort=function(e,t){i.nodes[e]=t,t.on("change",(function(t){var o;i.setOutputValue(e,t),null===(o=i.waves[e])||void 0===o||o.drawPulseChange(t)}))},this.removePort=function(e){i.clocks[e]&&i.oscillator.remove(i.clocks[e]),i.unmonitorPort(e),delete i.nodes[e],delete i.valueMap[e],delete i.clocks[e],delete i.waves[e]},this.addConnection=function(e,t){i.nodes[e]&&i.nodes[t]?i.circuit.addConnection(i.nodes[e],i.nodes[t],t):i.nodes[e]?console.log("MISSING TARGET: ",t," TRIED TO CONNECT TO ---",e):console.log("MISSING SOURCE: ",e," TRIED TO CONNECT TO ---",t)},this.removeConnection=function(e,t){i.nodes[e]&&i.nodes[t]?i.circuit.removeConnection(i.nodes[e],i.nodes[t]):console.log("MISSING NODE FOR REMOVING CONNECTION: ",i.nodes[e],i.nodes[t],e,t)},this.monitorPort=function(e,t){i.waves[e]||(i.waves[e]=new Kn(e,e,t),i.oscillator.add(i.waves[e]))},this.unmonitorPort=function(e){i.waves[e]&&(i.oscillator.remove(i.waves[e]),i.oscillator.broadcast()),delete i.waves[e],delete i.oscillator.waves[e],delete i.oscillogram[e]},this.addElements(t,o,n),this.oscillator.on("change",(function(e){i.oscillogram=e,i.emit()}))}));function Qn(e,t,o){var n=Math.pow(e.x-t.x,2),i=Math.pow(e.y-t.y,2);return Math.sqrt(n+i)<=o}function ei(e,t,o,n){var i=function(e,t,o){return(o.y-e.y)*(t.x-e.x)>(t.y-e.y)*(o.x-e.x)};return i(e,o,n)!==i(t,o,n)&&i(e,t,o)!==i(e,t,n)}function ti(e,t,o){var n={x:o.left,y:o.top},i={x:o.right,y:o.top},r={x:o.right,y:o.bottom},c={x:o.left,y:o.bottom};return ei(e,t,n,i)||ei(e,t,i,r)||ei(e,t,r,c)||ei(e,t,c,n)}function oi(e,t){return{left:e.left*t,top:e.top*t,bottom:e.bottom*t,right:e.right*t}}function ni(e){return e.left!==e.right||e.top!==e.bottom}function ii(e){return[{left:e.x,right:e.x,top:-1/0,bottom:1/0},{left:-1/0,right:1/0,top:e.y,bottom:e.y}]}function ri(e){return{left:e.x,top:e.y,right:e.x,bottom:e.y}}function ci(e,t){return!(e.left>=t.right||t.left>=e.right)&&!(e.top>=t.bottom||t.top>=e.bottom)}function si(e){if(e.rotation%2===0)return{left:e.position.x,top:e.position.y,bottom:e.height+e.position.y,right:e.width+e.position.x};var t=e.position.x+e.width/2,o=e.position.y+e.height/2;return{left:t-e.height/2,top:o-e.width/2,right:t+e.height/2,bottom:o+e.width/2}}function ai(e){return e.reduce((function(e,t){return{left:Math.min(e.left,t.left),top:Math.min(e.top,t.top),right:Math.max(e.right,t.right),bottom:Math.max(e.bottom,t.bottom)}}),{left:1/0,top:1/0,right:0,bottom:0})}function ui(e){var t=e.right-e.left,o=e.bottom-e.top;return{x:t/2,y:o/2}}function li(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=ui(e),i=t.right-t.left,r=t.bottom-t.top,c=function(e){return Math.round(e/o)*o};return{x:c(n.x-i/2),y:c(n.y-r/2)}}var di={isInNeighborhood:Qn,isLineIntersectingRectangle:ti,scaleBoundingBox:oi,isTwoDimensional:ni,getLinearBoundaries:ii,getPointBoundary:ri,hasIntersection:ci,getItemBoundingBox:si,getGroupBoundingBox:ai,getBoundingBoxMidpoint:ui,getCenteredScreenPoint:li};function pi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(e+t%4+4)%4}function fi(e,t,o){var n=e.right-e.left,i=e.bottom-e.top,r=e.left+n/2,c=e.top+i/2,s=t.position.x,a=t.position.y,u=s+t.width/2,l=a+t.height/2,d=Math.sqrt(Math.pow(r-u,2)+Math.pow(c-l,2)),p=Math.atan2(l-c,u-r),f=90*o*(Math.PI/180)+p,h=d*Math.cos(f)+r,m=d*Math.sin(f)+c;return{x:h-t.width/2,y:m-t.height/2}}function hi(e,t,o,n){var i=o.boundingBox,r=i.left,c=i.top,s=i.bottom,a=i.right,u=(e.orientation+o.rotation)%2===0?Math.floor((s-c)/t.length):Math.floor((a-r)/t.length),l=u*(n+1)-u/2;switch(pi(e.orientation+o.rotation)){case hn.Left:return{x:r,y:c+l};case hn.Top:return{x:a-l,y:c};case hn.Right:return{x:a,y:s-l};case hn.Bottom:return{x:r+l,y:s}}}var mi={rotate:pi,getGroupedItemRotatedPosition:fi,getRotatedPortPosition:hi};function bi(e,t,o){var n=Object.values(e).reduce((function(e,n){var i=e.connectionIds,r=e.freeportIds;if(o===n.connectionChainId){var c=t[n.source],s=t[n.target];i.add(n.id),null!==c&&void 0!==c&&c.isFreeport&&r.add(c.elementId),null!==s&&void 0!==s&&s.isFreeport&&r.add(s.elementId)}return{connectionIds:i,freeportIds:r}}),{connectionIds:new Set,freeportIds:new Set}),i=n.connectionIds,r=n.freeportIds;return{connectionIds:Array.from(i),freeportIds:Array.from(r)}}function vi(e,t){return e.zIndex>t.zIndex?1:e.zIndex<t.zIndex?-1:0}function gi(e){var t=Object(Tt["cloneDeep"])(e),o=t.ports,n=t.items,i=t.connections,r=t.groups,c=pn(Object(V["a"])(),oo.IntegratedCircuit,"Flip flop",400,400);return Object.values(n).forEach((function(e){if(e.type===oo.InputNode||e.type===oo.OutputNode){var t=e.type===oo.InputNode?Ht.Output:Ht.Input,n=e.type===oo.InputNode?hn.Left:hn.Right;e.portIds.filter((function(e){return o[e].type===t})).forEach((function(t){var i=Object(V["a"])();o[i]=Object(p["a"])(Object(p["a"])({},Object(Tt["cloneDeep"])(o[t])),{},{type:e.type===oo.InputNode?Ht.Input:Ht.Output,id:i,elementId:e.id,orientation:n}),e.portIds.push(i),c.portIds.push(i)})),e.type=oo.Buffer}})),c.integratedCircuit={items:n,connections:i,ports:o,groups:r,serializedState:JSON.stringify({items:e.items,connections:e.connections,ports:e.ports,groups:e.groups})},c}function Oi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=Object(Tt["cloneDeep"])(e),n=o.items,i=o.connections,r=o.ports,c=o.groups;function s(e){return Object.values(e).forEach((function(o){var n=o.id,i=Object(V["a"])();t[n]=i,e[i]=Object(Tt["cloneDeep"])(o),delete e[n]})),e}function a(e,o){return Object.values(e).forEach((function(e){e.groupId=null!==e.groupId?t[e.groupId]:null})),Object.values(o).forEach((function(e){e.groupId=null!==e.groupId?t[e.groupId]:null})),{connections:e,items:o}}function u(e){return Object.values(e).forEach((function(o){var n=o.id,i=Object(V["a"])();t[n]=i,e[i]=Object(Tt["cloneDeep"])(o),e[i].id=i,e[i].source=t[e[i].source],e[i].target=t[e[i].target],delete e[n]})),e}function l(e){return Object.values(e).forEach((function(o){e[o.id].connectionChainId=t[e[o.id].connectionChainId]})),e}function d(e){return Object.values(e).forEach((function(o){var n=o.id,i=Object(V["a"])();t[n]=i,e[i]=Object(Tt["cloneDeep"])(o),o.integratedCircuit?e[i].integratedCircuit=Object(p["a"])({serializedState:o.integratedCircuit.serializedState},Oi(Object(Tt["cloneDeep"])(o.integratedCircuit),t)):e[i].id=i,e[i].portIds=o.portIds.map((function(e){return t[e]})),delete e[n]})),e}function f(e){return Object.values(e).forEach((function(o){e[o.id].elementId=t[o.elementId]})),e}function h(e){return Object.values(e).forEach((function(o){var n=o.id,i=Object(V["a"])();t[n]=i,e[i]=Object(Tt["cloneDeep"])(o),e[i].id=i,delete e[n]})),e}return r=h(r),n=d(n),r=f(r),i=u(i),i=l(i),c=s(c),Object(p["a"])(Object(p["a"])({},a(i,n)),{},{ports:r,groups:c})}function yi(e){if(!e.integratedCircuit)return e;var t=Oi({items:Object(f["a"])({},e.id,e),connections:{},ports:{},groups:{}}),o=t.items;return Object.values(o)[0]}var ji={mapStandardCircuitIds:Oi,mapIntegratedCircuitIds:yi};function Ii(e,t){var o=[e.type];return e.subtype!==Le.None&&o.push(e.subtype),o.push(t.toString()),o.join(" ")}function xi(e,t,o,n){return{x:(o.x-t.x-e.left)/n,y:(o.y-t.y-e.top)/n}}var wi=.25,Ci=function(e){return Object(n["b"])({id:e,state:function(){return{undoStack:[],redoStack:[],simulation:new Jn([],[],{}),oscillogram:{},taxonomyCounts:{},zoomLevel:1,zIndex:1,isOscilloscopeEnabled:!0,isCircuitEvaluated:!1,isDebugging:!1,isDirty:!1,hasLoaded:!1,viewport:new DOMRect,canvas:{top:0,left:0,bottom:0,right:0},snapBoundaries:[],connectablePortIds:[],selectedConnectionIds:[],selectedItemIds:[],selectedPortIndex:-1,cachedState:null,activeFreeportId:null,activePortId:null,connectionPreviewId:null,items:{},connections:{},ports:{},groups:{}}},getters:{baseItems:function(e){return Object.values(e.connections).concat(Object.values(e.items)).sort(vi)},zoom:function(e){return e.zoomLevel},hasSelection:function(e){return e.selectedItemIds.length>0||e.selectedConnectionIds.length>0},hasSelectedItems:function(e){return e.selectedItemIds.length>0},selectedGroupIds:function(e){var t=new Set;return e.selectedItemIds.forEach((function(o){var n;return t.add(null===(n=e.items[o])||void 0===n?void 0:n.groupId)})),Array.from(t)},canGroup:function(){return this.selectedGroupIds.length>1||null===this.selectedGroupIds[0]},canUngroup:function(){return!0},canUndo:function(e){return e.undoStack.length>0},canRedo:function(e){return e.redoStack.length>0}},actions:{loadDocument:function(e){this.buildCircuit(),this.applyState(e),this.reset()},setZoom:function(e){var t=e.zoom,o=e.point;if(!(t<wi||t>5)){var n=xi(this.canvas,this.viewport,o,this.zoomLevel),i={x:n.x*t,y:n.y*t},r={x:o.x-this.viewport.x,y:o.y-this.viewport.y};this.panTo({x:Math.min(r.x-i.x,0),y:Math.min(r.y-i.y,0)}),this.zoomLevel=t}},setViewerSize:function(e){this.viewport=e,this.canvas.bottom=screen.height/wi,this.canvas.right=screen.width/wi,!this.hasLoaded&&e.width>0&&e.height>0&&(this.hasLoaded=!0,this.centerAll(),this.panToCenter())},panTo:function(e){var t=e.x-this.canvas.left,o=e.y-this.canvas.top;this.canvas.left+=t,this.canvas.right+=t,this.canvas.top+=o,this.canvas.bottom+=o},panToCenter:function(){var e=di.getBoundingBoxMidpoint(this.canvas);this.panTo({x:this.viewport.width/2-e.x,y:this.viewport.height/2-e.y})},centerAll:function(){var e=this,t=Object.values(this.items).map((function(e){var t=e.boundingBox;return t})),o=di.getGroupBoundingBox(t),n=di.getCenteredScreenPoint(this.canvas,o,20),i=n.x,r=n.y,c=i-o.left,s=r-o.top;Object.values(this.items).forEach((function(t){e.setItemPosition({id:t.id,position:{x:t.position.x+c,y:t.position.y+s}}),e.setItemPortPositions(t.id)}))},saveIntegratedCircuit:function(){var e=this;return Object(co["a"])(regeneratorRuntime.mark((function t(){var o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=gi(e.$state),n=ji.mapIntegratedCircuitIds(o),e.addIntegratedCircuit(n);case 3:case"end":return t.stop()}}),t)})))()},buildCircuit:function(){var e=this;this.simulation.oscillator&&this.simulation.oscillator.stop();var t=new Jn(Object.values(this.items),Object.values(this.connections),this.ports);t.on("change",(function(t,o){for(var n in t)e.ports[n]&&(e.ports[n].value=t[n]);e.isCircuitEvaluated=!e.simulation.canContinue,e.oscillogram=o})),this.simulation=t},recycleSelection:function(e){var t=e?this.baseItems[0]:this.baseItems.slice(-1)[0];t&&(this.deselectAll(),this.setSelectionState({id:t.id,value:!0}))},insertItem:function(e){var t=e.item,o=e.ports,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!n){var i=di.getBoundingBoxMidpoint(this.viewport);n=xi(this.canvas,this.viewport,i,this.zoomLevel),console.log("item.boundingBox: ",n,this.viewport)}this.commitState(),this.addNewItem({item:t,ports:o});var r=xi(this.canvas,this.viewport,n,this.zoomLevel);this.setItemPosition({id:t.id,position:r}),this.setItemPortPositions(t.id),this.setSelectionState({id:t.id,value:!0})},undo:function(){var e=this.undoStack.slice(-1).pop();e&&(this.redoStack.push(JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})),this.applyState(e),this.undoStack.pop(),this.isDirty=!0)},redo:function(){var e=this.redoStack.slice(-1).pop();e&&(this.undoStack.push(JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})),this.applyState(e),this.redoStack.pop(),this.isDirty=!0)},commitState:function(){this.cacheState(),this.commitCachedState()},deleteSelection:function(){var e=this;this.commitState();var t=Object.values(this.items).filter((function(e){var t=e.isSelected,o=e.type;return t&&o!==oo.Freeport})),o=t.map((function(e){var t=e.id;return t}));Object.values(this.connections).filter((function(t){var n=e.ports[t.source],i=e.ports[t.target];if(n&&i)return o.includes(n.elementId)||o.includes(i.elementId)})).forEach((function(t){var o=t.id;return e.setSelectionState({id:o,value:!0})})),Object.values(this.connections).filter((function(e){var t=e.isSelected;return t})).forEach((function(t){e.disconnect({source:t.source,target:t.target})})),t.forEach((function(t){return e.removeElement(t.id)})),Object.values(this.items).filter((function(e){var t=e.isSelected,o=e.type;return t&&o===oo.Freeport})).forEach((function(t){return e.removeFreeport(t.id)}))},setSnapBoundaries:function(e){var t=this,o=function(){var o=t.items[e];if(t.connectablePortIds.length)return t.connectablePortIds.map((function(e){return di.getPointBoundary(t.ports[e].position)}));if(o&&!o.groupId){if(o.type!==oo.Freeport)return Object.values(t.items).filter((function(t){return t.id!==e&&t.type!==oo.Freeport})).map((function(e){return e.boundingBox}));if(o.portIds.length>1)return Object.values(t.connections).reduce((function(e,n){return o.portIds.includes(n.source)?e.concat(di.getLinearBoundaries(t.ports[n.target].position)):o.portIds.includes(n.target)?e.concat(di.getLinearBoundaries(t.ports[n.source].position)):e}),[])}return[]}();this.snapBoundaries=o},setItemSize:function(e){var t=e.rect,o=e.id,n=this.items[o];if(n){var i=n.position.x+n.width/2,r=n.position.y+n.height/2,c=i-t.width/2,s=r-t.height/2;this.items[o].position={x:c,y:s},this.items[o].width=t.width,this.items[o].height=t.height,this.setItemBoundingBox(o),this.setItemPortPositions(o),this.items[o].groupId&&this.setGroupBoundingBox(this.items[o].groupId||"")}},setItemPortPositions:function(e){var t=this,o=this.items[e];if(o){var n=o.portIds.reduce((function(e,n){var i=t.ports[n];if(i){var r,c=mi.rotate(i.orientation+o.rotation);null===(r=e.get(c))||void 0===r||r.push(i)}return e}),new Map([[hn.Left,[]],[hn.Top,[]],[hn.Right,[]],[hn.Bottom,[]]])),i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(n,i){t.ports[n.id].position=mi.getRotatedPortPosition(n,e,o,i)}))};i(n.get(hn.Left)),i(n.get(hn.Top)),i(n.get(hn.Right)),i(n.get(hn.Bottom))}},setItemPosition:function(e){var t=this,o=e.id,n=e.position,i=this.items[o],r={x:n.x-i.position.x,y:n.y-i.position.y};this.items[o].position=n,this.items[o].boundingBox={left:i.boundingBox.left+r.x,top:i.boundingBox.top+r.y,bottom:i.boundingBox.bottom+r.y,right:i.boundingBox.right+r.x},i.portIds.forEach((function(e){var o=t.ports[e];t.ports[e].position={x:o.position.x+r.x,y:o.position.y+r.y}}))},moveSelectionPosition:function(e){var t=this.selectedItemIds[0];if(t){var o=this.items[t],n={x:o.position.x+e.x,y:o.position.y+e.y};this.commitState(),this.setSelectionPosition({id:t,position:n})}},setSelectionPosition:function(e){var t=this,o=e.id,n=e.position,i=this.items[o],r={x:n.x-i.position.x,y:n.y-i.position.y},c=new Set;if(this.setSelectionState({id:o,value:!0}),i.type===oo.Freeport)return this.setItemPosition({id:o,position:n});this.selectedItemIds.forEach((function(e){var o=t.items[e],n={x:o.position.x+r.x,y:o.position.y+r.y};o.groupId&&c.add(o.groupId),t.setItemPosition({id:e,position:n})})),c.forEach((function(e){var o=t.groups[e];t.groups[e].boundingBox={left:o.boundingBox.left+r.x,top:o.boundingBox.top+r.y,right:o.boundingBox.right+r.x,bottom:o.boundingBox.bottom+r.y}}))},setItemBoundingBox:function(e){var t=this.items[e];t&&(this.items[e].boundingBox=di.getItemBoundingBox(t))},setGroupBoundingBox:function(e){var t=this;if(this.groups[e]){var o=this.groups[e].itemIds.map((function(e){return t.items[e].boundingBox}));this.groups[e].boundingBox=di.getGroupBoundingBox(o)}},group:function(){var e=this;this.commitState();var t=Object(V["a"])(),o=Object.values(this.items).filter((function(e){var t=e.isSelected;return t})),n=o.reduce((function(e,t){return e.concat(t.portIds)}),[]),i=Object.values(this.connections).filter((function(e){return n.includes(e.source)&&n.includes(e.target)&&e.isSelected}));o.forEach((function(t){return t.groupId&&e.destroyGroup(t.groupId)})),i.forEach((function(t){return t.groupId&&e.destroyGroup(t.groupId)}));var r=[].concat(Object(A["a"])(o),Object(A["a"])(i)).reduce((function(e,t){return Math.max(t.zIndex,e)}),0);this.setZIndex(r);var c={id:t,itemIds:o.map((function(e){var t=e.id;return t})),connectionIds:i.map((function(e){var t=e.id;return t})),isSelected:!0,boundingBox:{left:0,top:0,right:0,bottom:0},position:{x:0,y:0},zIndex:r};this.groups[t]=c,c.itemIds.forEach((function(t){e.items[t].groupId=c.id})),c.connectionIds.forEach((function(t){e.connections[t].groupId=c.id})),this.setGroupBoundingBox(t)},ungroup:function(){for(var e in this.commitState(),this.groups)this.groups[e].isSelected&&this.destroyGroup(e)},deselectAll:function(){for(var e in this.clearStatelessInfo(),this.connections)this.connections[e].isSelected=!1,this.selectedConnectionIds=[];for(var t in this.items)this.items[t].isSelected=!1,this.selectedItemIds.push(t),this.selectedItemIds=[]},selectAll:function(){for(var e in this.clearStatelessInfo(),this.connections)this.connections[e].isSelected=!0,this.selectedConnectionIds.push(e);for(var t in this.items)this.items[t].isSelected=!0,this.selectedItemIds.push(t)},clearStatelessInfo:function(){this.unsetConnectionPreview(),this.snapBoundaries=[],this.connectablePortIds=[],this.selectedConnectionIds=[],this.selectedItemIds=[],this.selectedPortIndex=-1,this.cachedState=null,this.activePortId=null,this.connectionPreviewId=null},createSelection:function(e){var t=this;if(di.isTwoDimensional(e))try{var o=Object.keys(this.items).filter((function(o){return di.hasIntersection(e,t.items[o].boundingBox)})),n=Object.keys(this.connections).filter((function(o){var n=t.connections[o],i=t.ports[n.source],r=t.ports[n.target];return di.isLineIntersectingRectangle(i.position,r.position,e)}));o.concat(n).forEach((function(e){t.SET_SELECTION_STATE({id:e,isSelected:!0})})),this.selectItemConnections(o)}catch(i){console.log("SELECTION ERROR: ",i,e)}},selectItemConnections:function(e){var t=this,o=e.reduce((function(e,o){return e.concat(t.items[o].portIds)}),[]);for(var n in this.connections){var i=this.connections[n];o.includes(i.source)&&o.includes(i.target)&&this.SET_SELECTION_STATE({id:n,isSelected:!0})}},setSelectionState:function(e){var t=this,o=e.id,n=e.value,i=this.items[o]||this.connections[o],r=n;if(i&&i.isSelected!==r)if(i.groupId){var c=this.groups[i.groupId],s=c.itemIds,a=c.connectionIds;s.concat(a).forEach((function(e){t.SET_SELECTION_STATE({id:e,isSelected:r})})),this.SET_SELECTION_STATE({id:i.groupId,isSelected:r})}else this.SET_SELECTION_STATE({id:o,isSelected:r})},setConnectionPreview:function(e){if(this.activePortId&&e){var t=this.activePortId,o=e;this.ports[this.activePortId].type===Ht.Input&&(t=e,o=this.activePortId);var n=Object(V["a"])();this.unsetConnectionPreview(),this.connect({source:t,target:o,id:n}),this.connectionPreviewId=n}},unsetConnectionPreview:function(){this.connectionPreviewId&&this.disconnect(this.connections[this.connectionPreviewId]),this.connectionPreviewId=null},commitPreviewedConnection:function(){if(this.connectionPreviewId){var e=this.connections[this.connectionPreviewId],t=e.source,o=e.target;this.disconnect({source:t,target:o}),this.commitState(),this.connect({source:t,target:o}),this.connectionPreviewId=null}},cycleConnectionPreviews:function(e){var t;e&&e!==this.activePortId&&this.setActivePortId(e);var o=this.selectedPortIndex+1;o<=0&&(o=0),o>=this.connectablePortIds.length&&(o=-1);var n=this.connectablePortIds[o];!n||null!==(t=this.ports[e])&&void 0!==t&&t.connectedPortIds.includes(n)?(0===this.connectablePortIds.length&&vo.beep(),this.unsetConnectionPreview()):this.setConnectionPreview(n),this.selectedPortIndex=o},setActivePortId:function(e){this.activePortId!==e&&(e?this.setConnectablePortIds({portId:e}):this.connectablePortIds=[],this.activePortId=e,this.selectedPortIndex=-1)},rotate:function(e){var t=this;this.commitState();var o=Object.values(this.items).filter((function(e){var t=e.isSelected;return t})),n=o.reduce((function(e,t){return{left:Math.min(t.boundingBox.left,e.left),top:Math.min(t.boundingBox.top,e.top),right:Math.max(t.boundingBox.right,e.right),bottom:Math.max(t.boundingBox.bottom,e.bottom)}}),{left:1/0,top:1/0,right:0,bottom:0}),i=new Set;o.forEach((function(o){var r=mi.rotate(o.rotation+e);o.groupId&&i.add(o.groupId),t.items[o.id].rotation=r,t.items[o.id].portIds.forEach((function(e){t.ports[e].rotation=r})),t.setItemPosition({id:o.id,position:mi.getGroupedItemRotatedPosition(n,o,e)}),t.setItemBoundingBox(o.id),t.setItemPortPositions(o.id)})),i.forEach((function(e){t.setGroupBoundingBox(e)}))},setPortValue:function(e){var t=e.id,o=e.value;this.simulation.setPortValue(t,o)},removeFreeport:function(e){var t=this.items[e],o="",n="";Object.values(this.connections).forEach((function(e){e.target===t.portIds[0]&&(o=e.source),e.source===t.portIds[1]&&(n=e.target)})),o&&this.disconnect({source:o,target:t.portIds[0]}),n&&this.disconnect({source:t.portIds[1],target:n}),o&&n&&this.connect({source:o,target:n}),this.removeElement(e)},createFreeport:function(e){this.items[e.itemId]||(e.sourceId&&e.targetId&&this.commitState(),this.deselectAll(),this.addFreeportItem(e),this.setItemBoundingBox(e.itemId),this.activeFreeportId=e.itemId,e.sourceId&&e.targetId&&this.disconnect({source:e.sourceId,target:e.targetId}),e.sourceId&&this.connect({source:e.sourceId,target:e.inputPortId,connectionChainId:e.connectionChainId}),e.targetId&&this.connect({source:e.outputPortId,target:e.targetId,connectionChainId:e.connectionChainId}),e.sourceId&&e.targetId&&(this.deselectAll(),this.setSelectionState({id:e.itemId,value:!0}),this.incrementZIndex(1)))},connectFreeport:function(e){var t=this,o=e.sourceId,n=e.targetId,i=e.portId,r=this.ports[i],c=Object.values(this.ports).find((function(e){return di.isInNeighborhood(e.position,r.position,10)&&e.id!==i&&t.connectablePortIds.includes(e.id)}));c?o?(this.disconnect({source:o,target:i}),this.connect({source:o,target:c.id})):n&&(this.disconnect({source:i,target:n}),this.connect({source:c.id,target:n})):this.disconnect({source:o||i,target:n||i});var s=Object.values(this.items).find((function(e){var t=e.portIds;return t.includes(i)}));s&&this.removeElement(s.id),this.clearStatelessInfo()},setConnectablePortIds:function(e){var t=e.portId,o=e.isDragging,n=this.ports[t];if(!n.isFreeport){var i=Object.values(this.connections).reduce((function(e,t){return e.concat([t.source,t.target])}),[]);o&&i.splice(-2);var r=n.type===Ht.Output?function(e){return e.type===Ht.Input&&!e.isFreeport&&!i.includes(e.id)&&e.elementId!==n.elementId}:function(e){return e.type===Ht.Output&&!e.isFreeport&&!i.includes(n.id)&&e.elementId!==n.elementId};this.connectablePortIds=Object.values(this.ports).filter(r).map((function(e){var t=e.id;return t}))}},stop:function(){this.simulation.pause()},start:function(){this.isDebugging||this.simulation.unpause()},reset:function(){var e=this;this.buildCircuit(),this.simulation.isPaused=this.isDebugging,this.oscillogram={},this.simulation.oscillogram={},Object.values(this.items).forEach((function(t){t.portIds.forEach((function(o){var n,i;(e.ports[o].value=Nn.UNKNOWN,null!==(n=t.properties)&&void 0!==n&&n.startValue&&e.ports[o].type===Ht.Output)&&e.setPortValue({id:o,value:null===(i=t.properties)||void 0===i?void 0:i.startValue.value})}))})),this.simulation.unpause()},toggleDebugger:function(){this.isDebugging?this.simulation.stopDebugging():this.simulation.startDebugging(),this.isDebugging=!this.isDebugging},stepThroughCircuit:function(){this.simulation.advance(),this.isCircuitEvaluated=!this.simulation.canContinue},toggleOscilloscope:function(){this.isOscilloscopeEnabled?this.disableOscilloscope():this.enableOscilloscope()},enableOscilloscope:function(){var e=this;Object.values(this.items).forEach((function(t){return e.simulation.monitorNode(t,e.ports)})),this.isOscilloscopeEnabled=!0},disableOscilloscope:function(){var e=this;Object.values(this.items).forEach((function(t){var o=t.portIds;o.forEach(e.simulation.unmonitorPort)})),this.oscillogram={},this.simulation.oscillogram={},this.isOscilloscopeEnabled=!1},clearOscilloscope:function(){this.simulation.oscillator.clear()},setOscilloscopeVisibility:function(e){var t=this,o=e.id,n=e.value;if(n){var i=this.items[o],r=i.type===oo.OutputNode?Ht.Input:Ht.Output;i.portIds.forEach((function(e){var o=t.ports[e];o.type===r&&t.simulation.monitorPort(e,o.value)}))}else{var c=this.items[o];c.portIds.forEach((function(e){t.simulation.unmonitorPort(e)}))}},setInputCount:function(e){var t=this,o=e.id,n=e.count,i=this.items[o],r=i.properties.inputCount.value;if(r>n)this.items[o].portIds.filter((function(e){return t.ports[e].type===Ht.Input})).slice(n).forEach((function(e){return t.removePort(e)}));else for(var c=r;c<n;c++){var s=Object(V["a"])();this.addPort(o,{id:s,name:"",connectedPortIds:[],type:Ht.Input,elementId:o,virtualElementId:o,orientation:hn.Left,isFreeport:!1,position:{x:0,y:0},rotation:0,value:0})}},setProperties:function(e){var t=e.id,o=e.properties,n=this.items[t];for(var i in o){var r=o[i];if(n.properties[i].value!==r.value){switch(i){case"showInOscilloscope":this.setOscilloscopeVisibility({id:t,value:r.value});break;case"inputCount":this.setInputCount({id:t,count:r.value});break}this.items[t].properties[i].value=r.value}}},setPortValues:function(e){for(var t in e)this.ports[t]&&(this.ports[t].value=e[t])},cacheState:function(){this.cachedState=JSON.stringify({connections:this.connections,items:this.items,ports:this.ports,groups:this.groups})},commitCachedState:function(){this.cachedState&&(this.undoStack.push(this.cachedState.toString()),this.cachedState=null,this.redoStack=[],this.isDirty=!0)},applyState:function(e){var t=this,o=JSON.parse(e),n=o.items,i=o.connections,r=o.ports,c=o.groups;function s(e,t){var o=Object.keys(e),n=Object.keys(t);return o.filter((function(e){return!n.includes(e)}))}var a=s(this.items,n),u=s(this.connections,i),l=s(n,this.items),d=s(i,this.connections);u.forEach((function(e){return t.disconnect(t.connections[e])})),a.forEach((function(e){return t.removeElement(e)})),this.ports=r,this.items=n,this.groups=c,l.forEach((function(e){n[e].integratedCircuit?t.addIntegratedCircuit(n[e]):t.addNewItem({item:n[e],ports:Object.values(r)})})),d.forEach((function(e){return t.connect(i[e])})),this.simulation.step()},addPort:function(e,t){var o=this,n=Object.keys(this.simulation.nodes).find((function(t){return o.items[e].portIds.includes(t)}));this.ports[t.id]=t,this.items[e].portIds.push(t.id),n?this.simulation.addSiblingPort(t.id,n):this.simulation.addNode(this.items[e],this.ports)},removePort:function(e){var t=this;Object.values(this.connections).filter((function(t){var o=t.source,n=t.target;return o===e||n===e})).forEach((function(e){var o=bi(Object.values(t.connections),t.ports,e.connectionChainId),n=o.connectionIds,i=o.freeportIds;n.forEach((function(e){var o=t.connections[e],n=o.source,i=o.target;t.simulation.removeConnection(n,i),delete t.connections[e]})),i.forEach((function(e){t.items[e].portIds.forEach((function(e){delete t.ports[e],t.simulation.removePort(e)})),delete t.items[e]}))}));var o=this.ports[e];if(o){var n=this.items[o.elementId];if(!n)return;var i=n.portIds.findIndex((function(t){return t===e}));-1!==i&&this.items[n.id].portIds.splice(i,1),delete this.ports[e],this.simulation.removePort(e)}else console.log("CANT DELETE")},addNewItem:function(e){var t=this,o=e.item,n=e.ports;n.forEach((function(e){t.ports[e.id]=e}));var i="".concat(o.type,"_").concat(o.subtype);this.taxonomyCounts[i]||(this.taxonomyCounts[i]=0),o.name=Ii(o,++this.taxonomyCounts[i]),this.items[o.id]=o,this.items[o.id].zIndex=++this.zIndex,this.simulation.addNode(o,this.ports),this.resetItemValue(o)},resetItemValue:function(e){var t,o=this,n=null===(t=e.properties)||void 0===t?void 0:t.startValue;if(n){var i=n.value;e.portIds.forEach((function(e){return o.setPortValue({id:e,value:i})}))}},addIntegratedCircuit:function(e){var t=this;if(e.integratedCircuit){var o={};e.portIds.forEach((function(n){var i;null!==(i=e.integratedCircuit)&&void 0!==i&&i.ports[n]&&(t.ports[n]=e.integratedCircuit.ports[n],o[n]=e.integratedCircuit.ports[n])}));var n="".concat(e.type,"_").concat(e.subtype);this.taxonomyCounts[n]||(this.taxonomyCounts[n]=0),this.items[e.id]=e,this.items[e.id].name=Ii(e,++this.taxonomyCounts[n]),this.simulation.addNode(e,o)}},removeElement:function(e){var t=this,o=this.items[e];this.simulation.removeNode(o),o.portIds.forEach((function(e){return t.removePort(e)})),delete this.items[e]},SET_SELECTION_STATE:function(e){var t=this,o=e.id,n=e.isSelected,i=function(e,o){var i=t[o].findIndex((function(t){return t===e}));n&&-1===i&&t[o].push(e),n||-1===i||t[o].splice(i,1)};if(this.items[o])this.items[o].isSelected=n,i(o,"selectedItemIds");else if(this.connections[o]){var r=this.connections[o].connectionChainId,c=bi(Object.values(this.connections),this.ports,r),s=c.connectionIds,a=c.freeportIds;s.forEach((function(e){t.connections[e].isSelected=n,i(e,"selectedConnectionIds")})),a.forEach((function(e){t.items[e].isSelected=n,i(e,"selectedItemIds")}))}},sendBackward:function(){this.commitState(),this.incrementZIndex(-1)},bringForward:function(){this.commitState(),this.incrementZIndex(1)},sendToBack:function(){this.commitState(),this.setZIndex(1)},bringToFront:function(){this.commitState(),this.setZIndex(this.zIndex)},incrementZIndex:function(e){var t=Object.values(this.items),o=Object.values(this.connections),n=t.concat(o).sort(vi),i=n.filter((function(e){var t=e.isSelected;return t})).map((function(e){var t=e.id;return t}));e>0&&i.reverse();var r=[];i.forEach((function(t){var o,i=n.findIndex((function(e){return e.id===t})),c=i+e;if(c<0||c>=n.length)r.push(n[i].id);else if(!r.includes(null===(o=n[c])||void 0===o?void 0:o.id)){var s=n[i];n.splice(i,1),n.splice(c,0,s)}})),n.forEach((function(e,t){e.zIndex=t+1})),this.zIndex=Object.keys(n).length},setZIndex:function(e){for(var t=Object.values(this.items),o=Object.values(this.connections),n=t.concat(o).sort(vi),i=n.filter((function(e){var t=e.isSelected;return t})),r=0;r<n.length;r++)n[r].isSelected&&(n.splice(r,1),r--);n.splice.apply(n,[e-1,0].concat(Object(A["a"])(i))),n.forEach((function(e,t){e.zIndex=t+1})),this.zIndex=Object.keys(n).length},connect:function(e){var t=e.source,o=e.target,n=e.connectionChainId,i=e.id,r=void 0===i?Object(V["a"])():i;t&&o&&(this.connections[r]={id:r,source:t,target:o,connectionChainId:n||r,groupId:null,zIndex:++this.zIndex,isSelected:!1},this.ports[t].connectedPortIds.push(o),this.ports[o].connectedPortIds.push(t),this.simulation.addConnection(t,o))},disconnect:function(e){var t=e.source,o=e.target,n=Object.values(this.connections).find((function(e){return e.source===t&&e.target===o}));if(n){this.simulation.removeConnection(t,o);var i=this.ports[t].connectedPortIds.findIndex((function(e){return e===o})),r=this.ports[o].connectedPortIds.findIndex((function(e){return e===t}));this.ports[t].connectedPortIds.splice(i,1),this.ports[o].connectedPortIds.splice(r,1),delete this.connections[n.id]}},destroyGroup:function(e){var t=this,o=this.groups[e];o.itemIds.forEach((function(e){t.items[e].groupId=null,t.selectedItemIds.push(e)})),o.connectionIds.forEach((function(e){t.connections[e].groupId=null,t.selectedConnectionIds.push(e)})),delete this.groups[e]},addFreeportItem:function(e){var t=e.itemId,o=e.inputPortId,n=e.outputPortId,i=e.position,r=e.value,c=function(e,o,n){return{id:e,type:o,name:"",elementId:t,orientation:n,isFreeport:!0,position:{x:0,y:0},rotation:0,value:r||0,connectedPortIds:[]}},s=[];o&&(this.ports[o]=c(o,Ht.Input,hn.Right),s.push(o)),n&&(this.ports[n]=c(n,Ht.Output,hn.Left),s.push(n)),this.taxonomyCounts[oo.Freeport]||(this.taxonomyCounts[oo.Freeport]=0),this.items[t]={id:t,name:"",type:oo.Freeport,subtype:Le.None,portIds:s,position:i,rotation:0,boundingBox:{left:i.x,top:i.y,right:i.x,bottom:i.y},properties:{},isSelected:!1,groupId:null,zIndex:++this.zIndex,width:1,height:1},this.items[t].name=Ii(this.items[t],++this.taxonomyCounts[oo.Freeport]),this.simulation.addNode(this.items[t],this.ports,!0)},copy:function(){var e=this,t={},o={};this.selectedItemIds.forEach((function(n){t[n]=e.items[n],t[n].portIds.forEach((function(t){o[t]=e.ports[t]}))}));var n=Object.values(this.connections).reduce((function(e,t){return o[t.source]&&o[t.target]&&(e[t.id]=t),e}),{}),i=Object.values(this.groups).filter((function(e){var t=e.isSelected;return t})).reduce((function(e,t){return Object(p["a"])(Object(p["a"])({},e),{},Object(f["a"])({},t.id,t))}),{}),r=JSON.stringify({items:t,ports:o,connections:n,groups:i});vo.copy(r)},paste:function(){var e=this;try{var t=vo.paste(),o=JSON.parse(t),n=ji.mapStandardCircuitIds(o);this.commitState(),this.deselectAll(),Object.keys(n.ports).forEach((function(e){n.ports[e].value=0})),Object.values(n.items).forEach((function(t){t.position.x+=20,t.position.y+=20,t.isSelected=!1,e.addNewItem({item:t,ports:t.portIds.map((function(e){return n.ports[e]}))}),e.setItemBoundingBox(t.id),e.setItemPortPositions(t.id),e.setSelectionState({id:t.id,value:!0}),e.resetItemValue(t)})),Object.values(n.connections).forEach((function(t){return e.connect(t)})),Object.values(n.groups).forEach((function(t){e.groups[t.id]=t,e.setGroupBoundingBox(t.id),e.setSelectionState({id:t.id,value:!0})}))}catch(i){console.log("ERROR: ",i)}}}})},ki=o("e58a");o("2aa5"),o("62c8");function Si(e){var t;return(null===(t=e.split("\\").pop())||void 0===t?void 0:t.split("/").pop())||""}var Bi=Object(n["b"])({id:"root",state:function(){return{documents:{},clipboard:null,activeDocumentId:null}},getters:{hasOpenDocuments:function(e){return Object.keys(e.documents).length>0},activeDocument:function(e){return e.activeDocumentId?e.documents[e.activeDocumentId]:null}},actions:{openIntegratedCircuit:function(e){e.integratedCircuit&&this.openDocument("",e.integratedCircuit.serializedState,e.id,e.name)},newDocument:function(){console.log("will create new doc")},closeApplication:function(){var e=this;return Object(co["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.closeAll();case 2:o=t.sent,o&&vo.quit();case 4:case"end":return t.stop()}}),t)})))()},closeAll:function(){var e=this;return Object(co["a"])(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.activeDocumentId){t.next=9;break}return t.next=3,e.closeDocument(e.activeDocumentId);case 3:return o=t.sent,t.next=6,new Promise((function(e){return setTimeout(e)}));case 6:if(!o){t.next=8;break}return t.abrupt("return",e.closeAll());case 8:return t.abrupt("return",!1);case 9:return t.abrupt("return",!0);case 10:case"end":return t.stop()}}),t)})))()},closeDocument:function(e){var t=this;return Object(co["a"])(regeneratorRuntime.mark((function o(){var n,i,r,c,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=t.documents[e],i=n.store(),r=!0,t.activateDocument(e),!i.isDirty){o.next=12;break}if(c=vo.showMessageBox({message:"Save changes to ".concat(n.fileName,"?"),title:"Confirm",buttons:["Yes","No","Cancel"]}),0!==c){o.next=10;break}return o.next=9,t.saveActiveDocument();case 9:r=o.sent;case 10:if(2!==c){o.next=12;break}return o.abrupt("return",!1);case 12:return delete t.documents[e],t.activeDocumentId=null,s=Object.keys(t.documents).pop(),s&&t.activateDocument(s),o.abrupt("return",r);case 17:case"end":return o.stop()}}),o)})))()},saveActiveDocument:function(){var e=arguments,t=this;return Object(co["a"])(regeneratorRuntime.mark((function o(){var n,i,r,c,s;return regeneratorRuntime.wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(n=e.length>0&&void 0!==e[0]&&e[0],o.prev=1,t.activeDocument){o.next=4;break}return o.abrupt("return",!0);case 4:if(t.activeDocument.filePath&&!n){o.next=10;break}if(i=t.activeDocument.fileName||"".concat(t.activeDocument.fileName,".alfx"),r=vo.showSaveFileDialog([{name:"Aristotle Logic Circuit (*.alfx)",extensions:["alfx"]}],i),r){o.next=9;break}return o.abrupt("return",!0);case 9:r&&(c=Si(r),t.activeDocument.filePath=r,t.activeDocument.fileName=c,t.activeDocument.displayName=c);case 10:return s=t.activeDocument.store(),ki["a"].save(t.activeDocument.filePath,{items:s.items,connections:s.connections,groups:s.groups,ports:s.ports}),s.isDirty=!1,o.abrupt("return",!0);case 16:return o.prev=16,o.t0=o["catch"](1),vo.showMessageBox({message:"An error occurred while trying to save the file.",title:"Error",type:"error"}),o.abrupt("return",!1);case 20:case"end":return o.stop()}}),o,null,[[1,16]])})))()},selectDocument:function(){var e=this;return Object(co["a"])(regeneratorRuntime.mark((function t(){var o,n,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:o=vo.showOpenFileDialog([{name:"Aristotle Logic Circuit (*.alfx)",extensions:["alfx"]}]),n=0;case 2:if(!(n<o.length)){t.next=16;break}return t.prev=3,t.next=6,ki["a"].open(o[n]);case 6:i=t.sent,i&&e.openDocument(o[n],i,Object(V["a"])()),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),vo.showMessageBox({message:"An error occurred while trying to read the file.",title:"Error",type:"error"});case 13:n++,t.next=2;break;case 16:case"end":return t.stop()}}),t,null,[[3,10]])})))()},openDocument:function(e,t,o){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";if(this.documents[o])return this.activateDocument(o);var i=Ci(o),r=i(),c=Si(e);r.loadDocument(t),this.documents[o]={fileName:c,filePath:e,displayName:n||c,store:i},this.activateDocument(o)},switchDocument:function(e){var t=this,o=Object.keys(this.documents),n=o.findIndex((function(e){return t.activeDocumentId===e})),i=n+e;0!==o.length&&(-1===n||i>=o.length?i=0:i<0&&(i=o.length-1),this.activateDocument(o[i]))},pauseActivity:function(){var e;null===(e=this.activeDocument)||void 0===e||e.store().stop()},resumeActivity:function(){var e;null===(e=this.activeDocument)||void 0===e||e.store().start()},activateDocument:function(e){this.pauseActivity(),this.activeDocumentId=e,this.resumeActivity()},openTestDocuments:function(){this.openDocument("flip-flop.alfx",JSON.stringify(Sn),Object(V["a"])(),"flip-flop.alfx")},navigateDocumentList:function(e){var t=this,o=Object.keys(this.documents),n=o.findIndex((function(e){return e===t.activeDocumentId})),i=n+e;i<0&&(i=o.length-1),i>=o.length&&(i=0),this.activateDocument(o[i])}}}),Pi={class:"tab-item__label"};function Ei(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{class:Object(i["normalizeClass"])([{"tab-item--active":e.active,"tab-item--dirty":e.dirty},"tab-item"]),onMousedown:t[1]||(t[1]=function(t){return e.$emit("activate")})},[Object(i["createElementVNode"])("div",Pi,Object(i["toDisplayString"])(e.label)+Object(i["toDisplayString"])(e.dirty?"*":""),1),Object(i["createElementVNode"])("div",{class:"tab-item__close",onClick:t[0]||(t[0]=Object(i["withModifiers"])((function(t){return e.$emit("close")}),["stop"]))}," âœ– ")],34)}var Ni=Object(i["defineComponent"])({name:"TabItem",props:{active:{type:Boolean,default:!1},label:{type:String,required:!0},dirty:{type:Boolean,default:!1}}});o("09bf");const Di=O()(Ni,[["render",Ei]]);var _i=Di,Vi={class:"tab-host"},Mi={class:"tab-host__list"};function zi(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Vi,[Object(i["createElementVNode"])("div",Mi,[Object(i["renderSlot"])(e.$slots,"tabs")]),Object(i["renderSlot"])(e.$slots,"default")])}var Ti=Object(i["defineComponent"])({name:"TabHost"});o("2a6d");const Fi=O()(Ti,[["render",zi]]);var Li=Fi,Ri={style:{height:"100%"}},Ai=Object(i["createTextVNode"])(" oscilloscope not available in debugging mode "),qi=Object(i["createTextVNode"])(" the oscilloscope isn't enabled "),Ui=Object(i["createTextVNode"])(" no waves to observe ");function $i(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("oscilloscope-title-bar"),a=Object(i["resolveComponent"])("oscilloscope-viewer"),u=Object(i["resolveComponent"])("oscilloscope-timeline");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Ri,[Object(i["createVNode"])(s,{clearable:!e.isDebugging&&e.isOscilloscopeEnabled&&e.hasWaves,onClear:e.clearOscilloscope},null,8,["clearable","onClear"]),e.isDebugging?(Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:0},{default:Object(i["withCtx"])((function(){return[Ai]})),_:1})):e.isOscilloscopeEnabled?e.hasWaves?(Object(i["openBlock"])(),Object(i["createBlock"])(u,{key:3,oscillogram:e.oscillogram},null,8,["oscillogram"])):(Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:2},{default:Object(i["withCtx"])((function(){return[Ui]})),_:1})):(Object(i["openBlock"])(),Object(i["createBlock"])(a,{key:1},{default:Object(i["withCtx"])((function(){return[qi]})),_:1}))])}var Gi={class:"oscilloscope-timeline"},Ki={class:"oscilloscope-timeline__list",ref:"list"},Wi=["width","viewBox"],Xi=["points","stroke"];function Zi(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Gi,[Object(i["createElementVNode"])("div",Ki,[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.oscillogram,(function(e,t){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{key:t,style:Object(i["normalizeStyle"])({color:"hsla(".concat(e.hue,",70%,70%,0.8)")}),class:"oscilloscope-timeline__label"},Object(i["toDisplayString"])(t),5)})),128))],512),Object(i["createElementVNode"])("div",{class:"oscilloscope-timeline__display",ref:"timeline",onWheel:t[0]||(t[0]=function(){return e.onWheel&&e.onWheel.apply(e,arguments)})},[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.oscillogram,(function(t,o){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",{style:Object(i["normalizeStyle"])({width:"".concat(e.totalWidth,"px")}),key:o,class:"oscilloscope-timeline__item"},[Object(i["createElementVNode"])("div",{style:Object(i["normalizeStyle"])({width:"".concat(t.width,"px")}),class:"oscilloscope-timeline__svg"},[(Object(i["openBlock"])(),Object(i["createElementBlock"])("svg",{width:t.width,viewBox:"0 0 ".concat(t.width," 1"),preserveAspectRatio:"none"},[Object(i["createElementVNode"])("polyline",{points:t.points,stroke:"hsla(".concat(t.hue,",70%,70%,0.8)"),"stroke-width":"2",fill:"none","vector-effect":"non-scaling-stroke"},null,8,Xi)],8,Wi))],4)],4)})),128))],544)])}var Yi=Object(i["defineComponent"])({name:"OscilloscopeTimeline",props:{oscillogram:{type:Object,required:!0}},computed:{totalWidth:function(){return Object.values(this.oscillogram).reduce((function(e,t){var o=t.width;return Math.max(o,e)}),0)}},mounted:function(){var e=this.$refs.timeline,t=this.$refs.list;this.scrollToNextInterval(),t.addEventListener("scroll",this.onTimelineScroll),e.addEventListener("scroll",this.onTimelineScroll)},beforeUnmount:function(){var e=this.$refs.timeline,t=this.$refs.list;t.removeEventListener("scroll",this.onTimelineScroll),e.removeEventListener("scroll",this.onTimelineScroll)},methods:{onWheel:function(e){var t=this.$refs.timeline;t.scrollTop+=e.deltaY/10,e.preventDefault()},scrollToNextInterval:function(){var e=this.$refs.timeline;e.scrollLeft=e.scrollWidth},onTimelineScroll:function(){var e=this.$refs.list,t=this.$refs.timeline;t&&(e.scrollTop=t.scrollTop)}},watch:{oscillogram:{handler:function(){this.scrollToNextInterval()},deep:!0}}});o("943a");const Hi=O()(Yi,[["render",Zi]]);var Ji=Hi,Qi={class:"oscilloscope-title-bar"},er=Object(i["createElementVNode"])("div",{class:"oscilloscope-title-bar__title"},"Oscilloscope",-1),tr={class:"oscilloscope-title-bar__actions"},or=["disabled"];function nr(e,t,o,n,r,c){var s=Object(i["resolveComponent"])("icon");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",Qi,[er,Object(i["createElementVNode"])("div",tr,[Object(i["createElementVNode"])("button",{class:"oscilloscope-title-bar__button",title:"Clear oscilloscope",disabled:!e.clearable,onClick:t[0]||(t[0]=function(t){return e.$emit("clear")})},[Object(i["createVNode"])(s,{icon:e.faBan},null,8,["icon"])],8,or),Object(i["createElementVNode"])("button",{class:"oscilloscope-title-bar__button",title:"Close",onClick:t[1]||(t[1]=function(t){return e.$emit("close")})},[Object(i["createVNode"])(s,{icon:e.faClose},null,8,["icon"])])])])}var ir=Object(i["defineComponent"])({name:"OscilloscopeTitleBar",components:{Icon:Uo},props:{clearable:{type:Boolean,default:!0}},setup:function(){return{faBan:Mo["b"],faClose:Mo["d"]}}});o("9001");const rr=O()(ir,[["render",nr]]);var cr=rr,sr={class:"oscilloscope-viewer"};function ar(e,t,o,n,r,c){return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",sr,[Object(i["renderSlot"])(e.$slots,"default")])}var ur=Object(i["defineComponent"])({name:"OscilloscopeViewer"});o("33f2");const lr=O()(ur,[["render",ar]]);var dr=lr,pr=Object(i["defineComponent"])({name:"Oscilloscope",components:{OscilloscopeTimeline:Ji,OscilloscopeTitleBar:cr,OscilloscopeViewer:dr},props:{store:{type:Function,required:!0}},setup:function(e){var t=e.store(),o=Object(n["c"])(t),r=o.oscillogram,c=o.isDebugging,s=o.isOscilloscopeEnabled,a=Object(i["computed"])((function(){return Object.keys(r).length>0}));return{isDebugging:c,isOscilloscopeEnabled:s,hasWaves:a,oscillogram:r,clearOscilloscope:t.clearOscilloscope}}});const fr=O()(pr,[["render",$i]]);var hr=fr,mr=Object(i["defineComponent"])({name:"App",components:{Document:Io,ResizablePanes:kn,Toolbar:en,TabItem:_i,TabHost:Li,Toolbox:jn,Oscilloscope:hr},setup:function(){var e=Bi(),t=Object(n["c"])(e),o=t.activeDocument,r=t.activeDocumentId,c=t.documents,s=t.hasOpenDocuments;function a(t){t.ctrlKey&&"Tab"===t.key&&(e.switchDocument(t.shiftKey?-1:1),t.preventDefault()),t.ctrlKey&&"R"===t.key.toUpperCase()&&(vo.canCloseWindow=!0),t.ctrlKey&&"Q"===t.key.toUpperCase()&&e.closeApplication(),t.ctrlKey&&"W"===t.key.toUpperCase()&&e.activeDocumentId&&(e.closeDocument(e.activeDocumentId),t.preventDefault())}return s.value||e.openTestDocuments(),Object(i["watchEffect"])((function(){return vo.setApplicationMenu(e)})),Object(i["watchEffect"])((function(){document.title=e.activeDocument?"".concat(e.activeDocument.displayName," - Aristotle"):"Aristotle"})),Object(i["onMounted"])((function(){document.addEventListener("keydown",a),vo.on("close",e.closeApplication)})),Object(i["onBeforeUnmount"])((function(){document.removeEventListener("keydown",a)})),{activeDocument:o,activeDocumentId:r,documents:c,hasOpenDocuments:s,activateDocument:e.activateDocument,closeDocument:e.closeDocument,switchDocument:e.switchDocument,openIntegratedCircuit:e.openIntegratedCircuit}},data:function(){return{horizontal:!1,isMouseDown:!1,lastPosition:0,toolboxWidth:20,documentHeight:80}}});o("c9ce");const br=O()(mr,[["render",u]]);var vr=br;vo.assignQuitter(),Object(i["createApp"])(vr).use(Object(n["a"])()).mount("#app")},cfe0:function(e,t,o){"use strict";o("54f0")},d00e:function(e,t,o){},d06a:function(e,t,o){"use strict";o("6ab2")},e0ca:function(e,t,o){},e220:function(e,t,o){"use strict";o("fba1")},e4ce:function(e,t,o){"use strict";o("66d8")},e58a:function(e,t,o){"use strict";(function(e){o.d(t,"a",(function(){return a}));var n=o("42c2"),i=o("f5f2"),r=o("30c6"),c=(o("d331"),o("df26"),o("bb01")),s=o.n(c),a=function(){function t(){Object(i["a"])(this,t)}return Object(r["a"])(t,null,[{key:"open",value:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var o,n,i,r,c,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(window.require){e.next=2;break}return e.abrupt("return");case 2:return o=window.require("fs"),n=new s.a,i=o.readFileSync(t),e.next=7,n.loadAsync(i);case 7:return r=e.sent,c=r.files,e.next=11,c.content.async("text");case 11:return a=e.sent,e.abrupt("return",a);case 13:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"save",value:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(o,n){var i,r,c,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(window.require){t.next=2;break}return t.abrupt("return");case 2:return i=window.require("fs"),r=new s.a,r.file("content",JSON.stringify(n)),t.next=7,r.generateAsync({type:"blob"});case 7:return c=t.sent,t.t0=e,t.next=11,c.arrayBuffer();case 11:t.t1=t.sent,a=t.t0.from.call(t.t0,t.t1),i.writeFileSync(o,a);case 14:case"end":return t.stop()}}),t)})));function o(e,o){return t.apply(this,arguments)}return o}()}]),t}()}).call(this,o("f995").Buffer)},e5c7:function(e,t,o){},ecd2:function(e,t,o){},ed41:function(e,t,o){},ef02:function(e,t,o){"use strict";o("f3cd")},f152:function(e,t,o){"use strict";o("ecd2")},f3cd:function(e,t,o){},f4b9:function(e,t,o){"use strict";o("9f2c")},f86a:function(e,t,o){},f96c:function(e,t,o){"use strict";o("e5c7")},fa39:function(e,t,o){"use strict";o("2866")},fba1:function(e,t,o){}});